------------------------------------------------------------------------
Cross-Site Scripting in Code Snippets WordPress Plugin
------------------------------------------------------------------------
Burak Kelebek, July 2016

------------------------------------------------------------------------
Abstract
------------------------------------------------------------------------
A reflected Cross-Site Scripting (XSS) vulnerability has been found in
the Code Snippets WordPress Plugin. By using this vulnerability an
attacker can inject malicious JavaScript code into the application,
which will execute within the browser of any logged-in admin who views
the link in the proof of concept below.

------------------------------------------------------------------------
OVE ID
------------------------------------------------------------------------
OVE-20160722-0006

------------------------------------------------------------------------
Tested versions
------------------------------------------------------------------------
This issue was successfully tested on Code Snippets version 2.6.1.

------------------------------------------------------------------------
Fix
------------------------------------------------------------------------
There issue is fixed in version 2.7.0

------------------------------------------------------------------------
Details
------------------------------------------------------------------------
https://sumofpwn.nl/advisory/2016/cross_site_scripting_in_code_snippets_wordpress_plugin.html

Cross-Site Scripting (XSS) attacks are a type of injection, in which malicious scripts are injected into otherwise benign and trusted web sites. XSS attacks occur when an attacker uses a web application to send malicious code, generally in the form of a browser side script, to a different end user. Flaws that allow these attacks to succeed are quite widespread and occur anywhere a web application uses input from a user within the output it generates without validating or encoding it. Reflected XSS occurs when user input is immediately returned by a web application in an error message, search result, or any other response that includes some or all of the input provided by the user as part of the request

"tag" field does not validate <script> tags and does not perform output encoding.

code-snippets/php/class-list-table.php:

if ( ! empty( $_GET['tag'] ) ) {
            echo sprintf( __( ' in tag &#8220;%s&#8221;', 'code-snippets' ), $_GET['tag'] );
         }

An attacker needs to lure a logged-in admin to follow the link in the proof of concept below.
Proof of concept

http://<targetsite>/wp-admin/admin.php?page=snippets&tag=asdasd%5C%5C%27%3E%3Cscript%3Ealert%281%29%3C%2Fscript%3E

------------------------------------------------------------------------
Summer of Pwnage (https://sumofpwn.nl) is a Dutch community project. Its
goal is to contribute to the security of popular, widely used OSS
projects in a fun and educational way.
