Title:
======
Sony PSN Community - Mail Encoding Web Vulnerability


Date:
=====
2013-05-05


References:
===========
http://www.vulnerability-lab.com/get_content.php?id=748


VL-ID:
=====
747


Common Vulnerability Scoring System:
====================================
3.1


Introduction:
=============
PlayStation Network, often abbreviated as PSN, is an online multiplayer gaming and digital media delivery service provided/run 
by Sony Computer Entertainment for use with the PlayStation 3, PlayStation Portable, and PlayStation Vita video game consoles. 
The PlayStation Network is the video game portion of the Sony Entertainment Network.

(Copy of the Homepage: http://en.wikipedia.org/wiki/PlayStation_Network)


Abstract:
=========
The Vulnerability Laboratory Research Team discovered a filter and encoding web vulnerability in Sony`s official PSN Community Website Application.


Report-Timeline:
================
2012-11-01:	Researcher Notification & Coordination
2012-11-02:	Vendor Notification
2013-05-06:	Public Disclosure


Status:
========
Published


Affected Products:
==================
Sony
Product: PSN Community - Lithium Forums 2012 Q4


Exploitation-Technique:
=======================
Remote


Severity:
=========
Medium


Details:
========
A persistent web vulnerability is detected in Sony`s official PSN Community Website Application.
The vulnerability allows remote attackers to send own malicious persistent script code as notification 
message to hijack or phish psn application user accounts.

The vulnerability in the psn community (forum) is located in the outgoing mail parse of the 
private message notification with the bound vulnerable username parameter. The script code will be 
executed when the attacker injects script code as username. In the application and software itself 
the web context is parsed but not in the outgoing notification mail of the community when a message 
has been send or arrives.

Vulnerable Section(s):
			[+] PSN Community - Forums [Private Messages]

Vulnerable Module(s):
			[+] Forums [Private Messages] - Notification Mail  (Active Message Notification)

Vulnerable Module(s):
			[+] Username


Proof of Concept:
=================
The persistent vulnerability can be exploited by remote attackers with low privilege community application 
account with low or medium required user inter action. For demonstration or reproduce ...

Reproduce:
1. Register a username with a test iframe inside
2. Activate the checkbox with the private message notification mail
3. Send yourself a message with any random content
4. Open the notification mail and watch the username web context
5. Reproduce successful! The script code will be executed out of the notification mail of the private messages


<html>
<head>
<title>You have received a private message in the PSN Support Network!</title>
<link rel="important stylesheet" href="x.css">
</head>
<body>
<table border=0 cellspacing=0 cellpadding=0 width="100%" class="header-part1"><tr><td><b>Betreff: </b>You have received a private message in 
the PSN Support Network!</td></tr><tr><td><b>Von: </b>Community Mailer <noreply@playstation.com></td></tr><tr><td><b>Datum: </b>01.11.2012 

04:33</td></tr></table><table border=0 cellspacing=0 cellpadding=0 width="100%" class="header-part2"><tr>
<td><b>An: </b> >"<>"<iframe src=http://vuln-lab.com width=1000 height=700> <admin@vulnerability-lab.com></td></tr></table><br>
<html>
	<head>
		<title>
			You have received a private message in the PSN Support Network!
		</title>
	</head>
	<body>
		Hello >"<>"<iframe src=http://vuln-lab.com width=1000 height=700>, 
		<p>
		You have received a private message in the PSN Support Network.  
		</p>
		<p>
Please click <a href="LINK">here</a> to access the community.  You will need to login before you can read your message.
		</p>
	</body>
</html>
</body>
</html>


Risk:
=====
The security risk of the mail encoding (validation) vulnerability is estimated as medium.


Credits:
========
Vulnerability Laboratory [Research Team]  -    Benjamin Kunz Mejri (bkm@vulnerability-lab.com)


Disclaimer:
===========
The information provided in this advisory is provided as it is without any warranty. Vulnerability-Lab disclaims all warranties, 
either expressed or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-
Lab or its suppliers are not liable in any case of damage, including direct, indirect, incidental, consequential loss of business 
profits or special damages, even if Vulnerability-Lab or its suppliers have been advised of the possibility of such damages. Some 
states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation 
may not apply. We do not approve or encourage anybody to break any vendor licenses, policies, deface websites, hack into databases 
or trade with fraud/stolen material.

Domains:    www.vulnerability-lab.com   	- www.vuln-lab.com			       - www.vulnerability-lab.com/register
Contact:    admin@vulnerability-lab.com 	- support@vulnerability-lab.com 	       - research@vulnerability-lab.com
Section:    video.vulnerability-lab.com 	- forum.vulnerability-lab.com 		       - news.vulnerability-lab.com
Social:	    twitter.com/#!/vuln_lab 		- facebook.com/VulnerabilityLab 	       - youtube.com/user/vulnerability0lab
Feeds:	    vulnerability-lab.com/rss/rss.php	- vulnerability-lab.com/rss/rss_upcoming.php   - vulnerability-lab.com/rss/rss_news.php

Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability Laboratory. 
Permission to electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of other 
media, are reserved by Vulnerability-Lab Research Team or its suppliers. All pictures, texts, advisories, sourcecode, videos and 
other information on this website is trademark of vulnerability-lab team & the specific authors or managers. To record, list (feed), 
modify, use or edit our material contact (admin@vulnerability-lab.com or support@vulnerability-lab.com) to get a permission.

    				   	Copyright © 2013 | Vulnerability Laboratory



-- 
VULNERABILITY RESEARCH LABORATORY
LABORATORY RESEARCH TEAM
CONTACT: research@vulnerability-lab.com

