Panda Internet Security v17.0.1 - Unquoted Service Path Privilege
Escalation
 
=====================================================
# Panda Internet Security v17.0.1 - Unquoted Service Path Privilege
Escalation
=====================================================
# Vendor Homepage: http://www.pandasecurity.com
# Date: 24 Oct 2016
# Version : 17.0.1
# Software Link: http://www.pandasecurity.com/homeusers/downloads/
# Tested on: Windows 7 Ultimate SP1 (EN)
# Author: Heliand Dema
# Contact: heliand@cyber.al
=====================================================
 
Panda Internet Security installs a service called 'panda_url_filtering'
with an unquoted service path running with SYSTEM privileges.
This could potentially allow an authorized but non-privileged local user
to execute arbitrary code with elevated privileges on the system.
 
 
C:\Users\helik>sc qc panda_url_filtering
[SC] QueryServiceConfig SUCCESS
 
SERVICE_NAME: panda_url_filtering
        TYPE               : 10  WIN32_OWN_PROCESS
        START_TYPE         : 2   AUTO_START
        ERROR_CONTROL      : 1   NORMAL
        BINARY_PATH_NAME   : C:\Program Files\Panda Security URL
Filtering\Panda_URL_Filteringb.exe
        LOAD_ORDER_GROUP   :
        TAG                : 0
        DISPLAY_NAME       : panda_url_filtering Service
        DEPENDENCIES       :
        SERVICE_START_NAME : LocalSystem
 
 
 
====Proof-of-Concept====
To properly exploit this vulnerability, the local attacker must insert
an executable file in the path of the service. Upon service restart or
system reboot, the malicious code will be run with elevated privileges.
 
