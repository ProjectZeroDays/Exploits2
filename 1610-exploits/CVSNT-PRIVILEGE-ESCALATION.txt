[+] Credits: John Page aka hyp3rlinx

[+] Website: hyp3rlinx.altervista.org

[+] Source:
http://hyp3rlinx.altervista.org/advisories/CVSNT-PRIVILEGE-ESCALATION.txt

[+] ISR: ApparitionSec



Vendor:
======================
www.march-hare.com
www.wincvs.org
cvsgui.sourceforge.net


Product:
==============
CVSNT v2.0.51d

Is part of "WinCvs" install zip archive.

The CVSNT Versioning System implements a version control system: it keeps
track of all changes in a set of files, typically the
implementation of a software project, and allows several (potentially
geographically separated) developers to collaborate.
It is compatible with and originally based on Concurrent Versions System
(CVS), which has become popular in the open-source world.


from "Install.txt" ...

Run wincvs_setup.exe to install WinCvs. It will also run CVSNT installer
after completion.

Run cvsnt_setup.exe to setup CVSNT only.



Vulnerability Type:
=====================
Privilege Escalation



CVE Reference:
==============
N/A



Vulnerability Details:
=====================

CVSNT installs a service with an unquoted service path running with SYSTEM
privileges, to exploit a local attacker must place
a malicious executable file named "Program.exe" in the path of the service.
After service restart or system reboot, it could
potentially allow an authorized local user to execute arbitrary code with
elevated privileges on the system.


Proof:
======

C:\Users\hyp3rlinx>sc qc CVSLock
[SC] QueryServiceConfig SUCCESS

SERVICE_NAME: CVSLock
        TYPE               : 10  WIN32_OWN_PROCESS
        START_TYPE         : 2   AUTO_START
        ERROR_CONTROL      : 1   NORMAL
        BINARY_PATH_NAME   : C:\Program Files (x86)\cvsnt\cvslock.exe
        LOAD_ORDER_GROUP   :
        TAG                : 0
        DISPLAY_NAME       : CVSNT Locking Service
        DEPENDENCIES       :
        SERVICE_START_NAME : LocalSystem




Exploitation Technique:
=======================
Local



Severity Level:
================
Medium



[+] Disclaimer
The information contained within this advisory is supplied "as-is" with no
warranties or guarantees of fitness of use or otherwise.
Permission is hereby granted for the redistribution of this advisory,
provided that it is not altered except by reformatting it, and
that due credit is given. Permission is explicitly given for insertion in
vulnerability databases and similar, provided that due credit
is given to the author. The author is not responsible for any misuse of the
information contained herein and accepts no responsibility
for any damage caused by the use or misuse of this information. The author
prohibits any malicious use of security related information
or exploits by the author or elsewhere.

hyp3rlinx
