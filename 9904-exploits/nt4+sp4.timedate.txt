Date: Mon, 12 Apr 1999 12:52:43 -0000
From: joj@BI.IS
To: NTBUGTRAQ@LISTSERV.NTBUGTRAQ.COM
Subject: Re: Bug with NT4SP4 (possibly the TIMEDATE.CPL applet)

Here's a follow up to my post on the timezone problem:

Quite a few people e-mailed me with suggestions/solutions,
they had come up with, including some who had faced similar
problems.

Here's my original message:
(feel free to cut it out Russ, if you want to).

> -----Original Message-----
> From: BI301 Jóhann Ólafur Jökulsson 
> Sent: 6. apríl 1999 21:19
> To: NTBUGTRAQ@LISTSERV.NTBUGTRAQ.COM
> Subject: Bug with NT4SP4 (possibly the TIMEDATE.CPL applet)
> 
> 
> We were in the process of rolling out SP4 when the following came up:
> 
> After running SP4 on our test network for a few months with nary a 
> hiccup I figured it was time to deploy it company wide. Starting with
> local servers and workstations everything seemed to go smoothly.
> However just before Easter strange clock settings started to appear,
> Talk about Easter eggs :)
> 
> We use the Monrovia/Casablanca timezone, which doesn't have the
> summertime settings. After applying SP4, somehow the timezone
> gets set to GMT with the tick in "Automatically adjust the clock..."
> Which would have been fine if we used those settings here in Iceland,
> which we don't. After verifying this to be a problem on all machines
> that had the NT4SP4 applied we tried this on a fresh machine with just
> the application software (Office97, Outlook98 etc.) and lo and behold,
> we had replicated the problem. This is also a problem on our servers
> which is not good, being a bank we _must_ have accurate times in our
> transaction logs.
> 
> Upon inspection we found that the Timedate.cpl had been "upgraded"
> presumably to deal with some Y2K issues. This might be the culprit
> and is indeed the prime suspect. It is my guess that somehow the
> current settings aren't being read correctly when SP4 is applied to
> the system.
> If this is how a "simple" daylight savings time issue works out, I'd
> better forget about any vacation time around New Years Eve :) 
> 
> A quick work around is to manually change the Timezone settings in the
> Timedate.cpl applet. However this is not feasible to do for every 
> single computer on the WAN manually. 

Here's a better solution:

Change the settings on one affected machine, export this key
[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\TimeZoneInformation
]
and update your batch file/script to import that file into the registry.

Here's what my Timezone_fix.reg looks like
---Cut here---
REGEDIT4

[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\TimeZoneInformation
]
"Bias"=dword:00000000
"StandardName"="Greenwich Standard Time"
"StandardBias"=dword:00000000
"StandardStart"=hex:00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00
"DaylightName"="Greenwich Standard Time"
"DaylightBias"=dword:00000000
"DaylightStart"=hex:00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00
"ActiveTimeBias"=dword:00000000
---Cut here---

Others arrived at the same conclusion that I did, and I would like
to thank all the people that responded offering their help.
Several suggested that I sync my computers using NET TIME, but that
really didn't fix the problem "permanently" which is what I wanted.

Thanks for your help people!

JoJ

---
Jóhann Ó Jökulsson, Kerfisstjóri, Búnaðarbanki Íslands
Johann O Jokulsson, System Administrator, Agricultural Bank of Iceland
Tölvupóstur / E-mail: joj@bi.is | Heima / Home: joj@simnet.is
Sími / Phone: +(354) 525-6450, Fax: +(354) 525-6459

