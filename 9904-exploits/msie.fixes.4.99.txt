Date: Wed, 21 Apr 1999 18:13:39 -0700
From: aleph1@UNDERGROUND.ORG
To: BUGTRAQ@netspace.org
Subject: Microsoft Security Bulletin (MS99-011)

The following is a Security  Bulletin from the Microsoft Product Security
Notification Service.

Please do not  reply to this message,  as it was sent  from an unattended
mailbox.
                    ********************************

Microsoft Security Bulletin (MS99-011)
--------------------------------------

Patch Available for "DHTML Edit" Vulnerability

Originally Posted: April 21, 1999

Summary
=======
Microsoft has released a patch that eliminates a vulnerability in an ActiveX
control that is distributed in Internet Explorer 5 and downloadable for
Internet Explorer 4.0. The vulnerability could allow a malicious web site
operator to read information that a user had loaded into the control, and it
also could allow files with known names to be copied from the user's local
hard drive.

A fully supported patch is available to eliminate this vulnerability and
Microsoft recommends that affected customers download and install it, if
appropriate.

Issue
=====
The DHTML Edit control is an ActiveX control that is distributed with
Internet Explorer 5 and can be downloaded for use in Internet Explorer 4.0.
The control enables users to edit HTML text and see a faithful rendition of
how the text would look in the browser. There are two versions of the
control: a more powerful version that cannot be invoked by a web site
because it includes file access and other features, and a "safe for
scripting" version that has restricted functionality and is intended for use
by web sites.

The root cause of the vulnerability lies in the fact that a web site that
hosts the "safe for scripting" version of the control is able to upload any
data entered into the control. A malicious web site operator could trick a
user into entering sensitive data into a DHTML Edit control hosted on a web
page from the operator's site, and then upload the data. In addition, if the
malicious web site operator knows the name of a file on the user's local
drive, it is possible for the operator to programmatically load the file
into the control and then upload it.

The patch works by allowing a web site to load data from the control only if
it is in the site's domain. While there are no reports of customers being
adversely affected by this vulnerability, Microsoft is proactively releasing
this patch to allow customers to take appropriate action to protect
themselves against it.

Affected Software Versions
==========================
 - Microsoft Internet Explorer 5 on Windows 95, Windows 98, and
   Windows NT 4.0. Internet Explorer 5 on other platforms is
   not affected.
 - Microsoft Internet Explorer 4.0 on Windows 95, Windows 98 and
   the x86 version of Windows NT 4.0. Internet Explorer 4.0 on
   other platforms, including the Alpha version of Windows NT 4.0,
   is not affected.

Note: The DHTML Edit control is included by default in Internet Explorer 5.
It is not included by default in Internet Explorer 4.0, but can be
downloaded and installed. Internet Explorer 4.0 customers who are unsure
whether they have installed the control should see What Customers Should Do.


What Microsoft is Doing
=======================
Microsoft has released patches that fix the problem identified. The patches
are available for download from the sites listed below in What Customers
Should Do.

Microsoft also has sent this security bulletin to customers
subscribing to the Microsoft Product Security Notification Service.
See http://www.microsoft.com/security/services/bulletin.asp for
more information about this free customer service.

Microsoft has published the following Knowledge Base (KB) article on this
issue:
 - Microsoft Knowledge Base (KB) article Q226326,
   Update Available for 'DHTML Edit' Security Issue,
   http://support.microsoft.com/support/kb/articles/q226/3/26.asp.
   (Note: It might take 24 hours from the original posting of this
   bulletin for the KB article to be visible in the Web-based
   Knowledge Base.)

What Customers Should Do
========================
Microsoft highly recommends that customers determine whether they are
potentially affected by the vulnerability:
 - All copies of Internet Explorer 5 contain the DHTML Edit
   control, so all Internet Explorer 5 customers are potentially
   affected by the vulnerability.
 - The only Internet Explorer 4.0 users who are potentially
   affected by the vulnerability are those who have downloaded
   and installed the DHTML Edit control. If this has been done,
   the file dhtmled.ocx will be present on the hard drive. By
   default, this file will be stored in the folder
   C:\Program Files\Common Files\Microsoft Shared\Triedit\.

Customers who are potentially affected by the vulnerability should
evaluate the degree of risk that this vulnerability poses to their
systems and determine whether to download and install the patch.
The patch can be found at
http://www.microsoft.com/windows/ie/security/dhtml_edit.asp.

More Information
================
Please see the following references for more information related to this
issue.
 - Microsoft Security Bulletin MS99-011,
   Patch Available for DHTML Edit Vulnerability.
   (The Web-posted version of this bulletin),
   http://www.microsoft.com/security/bulletins/ms99-011.asp.
 - Microsoft Knowledge Base (KB) article Q226326,
   Update Available for 'DHTML Edit' Security Issue,
   http://support.microsoft.com/support/kb/articles/q226/3/26.asp.
   (Note: It might take 24 hours from the original posting of
   this bulletin for the KB article to be visible in the Web-based
   Knowledge Base.)

Obtaining Support on this Issue
===============================
If you require technical assistance with this issue, please
contact Microsoft Technical Support. For information on contacting
Microsoft Technical Support, please see
http://support.microsoft.com/support/contact/default.asp.

Acknowledgments
===============
Microsoft acknowledges Juan Carlos Cuartango of Spain for
discovering this vulnerability and reporting it to us.

Revisions
=========
 - April 21, 1999: Bulletin Created.


For additional security-related information about Microsoft products, please
visit http://www.microsoft.com/security
--------------------------------------------------------------------

THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS PROVIDED "AS IS"
WITHOUT WARRANTY OF ANY KIND. MICROSOFT DISCLAIMS ALL WARRANTIES, EITHER
EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES OF MERCHANTABILITY AND FITNESS
FOR A PARTICULAR PURPOSE. IN NO EVENT SHALL MICROSOFT CORPORATION OR ITS
SUPPLIERS BE LIABLE FOR ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT,
INCIDENTAL, CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN
IF MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES. SOME STATES DO NOT ALLOW THE EXCLUSION OR
LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES SO THE
FOREGOING LIMITATION MAY NOT APPLY.

(c) 1999 Microsoft Corporation. All rights reserved.

   *******************************************************************
You have received  this e-mail bulletin as a result  of your registration
to  the   Microsoft  Product  Security  Notification   Service.  You  may
unsubscribe from this e-mail notification  service at any time by sending
an  e-mail  to  MICROSOFT_SECURITY-SIGNOFF-REQUEST@ANNOUNCE.MICROSOFT.COM
The subject line and message body are not used in processing the request,
and can be anything you like.

For  more  information on  the  Microsoft  Security Notification  Service
please    visit    http://www.microsoft.com/security/bulletin.htm.    For
security-related information  about Microsoft products, please  visit the
Microsoft Security Advisor web site at http://www.microsoft.com/security.

---------------------------------------------------------------------------------

Date: Wed, 21 Apr 1999 18:14:00 -0700
From: aleph1@UNDERGROUND.ORG
To: BUGTRAQ@netspace.org
Subject: Microsoft Security Bulletin (MS99-012)

The following is a Security  Bulletin from the Microsoft Product Security
Notification Service.

Please do not  reply to this message,  as it was sent  from an unattended
mailbox.
                    ********************************

Microsoft Security Bulletin (MS99-012)
--------------------------------------

MSHTML Update Available for Internet Explorer

Originally Posted: April 21, 1999

Summary
=======
Microsoft has released an updated version of a component of Internet
Explorer 4.0 and 5. The updated version eliminates three security
vulnerabilities described below. It is fully supported and Microsoft
recommends that affected customers download and install it, if appropriate.

Issue
=====
MSHTML.DLL is the parsing engine for HTML in Internet Explorer. The
vulnerabilities that are eliminated by the update are not related to each
other except for the fact that all reside within the parsing engine.
 - The first vulnerability is a privacy issue involving
   the processing of the "IMG SRC" tag in HTML files. This tag
   identifies and loads image sources - image files that are
   to be displayed as part of a web page. The vulnerability
   results because the tag can be used to point to files of any
   type, rather than only image files, after which point the
   document object model methods can be used to determine information
   about them. A malicious web site operator could use this vulnerability
   to determine the size and other information about files on the
   computer of a visiting user. It would not allow files to be read or
   changed, and the malicious web site operator would need to know the
   name of each file.
 - The second vulnerability is a new variant of a previously-identified
   cross-frame security vulnerability. A particular malformed URL could
   be used to execute scripts in the security context of a different
   domain. This could allow a malicious web site operator to execute a
   script on the web site, and gain privileges on visiting users' machines
   that are normally granted only to their trusted sites.
 - The third vulnerability affects only Internet Explorer 5.0, and is a
   new variant of a previously-identified untrusted scripted paste
   vulnerability. The vulnerability would allow a malicious web site
   operator to create a particular type of web page control and paste
   into it the contents of a visiting user's clipboard.

While there are no reports of customers being adversely affected by any of
these vulnerabilities, Microsoft is proactively releasing an updated version
of MSHTML.DLL to allow customers to take appropriate action to protect
themselves against it.

Affected Software Versions
==========================
 - Internet Explorer 4.0 and 5 on Windows 95, Windows 98
   and Windows NT 4.0.

What Microsoft is Doing
=======================
Microsoft has released patches that fix the problem identified. The patches
are available for download from the sites listed below in What Customers
Should Do.

Microsoft also has sent this security bulletin to customers
subscribing to the Microsoft Product Security Notification Service.
See http://www.microsoft.com/security/services/bulletin.asp for
more information about this free customer service.

Microsoft has published the following Knowledge Base (KB) article on this
issue:
 - Microsoft Knowledge Base (KB) article Q226326,
   Update Available for MSHTML Security Issues in Internet Explorer,
   http://support.microsoft.com/support/kb/articles/q226/3/26.asp.
   (Note: It might take 24 hours from the original posting of this
   bulletin for the KB article to be visible in the Web-based Knowledge
   Base.)

What Customers Should Do
========================
Microsoft highly recommends that customers evaluate the degree of
risk that this vulnerability poses to their systems and determine
whether to download and install the patch. The patch can be found at
http://www.microsoft.com/windows/ie/security/mshtml.asp.

More Information
================
Please see the following references for more information related to this
issue.
 - Microsoft Security Bulletin MS99-012,
   MSHTML Update Available for Internet Explorer (The Web-posted
   version of this bulletin),
   http://www.microsoft.com/security/bulletins/ms99-012.asp.
 - Microsoft Knowledge Base (KB) article Q226326,
   Update Available for MSHTML Security Issues in Internet Explorer,
   http://support.microsoft.com/support/kb/articles/q226/3/26.asp.
 - Microsoft Security Bulletin MS98-013,
   Fix available for Internet Explorer Cross Frame Navigate Vulnerability,
   http://www.microsoft.com/security/bulletins/ms98-013.asp
 - Microsoft Security Bulletin MS98-015,
   Update available for "Untrusted Scripted Paste" Issue in Microsoft
   Internet Explorer 4.01,
   http://www.microsoft.com/security/bulletins/ms98-015.asp

Obtaining Support on this Issue
===============================
If you require technical assistance with this issue, please contact
Microsoft Technical Support. For information on contacting Microsoft
Technical Support, please see
http://support.microsoft.com/support/contact/default.asp.

Acknowledgments
===============
Microsoft acknowledges Richard M. Smith, President, Phar Lap Software, Inc.,
for discovering the IMG SRC vulnerability, and Georgi Guninski from
TechnoLogica Ltd., Bulgaria, for discovering the cross-frame and untrusted
scripted paste vulnerabilities.

Revisions
=========
 - April 21, 1999: Bulletin Created.


For additional security-related information about Microsoft products, please
visit http://www.microsoft.com/security
----------------------------------------------------------------------

THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS PROVIDED "AS IS"
WITHOUT WARRANTY OF ANY KIND. MICROSOFT DISCLAIMS ALL WARRANTIES, EITHER
EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES OF MERCHANTABILITY AND FITNESS
FOR A PARTICULAR PURPOSE. IN NO EVENT SHALL MICROSOFT CORPORATION OR ITS
SUPPLIERS BE LIABLE FOR ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT,
INCIDENTAL, CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN
IF MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES. SOME STATES DO NOT ALLOW THE EXCLUSION OR
LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES SO THE
FOREGOING LIMITATION MAY NOT APPLY.

(c) 1999 Microsoft Corporation. All rights reserved.

   *******************************************************************
You have received  this e-mail bulletin as a result  of your registration
to  the   Microsoft  Product  Security  Notification   Service.  You  may
unsubscribe from this e-mail notification  service at any time by sending
an  e-mail  to  MICROSOFT_SECURITY-SIGNOFF-REQUEST@ANNOUNCE.MICROSOFT.COM
The subject line and message body are not used in processing the request,
and can be anything you like.

For  more  information on  the  Microsoft  Security Notification  Service
please    visit    http://www.microsoft.com/security/bulletin.htm.    For
security-related information  about Microsoft products, please  visit the
Microsoft Security Advisor web site at http://www.microsoft.com/security.

---------------------------------------------------------------------------------

Date: Thu, 22 Apr 1999 03:28:52 -0400
From: Russ <Russ.Cooper@RC.ON.CA>
To: NTBUGTRAQ@LISTSERV.NTBUGTRAQ.COM
Subject: Alert: Microsoft Security Bulletin (MS99-012) - MSHTML.dll

Note: URLs may be line wrapped

Microsoft have released a Security Bulletin;

http://www.microsoft.com/security/bulletins/ms99-012.asp

which covers 3 issues with the MSHTML.dll component of IE 4.0 and IE 5.0
(MSHTML is responsible for parsing URLs).

The first issue was discovered by Richard Smith of Pharlap (and not
reported to NTBugtraq) and has to do with IMG SRC tags (which allowed
them to load local files).

The other 2 issues were discovered by Georgi Guninski and reported in
NTBugtraq messages;

Trust Zone vulnerability:
http://ntbugtraq.ntadvice.com/default.asp?pid=36&sid=1&A2=ind9903&L=ntbu
gtraq&F=P&S=&P=16238

Cross-frame vulnerability:
http://ntbugtraq.ntadvice.com/default.asp?pid=36&sid=1&A2=ind9904&L=ntbu
gtraq&F=P&S=&P=1516

on March 30th and April 9th respectively.

It should be noted that installation of the replacement MSHTML.dll
requires a reboot! The fix location is;

http://www.microsoft.com/windows/ie/security/mshtml.asp

execution of Georgi's demonstration pages (after rebooting!);

Trust Zone vulnerability:
http://www.nat.bg/~joro/scrspoof.html

Cross-frame vulnerability:
http://www.nat.bg/~joro/fr.html

shows nothing unexpected.

While the Bulletin states that the same MS Knowledgebase article,
Q226326, applies to both MS99-011 and MS99-012, it was *not* available
at the time of this writing (meaning it was there 10 minutes ago, but
its not there now??). See;

http://support.microsoft.com/support/kb/articles/q226/3/26.asp

<rant>
I just take this opportunity to say that I think Microsoft needs to make
everyone aware of any installation process that requires a reboot to
complete. There is no mention anywhere that fixing a browser component
would require a system reboot, and while I can understand why its needed
(having experience and all), no doubt lots of folks wouldn't expect it
to be a requirement (although lots of folks likely believe that
everything you do to an NT box requires a reboot!).

The DHMTL fix doesn't require a reboot, but the MSHTML fix does. Given
that both download pages recommend that you "Open" or "Run" the
download, causing it to execute, one could easily find oneself in the
position of being prompted for a reboot when you didn't expect one.

Even the "detailed instructions" don't acknowledge that a reboot is
required.

A simple large, bold, message at the top of any download page indicating
what will be expected if the download is "Open" or "Run" might at least
acknowledge that too many reboots are expected by Microsoft.
</rant>

Cheers,
Russ - NTBugtraq moderator

---------------------------------------------------------------------------------

Date: Thu, 22 Apr 1999 15:39:14 -0700
From: Aleph One <aleph1@UNDERGROUND.ORG>
To: NTBUGTRAQ@LISTSERV.NTBUGTRAQ.COM
Subject: Re: Alert: Microsoft Security Bulletin (MS99-012) - MSHTML.dll

On Thu, Apr 22, 1999 at 03:28:52AM -0400, Russ wrote:
>
> Cross-frame vulnerability:
> http://www.nat.bg/~joro/fr.html

I believe that is incorrect. That is an example of the other file stealing
vulnerability in the DHTML Edit component. Yes, there where two
of them in the same component. The cross-frame vulnerability test are:

http://www.nat.bg/~joro/scrspoof.htmlasd
http://www.nat.bg/~joro/scriptlet.html
http://www.nat.bg/~joro/scrauto.html

--
Aleph One / aleph1@underground.org
http://underground.org/
KeyID 1024/948FD6B5
Fingerprint EE C9 E8 AA CB AF 09 61  8C 39 EA 47 A8 6A B8 01

