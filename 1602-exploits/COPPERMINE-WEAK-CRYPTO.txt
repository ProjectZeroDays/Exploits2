[+] Credits: hyp3rlinx

[+] Website: hyp3rlinx.altervista.org

[+] Source:
http://hyp3rlinx.altervista.org/advisories/COPPERMINE-WEAK-CRYPTO.txt



Vendor:
======================
coppermine-gallery.net



Product:
=========================
Coppermine 1.5.40
downloads as cpg1.5.40.zip


Coppermine is a multi-purpose fully-featured and integrated web picture
gallery script written
in PHP using GD or ImageMagick as image library with a MySQL backend.



Vulnerability Type:
===================
Weak Crypto



Vulnerability Details:
=====================

Coppermine stores users passwords in using weak MD5 hash function without
any salt.

Using weak cryptographic one-way hash functions like MD5 without using salt
for storing user passwords allows attackers
that gain access to this data ability to conduct password cracking attacks
using pre-computed dictionaries, e.g. rainbow tables.
if their local machine is compromised and attackers gain access to the MD5
hashed passwords.

e.g.

e99a18c428cb38d5f260853678922e03 MD5 : abc123


In register.php line 591 we find following md5 one way hash function
applied to users password with no salt whatsoever, then stored in DB.

$encpassword = md5($password);



$user_language = $CONFIG['lang'];


$sql = "INSERT INTO {$CONFIG['TABLE_USERS']} (user_regdate, user_active,
user_actkey, user_name, user_password, user_email, user_profile1,
user_profile2, user_profile3, user_profile4, user_profile5, user_profile6,
user_language) VALUES (NOW(), '$active', '$act_key', '$user_name',
'$encpassword', '$email', '$profile1', '$profile2', '$profile3',
'$profile4', '$profile5', '$profile6', '$user_language')";
$result = cpg_db_query($sql);


Disclosure Date:
================================
Feb 26, 2016 : Public Disclosure


=================================

[+] Disclaimer
Permission is hereby granted for the redistribution of this advisory,
provided that it is not altered except by reformatting it, and that due
credit is given. Permission is explicitly given for insertion in
vulnerability databases and similar, provided that due credit is given to
the author.
The author is not responsible for any misuse of the information contained
herein and prohibits any malicious use of all security related information
or exploits by the author or elsewhere. All Content is (c) of hyp3rlinx.

hyp3rlinx â„¢
