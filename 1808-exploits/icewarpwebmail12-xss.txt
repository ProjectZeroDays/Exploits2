[+] Title: IceWarp WebMail Cross Site Scripting (XSS) & Execution Code
[+] Date: 2018/08/13
[+] Author: Mostafa Gharzi
[+] Team: Maher - CertCC.ir
[+] Vendor Homepage: www.icewarp.com
[+] Tested on: Windows 10 & Kali Linux
[+] Versions: 12.0.3.1 and Before
[+] Vulnerable Parameter: Post Method
[+] Vulnerable File: /webmail/ & /webmail/#sign-in
[+} Dork : intext:"Sign in to WebClient"
           intext:Powered by IceWarp A(c) 2018

### Notes:

An attacker can use XSS (in username field from Sign-in section IceWarp
WebMail 12.0.3.1 and Before)to send a malicious script to an unsuspecting
Admins or users. The end admins or useras browser has no way to know that
the script should not be trusted, and will execute the script. Because it
thinks the script came from a trusted source, the malicious script can
access any cookies, session tokens, or other sensitive information retained
by the browser and used with that site. These scripts can even rewrite the
content of the HTML page. Even an attacker can easily place users in social
engineering through this vulnerability and create a fake field.

### POC:

[+] First, Go to Sign-in page through this path: http://localhost/webmail/
                                                 or

http://localhost:32000/webmail/

[+] For example, put this code in the Usernam field: <img src="Image link">
                                                     or
                                                     "><img src=x
onerror=prompt(/certcc/)>
                                                     or
                                                     "><br>text

[+] When the user clicks on the next option, he sees the alert or
executable code.

[+] Therefore, the administrator or users are attacked by XSS.

### Demo PIC:

[+] http://gucert.ir/icewarp.jpg

[+] http://gucert.ir/icewarp2.jpg

### Credit:

[+] CertCC.ir
