# Exploit Title : Blackcat CMS XSS Vulnerability
# Date: 21/June/2017
# Exploit Author: Faiz Ahmed Zaidi Organization: Provensec LLC Website: http://provensec.com/
# Vendor Homepage: https://blackcat-cms.org/
# Software Link: https://blackcat-cms.org/page/download.php
# Version: blackcatcms_v1.2_Bundle
# Tested on: Windows 10 (Xampp)
# CVE : CVE-2017-9609

Suggested description:

I would like to report a vulnerability that I discovered in BlackCat CMS
(blackcatcms_v1.2_Bundle), which can be exploited to perform Cross-Site 
Scripting (XSS) attacks.

The vulnerability exists due to insufficient sanitization of the 
amap_languagea HTTP POST parameter passed to 
a/backend/pages/lang_settings.php?page_id=1a script.The exploitation 
example below uses the "alert()" JavaScript function to display 
"Provensec" word.

Cross-Site Scripting (XSS) attacks are a type of injection, in which
malicious scripts are injected into otherwise benign and trusted web
sites. XSS attacks occur when an attacker uses a web application to
send malicious code, generally in the form of a browser side script,
to a different end user. Flaws that allow these attacks to succeed are
quite widespread and occur anywhere a web application uses input from
a user within the output it generates without validating or encoding
it.

An attacker can use XSS to send a malicious script to an unsuspecting
user. The end user's browser has no way to know that the script should
not be trusted, and will execute the script. Because it thinks the
script came from a trusted source; the malicious script can access any
cookies, session tokens, or other sensitive information retained by
the browser and used with that site. These scripts can even rewrite
the content of the HTML page.

------------------------------------------

Vulnerability Type:
Cross Site Scripting (XSS)

------------------------------------------

Vendor of Product:
Black Cat Development

------------------------------------------

Affected Product Code Base:
Blackcat CMS (https://blackcat-cms.org/) - blackcatcms_v1.2_Bundle

------------------------------------------

Affected Component:
https://localhost/blackcatcms_v1.2_Bundle/backend/pages/lang_settings.php
https://localhost/blackcatcms_v1.2_Bundle/backend/pages/lang_settings_save.php

------------------------------------------

Attack Type:
Remote

------------------------------------------

Attack Vectors:
Steps:
1.Login to BlackCat CMS.
2.Open the URL 
"https://localhost/blackcatcms_v1.2_Bundle/backend/pages/lang_settings.php?page_id=1".
3.Create and Save the Create link.
4.Tamper the "map_language" parameter and insert payload in it.
Here, payload I used a<script>alert(/Provensec/)</script>a.
5.Forward the tampered request.
6.XSS gets executed on 
"https://localhost/blackcatcms_v1.2_Bundle/backend/pages/lang_settings_save.php" 
page.

------------------------------------------

Reference:
https://www.owasp.org/index.php/Cross-site_Scripting_(XSS)

------------------------------------------

Discoverer:
Author: Faiz Ahmed Zaidi Organization: Provensec LLC Website: 
http://provensec.com/

------------------------------------------


*--
*

*Thanks & Regards*

*Faiz Ahmed Zaidi*

*Information Security Researcher
*

*Provensec* <http://provensec.com/>*
*

