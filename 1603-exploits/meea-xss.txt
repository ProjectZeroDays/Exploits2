*Multiple Cross Site Scripting Attack - ManageEngine EventLog Analyzer
v.11.0 Build 11000*



*Overview-----------------------------------------------------------------------------------------------------------------------------*
Vendor: Manage Engine
Vulnerable Product: EventLog Analyzer v.11.0 Build 11000
Vulnerability Type : Multiple Cross Site Scripting Vulnerability
Vulnerable Version : v.11.0 Build 11000
Vendor Homepage:https://www.manageengine.com/products/eventlog/download.html
<https://www.manageengine.com/products/firewall/download.html>
<https://www.manageengine.com/products/firewall/download.html>
CVE-ID : NA
Severity : High
Author – Omkar Joshi

Vulnerability Reported: 09/03/2016
Response From Vendor: 09/03/2016
Vendor Confirmation: 10/03/2016
Patch Released: Not yet

*Product Description *
---------------------------------------------------------------------------------------------------------------------------------

EventLog Analyzer provides the most cost-effective Security Information and
Event Management (SIEM) software on the market. Using this Log Analyzer
software, organizations can automate the entire process of managing
terabytes of machine generated logs by collecting, analyzing, correlating,
searching, reporting, and archiving from one central location.
This event log analyzer software helps to monitor file integrity, conduct
log forensics analysis, monitor privileged users and comply to different
compliance regulatory bodies by intelligently analyzing your logs and
instantly generating a variety of reports like user activity reports,
historical trend reports, and more.

*Proof of Concept URL *
-----------------------------------------------------------------------------------------------------------------------------------

Stored XSS ->
http://localhost:8400/event/index2.do?url=editAlertForm&tab=alert&NOTIFID=52&ALERT_NAME=Test&alert=profile
<http://localhost:8020/scheduleReport.do?actionToCall=showScheduleReport>

Reflected XSS ->
http://localhost:8400/event/index2.do?url=ConfigureTemplate&tab=system&sel=13&helpP=fim&link=1
<http://localhost:8020/scheduleReport.do?actionToCall=showScheduleReport>

*Credits & Authors*
-------------------------------------------------------------------------------------------------------------------------------------

Omkar Joshi
<http://localhost:8020/scheduleReport.do?actionToCall=showScheduleReport>


*Steps to Reproduce:**Attack Scenario*:
*Stored Cross Site Scripting Attack*
Step 1. Login into EventLog Analyzer v11.0
Step 2: Go to Add Hosts.
Step 3: Once done with adding Hosts go to Add alert
Step 4: Insert XSS payload in "ToAddress" and "Subject" parameter of
"Email".
I have used "><img src=x onerror=prompt(document.cookie);> XSS payload
Step 5: Then click on Save Alert Profile
Step 6: Whenever anyone try to edit the alert XSS Script will get execute.



*Attack Scenario: Reflected Cross Site Scripting Attack*Step 1. Login into
EventLog Analyzer v11.0
Step 2: Go to Settings.
Step 3: Click on File Monitoring and Go to Add Host
Step 4: Now Click on Assign Template
Step 4: Insert XSS payload in Location(s), File(s)
I have used "><img src=x onerror=prompt(document.cookie)> XSS payload
Step 5: Then click on Enable Settings to submit the data and Script will
get execute.

*Impact of attack*: An attack can perform Cross Site Scripting attack and
steal the cookie of other active sessions.

An attacker would exploit a vulnerability within a website or web
application that the victim would visit, essentially using the vulnerable
website as a vehicle to deliver a malicious script to the victim’s browser.

An attacker might be able to put stored XSS into the website.

https://www.owasp.org/index.php/Cross-site_Scripting_(XSS)

*Recommendation*: Use an appropriate combination of white listing and
blacklisting to ensure only valid and expected input is processed by the
system.
Furthermore, classes within the output tag libraries should also be
modified to encode potentially dangerous characters with their HTML escape
Counter parts.

For more information refer the following link

https://www.owasp.org/index.php
/XSS_(Cross_Site_Scripting)_Prevention_Cheat_Sheet

