##################################################################################

# Exploit Title : Masch CMStudio Banners Modules 8.6.1 Open Redirection
# Author [ Discovered By ] : KingSkrupellos
# Team : Cyberizm Digital Security Army
# Date : 28/03/2019
# Vendor Homepage : masch.com/en-us/home/
# Software Information Link : masch.com/en/cmstudio-enterprise/
# Software Affected Versions : 7.1.3 - 8.4.1 - 8.5.1 - 8.6.1
# Tested On : Windows and Linux
# Category : WebApps
# Exploit Risk : High
# Google Dorks : bannergo.php inurl:/modules/banners/
# Vulnerability Type : CWE-601 [ URL Redirection to Untrusted Site ('Open Redirect') ]
# PacketStormSecurity : packetstormsecurity.com/files/authors/13968
# CXSecurity : cxsecurity.com/author/KingSkrupellos/1/
# Exploit4Arab : exploit4arab.org/author/351/KingSkrupellos

##################################################################################

# Information About Software :
****************************
Masch CM Studio Banner & Photo-Gallery - The latest release of the MASCH's photo and banner gallery 

software enables you as an operator of the website to create, edit, and expand photo galleries or advertising 

banners at any time in order to be able to display current pictures of your products professionally on your website.

##################################################################################

# Impact :
***********
Masch CMStudio Banners Modules 8.6.1 and other versions accepts a user-controlled input that specifies a 

link to an external site, and uses that link in a Redirect. This simplifies phishing attacks. An http parameter may 

contain a URL value and could cause the web application to redirect the request to the specified URL. 

By modifying the URL value to a malicious site, an attacker may successfully launch a phishing scam and

steal user credentials. Because the server name in the modified link is identical to the original site, phishing attempts 

have a more trustworthy appearance. Open redirect is a failure in that process that makes it possible for attackers to 

steer users to malicious websites. This vulnerability is used in phishing attacks to get users to visit malicious sites 

without realizing it. Web users often encounter redirection when they visit the Web site of a company whose name 

has been changed or which has been acquired by another company. Visiting unreal web page user's computer 

becomes affected by malware the task of which is to deceive the valid actor and steal his personal data.

##################################################################################

# Vulnerable File :
*****************
/bannergo.php

# Vulnerable Parameter :
***********************
?url=

?id=

?id=[ID-NUMBER]&url=

# Open Redirection Exploit :
***************************
/modules/banners/bannergo.php?url=https://www.[REDIRECTION-ADDRESS].gov

/modules/banners/bannergo.php?id=[ID-NUMBER]&url=https://www.[REDIRECTION-ADDRESS].gov

##################################################################################

# Discovered By KingSkrupellos from Cyberizm.Org Digital Security Team 

##################################################################################
