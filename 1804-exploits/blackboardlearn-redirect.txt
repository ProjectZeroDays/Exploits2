CVE-2017-18262



[Description]

Since at least the 17th of October 2017 (Initial report date) Blackboard Learn has allowed Unvalidated Redirects on any signed in user through its endpoints for handling Shibboleth logins.



The vulnerable endpoint is: 



BLACKBOARD/webapps/bb-auth-provider-shibboleth-BBLEARN/execute/shibbolethLogin?returnUrl=myEvilUrl&amp;authProviderId=realAuthProvider



Where:

BLACKBOARD is the Blackboard Learn web server endpoint.

myEvilUrl is any URL you want, URL encoded of course.

realAuthProvider is the auth provider, normally you can just gather this by attempting a real shibboleth login and looking at what authProviderId is set to.



This attack only works against Blackboard Learn web servers with Shibboleth set up.



[Reproduction steps]



Set up a blackboard learn web server, make sure shibboleth is set up.

Copy the shibboleth login URL from the sign in page (should look like the endpoint above)

Replace the returnUrl with another URL (myEvilUrl).

Open the URL and log in as normal (if not already signed in properly to complete shibboleth login).

You will be redirected to the returnUrl you gave, regardless of what that url is.





[Type]

Unvalidated Redirect



[Vendor]

Blackboard Inc


[Discoverer]
Ethan Sweet




