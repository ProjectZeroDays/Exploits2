------------------------------------------------------------------------
Cross-Site Scripting in Link Library WordPress Plugin
------------------------------------------------------------------------
Burak Kelebek, July 2016

------------------------------------------------------------------------
Abstract
------------------------------------------------------------------------
A Reflected Cross-Site Scripting (XSS) vulnerability has been found in
the Link Library plugin. By using this vulnerability an attacker can
inject malicious JavaScript code into the application, which will
execute within the browser of any logged-in admin.

------------------------------------------------------------------------
OVE ID
------------------------------------------------------------------------
OVE-20160724-0016

------------------------------------------------------------------------
Tested versions
------------------------------------------------------------------------
This issue was successfully tested on Link Library version 5.9.12.29.

------------------------------------------------------------------------
Fix
------------------------------------------------------------------------
This issue is fixed in version 5.9.12.30

------------------------------------------------------------------------
Details
------------------------------------------------------------------------
https://sumofpwn.nl/advisory/2016/cross_site_scripting_in_link_library_wordpress_plugin.html

Cross-Site Scripting (XSS) attacks are a type of injection, in which malicious scripts are injected into otherwise benign and trusted web sites. XSS attacks occur when an attacker uses a web application to send malicious code, generally in the form of a browser side script, to a different end user. Flaws that allow these attacks to succeed are quite widespread and occur anywhere a web application uses input from a user within the output it generates without validating or encoding it. Reflected XSS occurs when user input is immediately returned by a web application in an error message, search result, or any other response that includes some or all of the input provided by the user as part of the request

"successimportcount" and "sucessupdatecount" fields do not validate <script> tags and do not perform output encoding.

/link-library/link-library-admin.php

885: echo echo "<div id='message' class='updated fade'><p><strong>" . ($_GET['successimportcount'] : '0') . " " . __('link(s) imported', 'link-library') . ", " . ($_GET['successupdatecount'] : '0') . " " . __('link(s) updated', 'link-library') . ".</strong></p></div>";

Proof of concept

http://<targetsite>/wp-admin/admin.php?page=link-library-settingssets&messages=9&successimportcount=1" /><script>alert(1)</script>&currenttab=importexport


------------------------------------------------------------------------
Summer of Pwnage (https://sumofpwn.nl) is a Dutch community project. Its
goal is to contribute to the security of popular, widely used OSS
projects in a fun and educational way.

