------------------------------------------------------------------------
Cross-Site Scripting in WordPress Landing Pages Plugin
------------------------------------------------------------------------
Burak Kelebek, July 2016

------------------------------------------------------------------------
Abstract
------------------------------------------------------------------------
A reflected Cross-Site Scripting (XSS) vulnerability has been found in
the WordPress Landing Pages Plugin. By using this vulnerability an
attacker can inject malicious JavaScript code into the application,
which will execute within the browser of any user who views the Activity
Log, in general WP admin.

------------------------------------------------------------------------
OVE ID
------------------------------------------------------------------------
OVE-20160721-0001

------------------------------------------------------------------------
Tested versions
------------------------------------------------------------------------
This issue was successfully tested on WordPress Landing Pages version
2.2.4.

------------------------------------------------------------------------
Fix
------------------------------------------------------------------------
This issue is fixed in WordPress Landing Pages version 2.2.5.

------------------------------------------------------------------------
Details
------------------------------------------------------------------------
https://sumofpwn.nl/advisory/2016/cross_site_scripting_in_wordpress_landing_pages_plugin.html

Cross-Site Scripting (XSS) attacks are a type of injection, in which malicious scripts are injected into otherwise benign and trusted web sites. XSS attacks occur when an attacker uses a web application to send malicious code, generally in the form of a browser side script, to a different end user. Flaws that allow these attacks to succeed are quite widespread and occur anywhere a web application uses input from a user within the output it generates without validating or encoding it. Reflected XSS occurs when user input is immediately returned by a web application in an error message, search result, or any other response that includes some or all of the input provided by the user as part of the request

"open-tab" field does not validate <script> tags and does not perform output encoding.

landing-pages/classes/class.settings.php:

177: $active_tab = $_REQUEST['open-tab'];
   
[...]
   
204: echo echo "<form action='edit.php?post_type=landing-page&page=lp_global_settings' method='POST'>    <input type='hidden' name='nature' value='lp-global-settings-save'>    <input type='hidden' name='open-tab' id='id-open-tab' value='{$active_tab}'>";

Proof of concept

http://<target>/wp-admin/edit.php?post_type=landing-page&page=lp_global_settings&open-tab=foobar%5C%27%3E%3Cscript%3Ealert%281%29%3C%2Fscript%3E

------------------------------------------------------------------------
Summer of Pwnage (https://sumofpwn.nl) is a Dutch community project. Its
goal is to contribute to the security of popular, widely used OSS
projects in a fun and educational way.
