Date: Thu, 11 Mar 1999 16:00:00 -0000
From: security-alert@cisco.com
Reply-To: psirt@cisco.com
To: BUGTRAQ@netspace.org
Subject: Cisco security notice: Cisco 7xx TCP and HTTP vulnerabilities

-----BEGIN PGP SIGNED MESSAGE-----

Cisco 7xx TCP and HTTP Vulnerabilities
=================================================
Revision 1.1
For release 08:00 AM US/Pacific, Thursday, March 11, 1999

Cisco internal use only until release date

Summary
=======
This notice addresses two unrelated security vulnerabilities in the software
used on the Cisco 7xx series of small-office and home-office routers. These
vulnerabilities affect only the 7xx series routers (not the 7xxx series); no
other Cisco product is affected.

The first vulnerability, which has been assigned Cisco bug ID CSCdm03231,
can be used to cause system reloads, and therefore denial of service, using
TCP connections to the routers' TELNET ports.

The second vulnerability has not been assigned a bug ID. 7xx routers running
software versions 3.2(5) through 4.2(3) support a simple HTTP server. This
HTTP server is enabled by default. Unless the server is explicitly disabled,
it can be used to make changes to the router configuration, and/or to gain
information about that configuration. This is intentional behavior, but is
mentioned in this notice because it appears that customers have been caught
unawares by it.

There are configuration workarounds for both of these vulnerabilities.

Who Is Affected
===============
Only networks incorporating 7xx series small-office/home-office routers are
affected by these vulnerabilities. 7xx routers are designed to provide
network connectivity for small remote networks using ISDN BRI lines. If your
network includes 7xx series routers, they are most likely to be found in the
homes of network users, or in remote offices with no more than a few
employees.

CSCdm03231 affects all Cisco 7xx routers, running any software version up to
and including release 4.2(3), whose administrators have not taken specific
steps to filter incoming TCP connections. Such filtering is not enabled by
default. Routers running release 4.3(1) or later software are not affected
by CSCdm03231.

The HTTP server is present in all software releases from 3.2(5) through
4.2(3), inclusive. The server is enabled by default in all of these software
versions.

Impact
======

Impact of CSCdm03231
- ------------------
CSCdm03231 permits a remote attacker to force a 7xx router to reload,
denying service to the router's home or small office user. It may sometimes
be possible to degrade performance without actually inducing a router
reload. The attack consumes relatively little bandwidth compared to
flooding-based denial of service attacks. In all cases, the router will
recover after the attack stops; the attacker must send traffic continuously
to maintain denial of service. However, if the router has reloaded, the end
user may have to take some installation-dependent action to cause the router
to redial the ISDN connection.

This vulnerability does not give attackers access to the router CLI, nor
does it give them any other way of controlling the router beyond inducing
denial of service.

Impact of the Presence of the HTTP Server
- ---------------------------------------
If the HTTP server is enabled, it can be used to change the router's
configuration, or to retrieve information about that configuration. No
special tools are required.

Software Details
================
CSCdm03231 affects all software versions earlier than 4.3(1). Customers with
76x or 77x routers should upgrade to release 4.3(1). Because of memory
limitations, release 4.3 is not supported on the 75x routers; customers with
75x routers should use IP filtering as described in the "Workarounds"
section.

The HTTP server is present in all software versions from 3.2(5) through
4.2(3). It is not present in 3.2(4) or earlier releases, nor is it present
in 4.3. Customers with 76x or 77x routers should upgrade to release 4.3(1),
primarily because of the desirability of installing the CSCdm03231 fix. The
HTTP server may be disabled in any software version; disabling the server is
the recommended course of action for customers with 75x routers.

Getting Fixed Software
- --------------------
Cisco is offering free software upgrades to remedy CSCdm03231 for all
vulnerable customers, regardless of contract status. Customers with service
contracts may upgrade to any software version, although they may only
install the feature sets they've already purchased. Customers without
contracts may upgrade to version 4.3(1).

Customers with contracts should obtain upgraded software through their
regular update channels. For most customers, this means that upgrades should
be obtained via the Software Center on Cisco's Worldwide Web site at
http://www.cisco.com.

Customers without contracts should get their upgrades by contacting the
Cisco Technical Assistance Center (TAC). TAC contacts are as follows:

   * +1 800 553 2447 (toll-free from within North America)
   * +1 408 526 7209 (toll call from anywhere in the world)
   * e-mail: tac@cisco.com

Give the URL of this notice as evidence of your entitlement to a free
upgrade. Free upgrades for non-contract customers must be requested through
the TAC. Please do not contact either "psirt@cisco.com" or
"security-alert@cisco.com" for software upgrades.

Workarounds
===========

Workaround for CSCdm03231
- -----------------------
CSCdm03231 can be made much less useful to attackers by preventing incoming
TCP connections to the router from untrusted hosts. This can be done with
the set ip filter profile command, as in the following example:

     set ip filter tcp source = not trusted-host destination = router block

This example would configure the router to accept incoming TCP connections
only from a single trusted administrative host. More elaborate
configurations, permitting connections of various types from various hosts,
are possible; see the router documentation for more information.

Disabling the HTTP Server
- -----------------------
The HTTP server may be disabled with the system command set clickstart off.

Exploitation and Public Announcements
=====================================
Cisco knows of no public announcements or discussion of CSCdm03231 before
the date of this notice. Cisco has had no reports of malicious exploitation
of CSCdm03231. CSCdm03231 was found by an outside security company during
laboratory testing.

A simple program is needed to effectively exploit CSCdm03231. Although Cisco
knows of no program available to the public specifically for this purpose,
writing such a program would require very little effort, and only the most
basic of skill. Also, certain publicly-available programs intended for other
purposes could be used or adapted to exploit the vulnerability.

Cisco has had no reports of abuse of the HTTP server on the 7xx series.
However, the potential for abuse is discussed in the product documentation,
and must be considered to be known to potential attackers.

Status of This Notice
=====================
This is a final field notice. Although Cisco cannot guarantee the accuracy
of all statements in this notice, all the facts have been checked to the
best of our ability. Cisco does not anticipate issuing updated versions of
this notice unless there is some material change in the facts. Should there
be a significant change in the facts, Cisco may update this notice.

Distribution
- ----------
This notice will be posted on Cisco's Worldwide Web site at
http://www.cisco.com/warp/public/770/7xxconn-pub.shtml . In addition to
Worldwide Web posting, the initial version of this notice is being sent to
the following e-mail and Usenet news recipients:

   * cust-security-announce@cisco.com
   * bugtraq@netspace.org
   * first-teams@first.org (includes CERT/CC)
   * Various internal Cisco mailing lists

Future updates of this notice, if any, will be placed on Cisco's Worldwide
Web server, but may or may not be actively announced on mailing lists or
newsgroups. Users concerned about this problem are encouraged to check the
URL given above for any updates.

Revision History
- --------------
 Revision 1.0,      Initial release candidate version
 22:00 US/Pacific
 09-MAR-1999
 Revision 1.1,      Minor editing of software names
 09:30 US/Pacific
 10-MAR-1999

Cisco Security Procedures
=========================
Complete information on reporting security vulnerabilities in Cisco
products, obtaining assistance with security incidents, and registering to
receive security information from Cisco, is available on Cisco's Worlwide
Web site at

  http://www.cisco.com/warp/public/791/sec_incident_response.shtml

This includes instructions for press inquiries regarding Cisco security
notices.

- ------------------------------------------------------------------------
This notice is copyright 1999 by Cisco Systems, Inc. This notice may be
redistributed freely after the release date given at the top of the text,
provided that redistributed copies are complete and unmodified, including
all date and version information.
- ------------------------------------------------------------------------

-----BEGIN PGP SIGNATURE-----
Version: Big secret

iQEVAwUBNuaxtnLSeEveylnrAQEAoQgAnPQwYAa487iEbvIXzQ0WvEbHB0ZlqV6Z
j8THdtkyJZtSPATd31JGhQXtHQ1YDuuCC8sV16cPzBFTiWXG0QLErSJD7rpvDHGD
nLTHf9dlVD3Yz+lWgJw6S1Y66G0MsRwbAkegXdxdCy/jVm8C4BMLq3Hz4qVY02+A
TygTm/jK58ScyVjs3a/6sgxxAQlJYz/QmYyc2hbDqbRtC78Dmr6TAdTJLUOHHfPC
hlN9eBeOa8KhT6yDEw65mBtnGxGGj+vgCahyLCUjGWsQMUGJqqY9QcEIXPbmcY10
MAQoaAghzttnhNITXMRli0LQBcakn25g4IX8Oc/q4gk10NE0J09e3A==
=oAI6
-----END PGP SIGNATURE-----

-----BEGIN PGP PUBLIC KEY BLOCK-----
Version: GnuPG v0.9.4 (GNU/Linux)
Comment: For info see http://www.gnupg.org

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
=l8tP
-----END PGP PUBLIC KEY BLOCK-----

-----------------------------------------------------------------------

Date: Thu, 11 Mar 1999 11:44:28 -0500
From: X-Force <xforce@ISS.NET>
To: BUGTRAQ@netspace.org
Subject: ISS Security Advisory: Remote Reconfiguration and Denial of
         Service Vulnerabilities in Cisco 700 ISDN Routers
 
-----BEGIN PGP SIGNED MESSAGE-----

ISS Security Advisory
March 11, 1999


Remote Reconfiguration and Denial of Service Vulnerabilities in Cisco 700
ISDN Routers

Synopsis:

Internet Security Systems (ISS) X-Force has discovered several
vulnerabilities in Cisco Series 700 routers.  The Cisco 700 series is
popular among corporate users and telecommuters.  It is used to support
networks in small offices or home offices.  It is also recommended by
Internet Service Providers (ISPs) for personal ISDN connectivity.  Remote
attackers may issue commands to the router without authentication.  Remote
attackers may also deny network connectivity by forcing the router to
reboot.


Affected Versions:

All versions of IOS/700 on all Cisco 700 series routers are vulnerable. The
700 series includes all models in the 760 and 770 series including the 762M,
766M, 772M, and the 776M.  All international models in this series are also
vulnerable.


Description:

The Cisco 700 series was formerly known as the Combinet 750 series.  Cisco
acquired Combinet and repackaged its products as the Cisco 700 series.  The
Cisco 700 series runs a non-traditional Cisco operating system.  This
advisory is
limited to Cisco 700 series routers only.

Attackers may also take advantage of remote reconfiguration vulnerabilities
in ClickStart.  ClickStart is a small embedded web server in the IOS/700
that allows for easy remote configuration. ClickStart may allow remote
attackers to connect to the router via its web server and issue certain
commands to the router.  Attackers may also learn which type of switch is
connected to the router, as well as the telephone numbers for the ISDN
lines.  Hackers may use this information to launch further attacks.

ClickStart does not attempt to authenticate users that connect to the web
server, nor does it automatically filter connection attempts from outside
the currently configured subnet.  The 700s have the ability to filter these
attacks. For detailed filtering information, users must refer to Cisco's
on-line documentation.

Cisco 700 series is vulnerable to remote resource starvation attacks that
can immediately force the router to panic and reboot.  These attacks can be
repeated indefinitely to permanently deny service to the router.  The Cisco
700 series is also vulnerable to similar well-known denial of service
attacks.


Recommendations:

The ClickStart option is always set to "on" unless it is explicitly turned
off. The following command will disable ClickStart:

Router> set clickstart off

All affected users are urged to review the "For More Information" section of
this advisory.  Cisco urges all Cisco 77x and 76x users to upgrade to
IOS/700 version 4.3(1).  This version is not supported by the Cisco 75x
routers.  All service contract customers may download updates at the
following address:

http://www.cisco.com/cgi-bin/tablebuild.pl/760

Non-contract customers should contact Cisco Technical Assistance Center
(TAC). TAC contacts are as follows:

* +1 800 553 2447 (toll-free from within North America)
* +1 408 526 7209 (toll call from anywhere in the world)
* e-mail: tac@cisco.com


For more information:

Cisco has compiled a document entitled "Cisco 7xx TCP and HTTP
Vulnerabilities" that contains more specific information, as well as
workarounds for these vulnerabilities.  It is available at the following
address:

http://www.cisco.com/warp/public/770/7xxconn-pub.shtml

More extensive online documentation for the Cisco 700 series is available
at:

http://www.cisco.com/univercd/cc/td/doc/product/access/acs_fix/750/700cr/ind
ex.htm


Credits:

These vulnerabilities were primarily researched by Dan Ingevaldson of the
ISS X-Force. ISS appreciates the assistance of the individuals at Cisco
Systems.


________

Copyright (c) 1999 by Internet Security Systems, Inc.  Permission is
hereby granted for the electronic redistribution of this Security Alert.
It is not to be edited in any way without express consent of the X-Force.
If you wish to reprint the whole or any part of this Alert Summary in any
other medium excluding electronic medium, please e-mail xforce@iss.net for
permission.

Internet Security Systems, Inc. (ISS) is the leading provider of adaptive
network security monitoring, detection, and response software that
protects the security and integrity of enterprise information systems.  By
dynamically detecting and responding to security vulnerabilities and
threats inherent in open systems, ISS's SAFEsuite family of products
provide protection across the enterprise, including the Internet,
extranets, and internal networks, from attacks, misuse, and security
policy violations.  ISS has delivered its adaptive network security
solutions to organizations worldwide, including firms in the Global 2000,
nine of the ten largest U.S. commercial banks, and over 35 governmental
agencies.  For more information, call ISS at 678-443-6000 or 800-776-2362
or visit the ISS Web site at http://www.iss.net..

Disclaimer
The information within this paper may change without notice. Use of this
information constitutes acceptance for use in an AS IS condition. There
are NO warranties with regard to this information. In no event shall the
author be liable for any damages whatsoever arising out of or in
connection with the use or spread of this information. Any use of this
information is at the user's own risk.

X-Force PGP Key available at:   http://www.iss.net/xforce/sensitive.html
as well as on MIT's PGP key server and PGP.com's key server.

Please send suggestions, updates, and comments to:
X-Force <xforce@iss.net> of Internet Security Systems, Inc.


-----BEGIN PGP SIGNATURE-----
Version: 2.6.3a
Charset: noconv

iQCVAwUBNufrOTRfJiV99eG9AQEmNAP+IgV6LTFvitDCJowQvZee9nzIgCy2hWHK
XuuaOPjTonUWIgeEZW9M5M/IDOiyLOh4pHoETRg+LU9zNJ80amCfDNDYDiPYnOok
RcPeU5BjMWRJ/nL0yUsbV4TBDCDNHUHUeOSdp7EY25r+aYY6eEpJXc95ERidO7uR
PTtElRd+a4M=
=aP5D
-----END PGP SIGNATURE-----
