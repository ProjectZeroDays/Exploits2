Date: Thu, 27 May 1999 17:18:25 -0400
From: Russ <Russ.Cooper@RC.ON.CA>
To: NTBUGTRAQ@LISTSERV.NTBUGTRAQ.COM
Subject: Alert: Microsoft Security Bulletin (MS99-017) - RAS & RRAS Passwords

On March 20th, Dieter Goepferich [dieter.goepferich@bigfoot.com]
discovered a vulnerability involving both RAS and RRAS. This was
subsequently reported in Heise Online, a German publication;

http://www.heise.de/newsticker/data/cp-12.04.99-000/
http://www.heise.de/newsticker/data/hos-15.04.99-000/

Dieter originally reported it via some "product improvement suggestion"
web form on www.microsoft.de back in March. Together we informed
Microsoft Security (secure@microsoft.com) back in April.

By default the registry key is only accessible to Administrator and the
user/owner of the passwords, but it represents a potential threat and a
location of password information which would not otherwise be expected.

See;

http://www.microsoft.com/security/bulletins/ms99-017.asp

for the complete write up including fix locations. There are two KB
articles about this (one for RAS, and another for RRAS). They were not
yet available at the time of writing.

RAS
http://support.microsoft.com/support/kb/articles/q230/6/81.asp

RRAS
http://support.microsoft.com/support/kb/articles/q233/3/03.asp

Cheers,
Russ - NTBugtraq Editor

-------------------------------------------------------------------------------

Date: Thu, 27 May 1999 15:14:46 -0700
From: aleph1@UNDERGROUND.ORG
To: BUGTRAQ@netspace.org
Subject: Microsoft Security Bulletin (MS99-017)

The following is a Security  Bulletin from the Microsoft Product Security
Notification Service.

Please do not  reply to this message,  as it was sent  from an unattended
mailbox.
                    ********************************

Microsoft Security Bulletin (MS99-017)
--------------------------------------

Patch Available for "RAS and RRAS Password" Vulnerability

Originally Posted: May 27, 1999

Summary
=======
Microsoft has released a patch that eliminates a vulnerability in the
Microsoft (r) Windows NT  (r) Remote Access Service (RAS) and Routing and
Remote Access Service (RRAS) clients, in which a  user's password is cached
even if the user de-selects the "Save password" option.

Issue
=====
When the client software for Microsoft RAS or RRAS is used to dial into a
server, a dialogue  requests the user's userid and password for the server.
On the same dialogue is a checkbox whose  caption reads "Save password" and
which is intended to provide the user with the option to cache  their
security credentials if desired. However, the implemented client
functionality actually  caches the user's credentials regardless of whether
the checkbox is selected or de-selected.

Cached security credentials, which include the password, are stored in the
registry and protected  by ACLs whose default values authorize only local
administrators and the user to access them.  Windows NT 4.0 Service Pack 4
also provides the ability to strongly encrypts the password data  stored in
the registry using the SYSKEY feature.

While there are no reports of customers being adversely affected by this
vulnerability, Microsoft  is proactively releasing a patch that restores
correct functionality to the password caching  function. The patch should be
applied to all machines that are used as RAS or RRAS clients. It is
important to note that RRAS servers also can be used as RRAS clients, and
any machines used in  such a capacity should have the patch applied as well.


Affected Software Versions
==========================
 - Microsoft Windows NT Workstation 4.0
 - Microsoft Windows NT Server 4.0
 - Microsoft Windows NT Server 4.0, Enterprise Edition

What Microsoft is Doing
=======================
Microsoft has released patches that fix the problem identified. The patches
are available for  download from the sites listed below in What Customers
Should Do.

Microsoft also has sent this security bulletin to customers
subscribing to the Microsoft Product Security Notification Service.
See http://www.microsoft.com/security/services/bulletin.asp for
more information about this free customer service.

Microsoft has published the following Knowledge Base (KB) article on this
issue:
 - Microsoft Knowledge Base (KB) article Q230681,
   RAS Credentials Saved when "Save Password" Option Unchecked,
   http://support.microsoft.com/support/kb/articles/q230/6/81.asp
 - Microsoft Knowledge Base (KB) article Q233303,
   RRAS Credentials Saved when "Save Password" Option Unchecked,
   http://support.microsoft.com/support/kb/articles/q233/3/03.asp

(Note: It might take 24 hours from the original posting of this bulletin for
the KB article to be  visible in the Web-based Knowledge Base.)

What Customers Should Do
========================
Microsoft highly recommends that customers evaluate the degree of risk that
this vulnerability  poses to their systems and determine whether to download
and install the patch. The patch can be  found at:
 - RAS:
   ftp://ftp.microsoft.com/bussys/winnt/winnt-public
   /fixes/usa/nt40/Hotfixes-PostSP5/RASPassword-fix/
 - RRAS:
   ftp://ftp.microsoft.com/bussys/winnt/winnt-public
   /fixes/usa/nt40/Hotfixes-PostSP5/RRASPassword-fix/

(Note: The URLs above have been wrapped for readability)

More Information
================
Please see the following references for more information related to this
issue.
 - Microsoft Security Bulletin MS99-017,
   Patch Available for "RAS and RRAS Password Caching"
   Vulnerability, (The Web-posted version of this bulletin),
   http://www.microsoft.com/security/bulletins/ms99-017.asp.
 - Microsoft Knowledge Base (KB) article Q230681,
   RAS Credentials Saved when "Save Password" Option Unchecked,
   http://support.microsoft.com/support/kb/articles/q230/6/81.asp.
 - Microsoft Knowledge Base (KB) article Q233303,
   RRAS Credentials Saved when "Save Password" Option Unchecked,
   http://support.microsoft.com/support/kb/articles/q233/3/03.asp

Obtaining Support on this Issue
===============================
If you require technical assistance with this issue, please
contact Microsoft Technical Support. For information on
contacting Microsoft Technical Support, please see
http://support.microsoft.com/support/contact/default.asp.

Revisions
=========
 - May 27, 1999: Bulletin Created.


For additional security-related information about Microsoft products, please
visit  http://www.microsoft.com/security


----------------------------------------------------------------------

THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS PROVIDED "AS IS"
WITHOUT WARRANTY OF  ANY KIND. MICROSOFT DISCLAIMS ALL WARRANTIES, EITHER
EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES  OF MERCHANTABILITY AND FITNESS
FOR A PARTICULAR PURPOSE. IN NO EVENT SHALL MICROSOFT CORPORATION  OR ITS
SUPPLIERS BE LIABLE FOR ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT,
INCIDENTAL,  CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES,
EVEN IF MICROSOFT CORPORATION OR ITS  SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES. SOME STATES DO NOT ALLOW THE  EXCLUSION OR
LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES SO THE
FOREGOING  LIMITATION MAY NOT APPLY.

(c) 1999 Microsoft Corporation. All rights reserved. Terms of Use.

   *******************************************************************
You have received  this e-mail bulletin as a result  of your registration
to  the   Microsoft  Product  Security  Notification   Service.  You  may
unsubscribe from this e-mail notification  service at any time by sending
an  e-mail  to  MICROSOFT_SECURITY-SIGNOFF-REQUEST@ANNOUNCE.MICROSOFT.COM
The subject line and message body are not used in processing the request,
and can be anything you like.

For  more  information on  the  Microsoft  Security Notification  Service
please    visit    http://www.microsoft.com/security/bulletin.htm.    For
security-related information  about Microsoft products, please  visit the
Microsoft Security Advisor web site at http://www.microsoft.com/security.

-------------------------------------------------------------------------------

Date: Fri, 28 May 1999 07:59:35 -0400
From: Russ <Russ.Cooper@RC.ON.CA>
To: NTBUGTRAQ@LISTSERV.NTBUGTRAQ.COM
Subject: Re: Alert: Microsoft Security Bulletin (MS99-017) - RAS & RRAS Passwords

Wow, talk about goofing up.

Eric Schultze correctly pointed out that he, together with Lisa
O'Connor, Martin Dolphin, and Joe Greene reported this problem with RAS
originally way back on March 19th, 1998 <-- (note, 1998, not 1999). See
the original message at;

http://ntbugtraq.ntadvice.com/default.asp?pid=36&sid=1&A2=ind9803&L=ntbu
gtraq&F=P&S=&P=4209

(URL is wrapped).

I, most inappropriately, credited another with the discovery in March of
this year.

Its funny, when David LeBlanc first prompted me about this "discovery"
this year, I could have sworn I'd seen it before but I failed to check
my own archives...tsk tsk...;-]

So, to Lisa, Martin, Joe, and Eric, please accept my humble apologies!

To Microsoft, why the hell did it take a publication in a German
magazine to provoke you to fix something that had been reported here a
full year before?? Could it have been the fact that the 3/99 publication
included an exploit tool? Maybe we need to have an exploit coding group
at NTBugtraq that produces a tool for everything reported and
distributes said tool to all and sunder?

Cheers,
Russ - NTBugtraq Editor

