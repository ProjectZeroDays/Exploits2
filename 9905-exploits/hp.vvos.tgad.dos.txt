TGAD DoS

VirtualVault Overview

The VirtualVault operating system is HP's solution to secure
electronic commerce. It is a B1 and B2 DoD compliant system
that is becoming increasingly popular with big business, banks, etc., 
The main security mechanism in which VVOS is based upon is data partitioning. 
Data on the system is classified into one of four security classes, or 'vaults' -- 
INSIDE, OUTSIDE, SYSTEM and SYSTEM HIGH. The INSIDE vault houses the server's 
backend applications and databases. The OUTSIDE vault generally
contains the internet front end and any necessary CGI binaries, etc.
SYSTEM and SYSTEM HIGH are responsible for maintaining the external
webpages and audit logs respectively. These vaults are totally segregated
from each other and work essentially as separate machines. If a
program requires access to either of the vaults it must be authenticated
by HP's Trusted Gateway Proxy daemon. The TGP daemon filters all requests
from the internet and forwards them to middleware server packages that
safely reside behind the INSIDE vault. 

TGA Bug

While the TGP daemon does a good job of ensuring the integrity of the
request prior to forwarding data to its destination, the trusted
gateway agent that is responsible for wrapping CGI requests does not
check the length of the request prior to sending it to TGP. This poses
a problem since TGA does not correctly handle request messages that 
are more than 512 bytes in length. The result is a trivial DoS attack on
TGA and all services being wrapped by TGA. The bug was discovered during a
penetration test on a client system running VVOS 3.01. A post was made to
a CGI application residing on the system with a large string of characters.
This was then sent to the trusted gateway agent, causing the daemon 
to crash, leaving the Netscape Enterprise Server unable to service further
HTTP/SSL requests. The NES logs show the following:

[07/May/1999:16:16:22] security: for host xxx.xxx.xxx.xxx trying to 
GET /cgi-bin/somecgi.cgi?AAAAAAAAAAAAAAA..., vvtga_log reports: ERROR: setup_connection():
Failed to transfer execution message to TGA daemon

And when NES is started back up:

[07/May/1999:16:28:18] info:  successful server startup
[07/May/1999:16:28:18] info: Netscape-Enterprise/3.5.1G B98.169.2301
[07/May/1999:16:33:18] failure: Error accepting connection -5993 (Resource temporarily unavailable)

FIX

Chris Hudel of HP was notified of this bug on Wednesday May 12, 1999. He stated
that HP was aware of the problem and addressed it in patch PHSS 10747. However, I am not
aware of HP releasing an official 'bug report' on this issue.
Since I have encountered several VVOS systems this past week that have not
been patched, and sysadmins unaware of this bug and patch, I decided to post the 
details publicly. NOTE: I have not tested this bug against PHSS 10747 and would
appreciate input from those who have at foo@faber.to.

                                                - John Daniele
                                                  jdaniele@kpmg.ca

--------------------------------------------------------------------------------

Date: Thu, 10 Jun 1999 09:19:46 -0700
From: aleph1@UNDERGROUND.ORG
Reply-To: support_feedback@us-support.external.hp.com
To: BUGTRAQ@netspace.org
Subject: Security Bulletins Digest

                        HP Support Information Digests

===============================================================================
o  HP Electronic Support Center World Wide Web Service
   ---------------------------------------------------

   If you subscribed through the HP Electronic Support Center and would
   like to be REMOVED from this mailing list, access the
   HP Electronic Support Center on the World Wide Web at:

     http://us-support.external.hp.com

   Login using your HP Electronic Support Center User ID and Password.
   Then select Support Information Digests.  You may then unsubscribe from the
   appropriate digest.
===============================================================================

?
Digest Name:  Daily Security Bulletins Digest
    Created:  Thu Jun 10  3:00:03 PDT 1999

Table of Contents:

Document ID      Title
---------------  -----------
HPSBUX9906-098   Security Vulnerability in VVOS NES

The documents are listed below.
-------------------------------------------------------------------------------

?
Document ID:  HPSBUX9906-098
Date Loaded:  19990609
      Title:  Security Vulnerability in VVOS NES

-------------------------------------------------------------------------
    HEWLETT-PACKARD COMPANY SECURITY BULLETIN: #00098, 10 June 1999
-------------------------------------------------------------------------

The information in the following Security Bulletin should be acted upon
as soon as possible.  Hewlett-Packard Company will not be liable for any
consequences to any customer resulting from customer's failure to fully
implement instructions in this Security Bulletin as soon as possible.

-------------------------------------------------------------------------
PROBLEM:  Netscape Enterprise Server cannot correctly process some URL's.

PLATFORM: HP9000 Series 700/800 running:
             HP-UX 10.24 (VVOS) with VirtualVault A.02.00
             HP-UX 10.24 (VVOS) with VirtualVault A.03.00
             HP-UX 10.24 (VVOS) with VirtualVault A.03.01
             HP-UX 10.24 (VVOS) with VirtualVault A.03.50

DAMAGE:   Web Server cannot correctly process some URLs.

SOLUTION: Apply the appropriate patches to correct the problem:
             HP-UX 10.24 with VirtualVault A.02.00 US/Canada
             HP-UX 10.24 with VirtualVault A.02.00 International:
                 PHCO_18615
                 PHSS_18620

             HP-UX 10.24 with VirtualVault A.03.00 US/Canada
             HP-UX 10.24 with VirtualVault A.03.00 International:
                 PHCO_18615
                 PHSS_18616

             HP-UX 10.24 with VirtualVault A.03.01 US/Canada
             HP-UX 10.24 with VirtualVault A.03.01 International:
                 PHCO_18615
                 PHSS_18612

             HP-UX 10.24 with VirtualVault A.03.50 US/Canada
             HP-UX 10.24 with VirtualVault A.03.50 International
                 PHCO_18615
                 PHSS_18621

AVAILABILITY: All patches are available now.
-----------------------------------------------------------------------
I.
   A. Background
      A recent bugtraq posting contained some inaccurate information
      regarding Hewlett-Packard Company's VirtualVault Operating System.
      This problem is not TGA nor TGP related; further, VVOS does not
      have a B1 or B2 level of certification.

      Under certain conditions, Netscape Enterprise Server (NES)
      fails to properly process web requests.  This activity has
      been observed in the NES bundled with Praesidium VirtualVault
      releases A.02.00, A.03.00, A.03.01 and A.03.50.

   B. Fixing the problem
      This problem can be completely eliminated by applying the
      recommended patches mentioned above.  It can be resolved
      temporarily by commenting out or removing the "vault-auth-log"
      AddLog line from the Netscape Enterprise Server's obj.conf file.

      Upon patching the system, automatic reboot is performed.  The
      affected filesets are: VaultNES.NES-VAULT VaultTS.INES-COMMON.

   C. To subscribe to automatically receive future NEW HP Security
      Bulletins or access the HP Electronic Support Center, use your
      browser to get to our ESC web page at:

      http://us-support.external.hp.com   (for non-European locations),
      or  http://europe-support.external.hp.com  (for Europe)

      Login with your user ID and password (or register for one).
      Remember to save the User ID/password assigned to you.

      Once you are in the Main Menu:
      To -subscribe- to future HP Security Bulletins,
        click on "Support Information Digests".
      To -review Security bulletins already released-,
        click on the "Search Technical Knowledge Database."
      To -retrieve patches-, click on "Individual Patches" and select
        appropriate release and locate with the patch identifier (ID).
      To -browse the HP Security Bulletin Archive-,  select the link at
       the bottom of the page once in the "Support Information Digests".
      To -view the Security Patch Matrix-, (updated daily) which
       categorizes security patches by platform/OS release, and by
       bulletin topic, go to the archive (above) and follow the links.

      The security patch matrix is also available via anonymous ftp:
      us-ffs.external.hp.com   or  ~ftp/export/patches/hp-ux_patch_matrix

   D. To report new security vulnerabilities, send email to

       security-alert@hp.com

      Please encrypt any exploit information using the security-alert
      PGP key, available from your local key server, or by sending a
      message with a -subject- (not body) of 'get key' (no quotes) to
      security-alert@hp.com.

     Permission is granted for copying and circulating this Bulletin to
     Hewlett-Packard (HP) customers (or the Internet community) for the
     purpose of alerting them to problems, if and only if, the Bulletin
     is not edited or changed in any way, is attributed to HP, and
     provided such reproduction and/or distribution is performed for
     non-commercial purposes.

     Any other use of this information is prohibited. HP is not liable
     for any misuse of this information by any third party.
________________________________________________________________________
-----End of Document ID:  HPSBUX9906-098--------------------------------------

--------------------------------------------------------------------------------

Date: Thu, 10 Jun 1999 19:58:32 -0400
From: John Daniele <JDaniele@KPMG.CA>
To: BUGTRAQ@netspace.org
Subject: Re: VVOS/Netscape Bug

Since I discovered this vulnerability during a penetration test on a client system I did not have
adequate time to fully investigate the problem. I apologize for the 'misinformation', which I had
cross-checked with HP prior to posting. However, of the three such systems I attempted to
exploit, it did not only affect NES but other applications they had bound as well. It may warrant
another look.

Secondly, the Virtual Vault's product brief it states that it 'utilizes tough B1 and B2 standards'
therefore I felt it was safe to use the word 'utilize' and 'comply' interchangeably. I never mentioned
that the virtual vault operating system was reviewed and/or certified at the B2 level.

John Daniele
jdaniele@kpmg.ca
VOX: (416) 777-3759

--------------------------------------------------------------------------------

Date: Fri, 11 Jun 1999 14:40:18 -0700 (PDT)
From: CIAC Mail User <ciac@rumpole.llnl.gov>
To: ciac-bulletin@rumpole.llnl.gov
Subject: CIAC Bulletin J-046: HP-UX VVOS NES Vulnerability

[  For Public Release  ]
-----BEGIN PGP SIGNED MESSAGE-----

             __________________________________________________________

                       The U.S. Department of Energy
                    Computer Incident Advisory Capability
                           ___  __ __    _     ___
                          /       |     /_\   /
                          \___  __|__  /   \  \___
             __________________________________________________________

                             INFORMATION BULLETIN

                          HP-UX VVOS NES Vulnerability

June 10, 1999 21:00 GMT                                          Number J-046
______________________________________________________________________________

PROBLEM:       Netscape Enterprise Server cannot correctly process some URL's.
PLATFORM:      HP9000 Series 700/800 running:
                   HP-UX 10.24 (VVOS) with VirtualVault A.02.00
                   HP-UX 10.24 (VVOS) with VirtualVault A.03.00
                   HP-UX 10.24 (VVOS) with VirtualVault A.03.01
                   HP-UX 10.24 (VVOS) with VirtualVault A.03.50
DAMAGE:        Web Server cannot correctly process some URLs.
SOLUTION:      Apply available patches.
______________________________________________________________________________
VULNERABILITY  Risk is medium. Hewlett-Packard recommends that the information
ASSESSMENT:    in this advisory be acted upon as soon as possible. 
______________________________________________________________________________

[  Start Hewlett-Packard Advisory  ]

Document ID:  HPSBUX9906-098
Date Loaded:  19990609
      Title:  Security Vulnerability in VVOS NES

- -------------------------------------------------------------------------
    HEWLETT-PACKARD COMPANY SECURITY BULLETIN: #00098, 10 June 1999
- -------------------------------------------------------------------------

The information in the following Security Bulletin should be acted upon
as soon as possible.  Hewlett-Packard Company will not be liable for any
consequences to any customer resulting from customer's failure to fully
implement instructions in this Security Bulletin as soon as possible.

- -------------------------------------------------------------------------
PROBLEM:  Netscape Enterprise Server cannot correctly process some URL's.

PLATFORM: HP9000 Series 700/800 running:
             HP-UX 10.24 (VVOS) with VirtualVault A.02.00
             HP-UX 10.24 (VVOS) with VirtualVault A.03.00
             HP-UX 10.24 (VVOS) with VirtualVault A.03.01
             HP-UX 10.24 (VVOS) with VirtualVault A.03.50

DAMAGE:   Web Server cannot correctly process some URLs.

SOLUTION: Apply the appropriate patches to correct the problem:
             HP-UX 10.24 with VirtualVault A.02.00 US/Canada
             HP-UX 10.24 with VirtualVault A.02.00 International:
                 PHCO_18615
                 PHSS_18620

             HP-UX 10.24 with VirtualVault A.03.00 US/Canada
             HP-UX 10.24 with VirtualVault A.03.00 International:
                 PHCO_18615
                 PHSS_18616

             HP-UX 10.24 with VirtualVault A.03.01 US/Canada
             HP-UX 10.24 with VirtualVault A.03.01 International:
                 PHCO_18615
                 PHSS_18612

             HP-UX 10.24 with VirtualVault A.03.50 US/Canada
             HP-UX 10.24 with VirtualVault A.03.50 International
                 PHCO_18615
                 PHSS_18621

AVAILABILITY: All patches are available now.
- -----------------------------------------------------------------------
I.
   A. Background
      A recent bugtraq posting contained some inaccurate information
      regarding Hewlett-Packard Company's VirtualVault Operating System.
      This problem is not TGA nor TGP related; further, VVOS does not
      have a B1 or B2 level of certification.

      Under certain conditions, Netscape Enterprise Server (NES)
      fails to properly process web requests.  This activity has
      been observed in the NES bundled with Praesidium VirtualVault
      releases A.02.00, A.03.00, A.03.01 and A.03.50.

   B. Fixing the problem
      This problem can be completely eliminated by applying the
      recommended patches mentioned above.  It can be resolved
      temporarily by commenting out or removing the "vault-auth-log"
      AddLog line from the Netscape Enterprise Server's obj.conf file.

      Upon patching the system, automatic reboot is performed.  The
      affected filesets are: VaultNES.NES-VAULT VaultTS.INES-COMMON.

   C. To subscribe to automatically receive future NEW HP Security
      Bulletins or access the HP Electronic Support Center, use your
      browser to get to our ESC web page at:

      http://us-support.external.hp.com   (for non-European locations),
      or  http://europe-support.external.hp.com  (for Europe)

      Login with your user ID and password (or register for one).
      Remember to save the User ID/password assigned to you.

      Once you are in the Main Menu:
      To -subscribe- to future HP Security Bulletins,
        click on "Support Information Digests".
      To -review Security bulletins already released-,
        click on the "Search Technical Knowledge Database."
      To -retrieve patches-, click on "Individual Patches" and select
        appropriate release and locate with the patch identifier (ID).
      To -browse the HP Security Bulletin Archive-,  select the link at
       the bottom of the page once in the "Support Information Digests".
      To -view the Security Patch Matrix-, (updated daily) which
       categorizes security patches by platform/OS release, and by
       bulletin topic, go to the archive (above) and follow the links.

      The security patch matrix is also available via anonymous ftp:
      us-ffs.external.hp.com   or  ~ftp/export/patches/hp-ux_patch_matrix

   D. To report new security vulnerabilities, send email to

       security-alert@hp.com

      Please encrypt any exploit information using the security-alert
      PGP key, available from your local key server, or by sending a
      message with a -subject- (not body) of 'get key' (no quotes) to
      security-alert@hp.com.

     Permission is granted for copying and circulating this Bulletin to
     Hewlett-Packard (HP) customers (or the Internet community) for the
     purpose of alerting them to problems, if and only if, the Bulletin
     is not edited or changed in any way, is attributed to HP, and
     provided such reproduction and/or distribution is performed for
     non-commercial purposes.

     Any other use of this information is prohibited. HP is not liable
     for any misuse of this information by any third party.
________________________________________________________________________
- -----End of Document ID:  HPSBUX9906-098--------------------------------------


[  End Hewlett-Packard Advisory  ]

______________________________________________________________________________

CIAC wishes to acknowledge Hewlett-Packard for the information contained in this
bulletin.
______________________________________________________________________________


For additional information or assistance, please contact CIAC:

CIAC, the Computer Incident Advisory Capability, is the computer
security incident response team for the U.S. Department of Energy
(DOE) and the emergency backup response team for the National
Institutes of Health (NIH). CIAC is located at the Lawrence Livermore
National Laboratory in Livermore, California. CIAC is also a founding
member of FIRST, the Forum of Incident Response and Security Teams, a
global organization established to foster cooperation and coordination
among computer security teams worldwide.

CIAC services are available to DOE, DOE contractors, and the NIH. CIAC
can be contacted at:
    Voice:    +1 925-422-8193
    FAX:      +1 925-423-8002
    STU-III:  +1 925-423-2604
    E-mail:   ciac@llnl.gov

For emergencies and off-hour assistance, DOE, DOE contractor sites,
and the NIH may contact CIAC 24-hours a day. During off hours (5PM -
8AM PST), use one of the following methods to contact CIAC:

    1.  Call the CIAC voice number 925-422-8193 and leave a message, or

    2.  Call 888-449-8369 to send a Sky Page to the CIAC duty person or

    3.  Send e-mail to 4498369@skytel.com, or

    4.  Call 800-201-9288 for the CIAC Project Leader.

Previous CIAC notices, anti-virus software, and other information are
available from the CIAC Computer Security Archive.

   World Wide Web:      http://www.ciac.org/
                        (or http://ciac.llnl.gov)
   Anonymous FTP:       ftp.ciac.org
                        (or ciac.llnl.gov)
   Modem access:        +1 (925) 423-4753 (28.8K baud)
                        +1 (925) 423-3331 (28.8K baud)

CIAC has several self-subscribing mailing lists for electronic
publications:
1. CIAC-BULLETIN for Advisories, highest priority - time critical
   information and Bulletins, important computer security information;
2. SPI-ANNOUNCE for official news about Security Profile Inspector
   (SPI) software updates, new features, distribution and
   availability;
3. SPI-NOTES, for discussion of problems and solutions regarding the
   use of SPI products.

Our mailing lists are managed by a public domain software package
called Majordomo, which ignores E-mail header subject lines. To
subscribe (add yourself) to one of our mailing lists, send the
following request as the E-mail message body, substituting
ciac-bulletin, spi-announce OR spi-notes for list-name:

E-mail to       ciac-listproc@llnl.gov or majordomo@rumpole.llnl.gov:
        subscribe list-name
  e.g., subscribe ciac-bulletin

You will receive an acknowledgment email immediately with a confirmation
that you will need to mail back to the addresses above, as per the
instructions in the email.  This is a partial protection to make sure
you are really the one who asked to be signed up for the list in question.

If you include the word 'help' in the body of an email to the above address,
it will also send back an information file on how to subscribe/unsubscribe,
get past issues of CIAC bulletins via email, etc.

PLEASE NOTE: Many users outside of the DOE, ESnet, and NIH computing
communities receive CIAC bulletins.  If you are not part of these
communities, please contact your agency's response team to report
incidents. Your agency's team will coordinate with CIAC. The Forum of
Incident Response and Security Teams (FIRST) is a world-wide
organization. A list of FIRST member organizations and their
constituencies can be obtained via WWW at http://www.first.org/.

This document was prepared as an account of work sponsored by an
agency of the United States Government. Neither the United States
Government nor the University of California nor any of their
employees, makes any warranty, express or implied, or assumes any
legal liability or responsibility for the accuracy, completeness, or
usefulness of any information, apparatus, product, or process
disclosed, or represents that its use would not infringe privately
owned rights. Reference herein to any specific commercial products,
process, or service by trade name, trademark, manufacturer, or
otherwise, does not necessarily constitute or imply its endorsement,
recommendation or favoring by the United States Government or the
University of California. The views and opinions of authors expressed
herein do not necessarily state or reflect those of the United States
Government or the University of California, and shall not be used for
advertising or product endorsement purposes.

LAST 10 CIAC BULLETINS ISSUED (Previous bulletins available from CIAC)

J-036: LDAP Buffer overflow against Microsoft Directory Services
J-037: W97M.Melissa Word Macro Virus
J-038: HP-UX Vulnerabilities (hpterm, ftp)
J-039: HP-UX Vulnerabilities (MC/ServiceGuard & MC/LockManager, DES
J-040: HP-UX Security Vulnerability in sendmail
J-041: Cisco IOS(R) Software Input Access List Leakage with NAT
J-042: Web Security
J-043: (bulletin in process)
J-044: Tru64/Digital UNIX (dtlogin) Security Vulnerability
J-045: Vulnerability in statd exposes vulnerability in automountd


-----BEGIN PGP SIGNATURE-----
Version: 4.0 Business Edition

iQCVAwUBN2E2F7nzJzdsy3QZAQHRDwP+NFWF9EkdZXWct/RAlQ1Pm2j3+j5fHupX
le1b2Bb/sUDQnIhOWMkv6TTPdOfTOfXaNfg+zymM+nVyhr5dazIViLHnXur+aG0h
zXE56ZhQXyJo4g7RSPUUdqLJO5mtbnugbp+nbnKPJYMye9uNEeEp3ZDY0VZ5trU7
BPfZ/C32CSw=
=Q3GI
-----END PGP SIGNATURE-----

