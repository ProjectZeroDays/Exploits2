Profundis Labs - Security Advisory

Vulnerablity Title
==================
A security issue in MOVEit application allows the enumeration of existing FileIDs (CVE-2015-7677)

Vendor:
=======
Ipswitch, Inc (http://www.ipswitchft.com) 

Product:
========
MOVEit File Transfer

MOVEit is an automated file transfer system that lets you manage, view, secure, and control all business-critical file transfer activity through a single, secure system.
(Source: http://www.ipswitchft.com/moveit-managed-file-transfer)

Affected Versions:
==================
MOVEit DMZ v8.1 and below

Vulnerability Type:
===================
Information disclosure

CVE Reference:
==============
CVE-2015-7677

VENDOR Reference:
=================
http://docs.ipswitch.com/MOVEit/DMZ82/ReleaseNotes/MOVEitReleaseNotes82.pdf
Reference Number: MIDMZ-6126

Vulnerability Details:
======================
It is possible to enumerate valid FileIDs by using the MOVEitISAPI service.
According to whether a FileID exists or not, a different error message is returned from the server.
It is possible to write a program which automatically tries different FileIDs and
identifies existing FileIDs. Those FileIDs may later be used for unauthorized access the corresponding file using vulnerability 
CVE-2015-7675 (https://profundis-labs.com/advisories/CVE-2015-7675.txt).

To exploit this vulnerability, the following information is needed:
- A valid user account (user session)

PoC code(s):
============
POST /MOVEitISAPI/MOVEitISAPI.dll?action=download HTTP/1.1
Host: <DNSNAME>
...
X-siLock-FileID: <FileID>

The response from server can be evaluated as followed:

- FileID exists but user is not permitted, error message: 
  "Sie sind nicht zum Lesen dieser Datei berechtigt" (Error message is in German, it may differ in setups with other languages)
- FileID does not exist, error message: No such file ID "<FileID>" (this error message is always in English)

Remark: Values in Brakets are placeholders.

Disclosure Timeline:
====================
Vendor Notification:  09/23/2015
Vendor Confirmation:  09/24/2015
Vendor Patch Release: 10/20/2015 
Public Disclosure:    01/27/2016

Severity Level:
===============
4.3 (Medium) 
CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N

Description:
============
Request Method(s):              [+]  HTTP POST

Vulnerable Product:             [+]  MOVEit DMZ v8.1
                                     
Vulnerable Parameter(s):        [+]  X-siLock-FileID 

Authentication (Role):          [+]  User, Guest Access

===========================================================
[+] Author: Philipp Rocholl

[+] Website: https://www.profundis-labs.com

[+] Source:  https://profundis-labs.com/advisories/CVE-2015-7677.txt

[+] Disclaimer
Permission is hereby granted for the redistribution of this advisory, provided that it is not altered except by reformatting it, and that due credit is given. 
Permission is explicitly given for insertion in vulnerability databases and similar, provided that due credit is given to the author.
The author is not responsible for any misuse of the information contained herein and prohibits any malicious use of all security related information.


