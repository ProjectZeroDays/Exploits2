Profundis Labs - Security Advisory

Vulnerability Title
==================
Persistent Cross-Site-Scripting (XSS) vulnerability by file upload due to insecure default configuration

Vendor:
=======
Ipswitch, Inc (http://www.ipswitchft.com) 

Product:
========
MOVEit File Transfer

MOVEit is an automated file transfer system that lets you manage, view, secure, and control all business-critical file transfer activity through a single, secure system.
(Source: http://www.ipswitchft.com/moveit-managed-file-transfer)

Affected Versions:
==================
MOVEit DMZ v8.1 and below

Vulnerability Type:
===================
Insecure default configuration

CVE Reference:
==============
CVE-2015-7676

VENDOR Reference:
=================
unknown

Vulnerability Details:
======================
The default configuration allows users to upload HTML files which may contain script code. 
If another user accesses this file the server returns the file to the user's browser with:

Content-Disposition: inline;
Content-Type:text/html

This results in rendering the html file in the user's browser.
If the file contains malicious script code, the code will be executed in the application's context.
This may be used to perform XSS or CSRF attacks or steal other sensible user data.

Remark:

There is a configuration option to prevent file view on download. It is off by default.

PoC code(s):
============

Upload an HTML file (e.g. test.html) which contains the following content:

<html>
<body onload="alert('XSS');">
</body>
</html>

Disclosure Timeline:
====================
Vendor Notification:  09/23/2015
Vendor Confirmation:  09/24/2015
Vendor Patch Release: unknown
Public Disclosure:    01/27/2016

Severity Level:
===============
6.4 (Medium) 
CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N

Description:
============
Request Method(s):              [+]  HTTP POST

Vulnerable Product:             [+]  MOVEit DMZ v8.1

Vulnerable Parameter(s):        [+]  FILEID 

Authentication (Role):          [+]  User, Guest Access

===========================================================
[+] Author: Philipp Rocholl

[+] Website: https://www.profundis-labs.com

[+] Source:  https://profundis-labs.com/advisories/CVE-2015-7676.txt

[+] Disclaimer
Permission is hereby granted for the redistribution of this advisory, provided that it is not altered except by reformatting it, and that due credit is given. 
Permission is explicitly given for insertion in vulnerability databases and similar, provided that due credit is given to the author.
The author is not responsible for any misuse of the information contained herein and prohibits any malicious use of security related information.


