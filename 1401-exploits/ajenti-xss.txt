# Exploit Title: Ajenti - Stored (Persistent) Cross Site Scripting Vulnerability
# Date: 16/01/2014
# Exploit Author: projectzero labs
# Vendor Homepage: http://www.ajenti.org
# Vendor Informed: 14/01/2014
# Software Link: http://www.ajenti.org
# Version: 1.2.13
# Tested on: Kali Linux / Iceweasel v.22

About the software:
===================

Ajenti is a server administration panel for Linux and FreeBSD. 


Vulnerability Details:
======================

projectzero labs identified a stored (persistent) cross site scripting vulnerability that affects many of
the forms in the ajenti web panel.

The vulnerability exists because some data inputs are not properly sanitized and this can lead to 
malicious code injection that will be executed on the target's browser.


Report & Proof Of Concept:
==========================

A detailed report with screenshots as Proof Of Concept can be found in the software's bug tracker (Github):

https://github.com/Eugeny/ajenti/issues/233

Vendor has already informed and committed a quick patch:
https://github.com/Eugeny/ajenti/commit/3270fd1d78391bb847b4c9ce37cf921f485b1310


Payload:
========

As payloads we tested the classic alert popup and the url redirection to google:

<script>alert("XSS");</script>
<script>window.location = "http://google.com"</script>

For example a vulnerable form is the: System > Cron > Command field
For more information there are some screenshots available in the github bug report


Severity:
=========
Medium


Credits:
========

projectzero labs

labs@projectzero.gr
http://www.projectzero.gr
