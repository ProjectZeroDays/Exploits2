######################################################################
# Exploit Title: Oracle.com sub-domain Reflected Cross-Site Scripting (RXSS)
# Date: 04/04/2014
# Author: Yann CAM @ Synetis - ASafety
# Vendor or Software Link: www.oracle.com
# Version: /
# Category: Reflected Cross Site Scripting
# Google dork:
# Tested on: Oracle.com dne sub-domain
######################################################################

Oracle description :
======================================================================
 
The Oracle Corporation is an American multinational computer technology corporation headquartered in Redwood City, California, United States. The company specializes in
developing and marketing computer hardware systems and enterprise software products â€“ particularly its own brands of database management systems. As of 2011, Oracle is 
the second-largest software maker by revenue, after Microsoft.

The company also builds tools for database development and systems of middle-tier software, enterprise resource planning (ERP) software, customer relationship 
management (CRM) software and supply chain management (SCM) software.


Vulnerability description :
======================================================================

A reflected XSS is available in the dne.oracle.com sub-domain.
Through this vulnerability, an attacker could tamper with page rendering, redirect victims to fake Oracle portals, or capture Oracle's users credentials such cookies. 
This reflected XSS is on GET "elq" variable and is not properly sanitized before being used to his page.


Proof of Concept :
======================================================================
 
A non-persistent XSS (RXSS) in "elq" GET param is available in the dne.oracle.com sub-domain during the unsubscribe mailing-list process.
Tested on Firefox 33.1.1.

Email received through mailing-list contains an "unsubscribe link" in footer. This link points to the dne.oracle.com domain with a token
corresponding to the target user (elq GET param). This token isn't properly sanitized before being reused in the page.
 
PoC:
 
https://dne.oracle.com/pls/uns/OPT_OUT.th?elq_mid=5038&sh=&cmid=EMEAFM14042899MPP002C001&l_code=fr&elq=4c31b8602999476b9d88c2e2fb31ff40" /><script>alert(/Reflected XSS - Yann CAM @ASAfety - www.synetis.com/)</script>&elqCampaignId=5833


Screenshots :
======================================================================

- http://www.asafety.fr/data/20140825-oracle_XSS2.png


Solution:
======================================================================

Fixed by Oracle security team.
 
 
Additional resources / article and screenshots :
======================================================================

- http://www.oracle.com/ 
- http://www.oracle.com/technetwork/topics/security/cpujan2015-1972971.html
- http://www.asafety.fr/vuln-exploit-poc/contribution-oracle-reflected-xss-vulnerabilite
- http://www.synetis.com

 
Report timeline :
======================================================================
 
2014-08-25 : Oracle security team alerted with details and PoC.
2014-10-27 : Oracle response and ack.
2014-10-27 : Confirmation of the fix to Oracle.
2015-04-04 : ASafety public article
2015-04-04 : Public advisory

Credits :
======================================================================
 
    88888888
   88      888                                         88    88
  888       88                                         88
  788           Z88      88  88.888888     8888888   888888  88    8888888.
   888888.       88     88   888    Z88   88     88    88    88   88     88
       8888888    88    88   88      88  88       88   88    88   888
            888   88   88    88      88  88888888888   88    88     888888
  88         88    88  8.    88      88  88            88    88          888
  888       ,88     8I88     88      88   88      88   88    88  .88     .88
   ?8888888888.     888      88      88    88888888    8888  88   =88888888
       888.          88
                    88    www.synetis.com
                 8888  Consulting firm in management and information security
 
Yann CAM - Security Consultant @ Synetis | ASafety

--
SYNETIS | ASafety
CONTACT: www.synetis.com | www.asafety.fr
