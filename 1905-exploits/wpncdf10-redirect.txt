####################################################################

# Exploit Title : WordPress Nya-Comment-DoFollow Plugins 1.0 Open Redirection
# Author [ Discovered By ] : KingSkrupellos
# Team : Cyberizm Digital Security Army
# Date : 29/05/2019
# Vendor Homepage : wordpress.com
# Information Link : muzhiks.com/nya_comments_dofollow_eng
# WordPress Affected Versions :
2.6.x, 2.5.x, 2.3.x, 2.2.x, 2.1.x, 2.0.x, 1.5.x and 4.7/4.8
# Plugin Affected Version : 1.0
Requires at least: 2.6.x
Tested up to: 2.9.1
Stable tag: 1.2
# Tested On : Windows and Linux
# Category : WebApps
# Exploit Risk : Medium
# Google Dorks : inurl:/wp-content/plugins/nya-comment-dofollow/
intext:Tous droits réservés | Boutique de chocolat D'lys couleurs
# Vulnerability Type : CWE-601 [ URL Redirection to Untrusted Site ('Open Redirect') ]
# PacketStormSecurity : packetstormsecurity.com/files/authors/13968
# CXSecurity : cxsecurity.com/author/KingSkrupellos/1/
# Exploit4Arab : exploit4arab.org/author/351/KingSkrupellos

####################################################################

# Description About Software :
****************************
Directs through a redirect all links to home pages from comments except the last. 
The link in the last comment becomes dofollow.

####################################################################

# Impact :
***********
WordPress Nya-Comment-DoFollow Plugins accepts a user-controlled input that specifies
a link to an external site, and uses that link in a Redirect. This simplifies phishing 
attacks. An http parameter may contain a URL value and could cause the web 
application to redirect the request to the specified URL. By modifying the URL 
value to a malicious site, an attacker may successfully launch a phishing scam and 
steal user credentials. Because the server name in the modified link is identical to the 
original site, phishing attempts have a more trustworthy appearance. Open redirect is a 
failure in that process that makes it possible for attackers to steer users to malicious 
websites. This vulnerability is used in phishing attacks to get users to visit malicious 
sites without realizing it. Web users often encounter redirection when they visit the 
Web site of a company whose name has been changed or which has been acquired by 
another company. Visiting unreal web page user's computer becomes affected 
by malware the task of which is to deceive the valid actor and steal his personal data.

####################################################################

== Installation ==
= System requirements =
To use Nya Comments DoFollow, you will need:
* an installed and configured copy of WordPress version 2.6.x, 2.5.x,
2.3.x, 2.2.x, 2.1.x, 2.0.x, or 1.5.x. (Nya Comments DoFollow will also work with
the equivalent versions of WordPress MU.)
*FTP or SFTP access to your web host
= New Installations =
1.Download the Nya Comments DoFollow archive in zip or gzipped tar format and
extract the files on your computer. 
2.Create a new directory named `Nya Comments DoFollow` in the `wp-content/plugins`
directory of your WordPress installation. Use an FTP or SFTP client to
upload the contents of your Wordpress Nya Comments DoFollow archive to the new directory
that you just created on your web host.
3.Log in to the WordPress Dashboard and activate the Nya Comments DoFollow.
5.Configure the plugin and add it to the plugin settings page.

= Updating =
1. Download the Nya Comments DoFollow archive in zip or gzipped tar format and
extract the files on your computer.
2. Deactivate old version Nya Comments DoFollow.
3. Delete a folder containing Nya Comments DoFollow from a folder 'wp-content/plugins'.
4.Create a new directory named `Nya Comments DoFollow` in the `wp-content/plugins`
directory of your WordPress installation. Use an FTP or SFTP client to
upload the contents of your Wordpress Nya Comments DoFollow archive to the new directory
that you just created on your web host.
5.Log in to the WordPress Dashboard and activate the Nya Comments DoFollow plugin.
6.Configure the plugin and add it to the plugin settings page.	

####################################################################

# Vulnerable File :
*****************
/redir.php

# Vulnerable Parameters :
***********************
?url=

# Open Redirection Exploit :
**************************
/wp-content/plugins/nya-comment-dofollow/redir.php?url=https://www.[REDIRECTADDRESS].gov

####################################################################

# Discovered By KingSkrupellos from Cyberizm.Org Digital Security Team 

####################################################################
